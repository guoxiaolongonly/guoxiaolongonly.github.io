<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Xiaolong的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="程序猿">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiaolong的个人博客">
<meta property="og:url" content="http://xiaolongonly.cn/index.html">
<meta property="og:site_name" content="Xiaolong的个人博客">
<meta property="og:description" content="程序猿">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiaolong的个人博客">
<meta name="twitter:description" content="程序猿">
  
    <link rel="alternative" href="/atom.xml" title="Xiaolong的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars3.githubusercontent.com/u/12853050?v=3&amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">小龙</a></h1>
		</hgroup>

		
		<p class="header-subtitle">爱生活，爱学习</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/xiaolongonly" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/719243738" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/JSOUP/" style="font-size: 10px;">JSOUP</a> <a href="/tags/Java泛型/" style="font-size: 10px;">Java泛型</a> <a href="/tags/Lambda/" style="font-size: 10px;">Lambda</a> <a href="/tags/Reptile/" style="font-size: 15px;">Reptile</a> <a href="/tags/学习/" style="font-size: 20px;">学习</a> <a href="/tags/感想/" style="font-size: 10px;">感想</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">一只孤单的程序猿！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">小龙</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="https://avatars3.githubusercontent.com/u/12853050?v=3&amp;s=460" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">小龙</h1>
			</hgroup>
			
			<p class="header-subtitle">爱生活，爱学习</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/xiaolongonly" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/719243738" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-Generic" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/07/Generic/" class="article-date">
  	<time datetime="2016-08-07T13:56:33.000Z" itemprop="datePublished">2016-08-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/07/Generic/">java泛型</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="闲谈："><a href="#闲谈：" class="headerlink" title="闲谈："></a>闲谈：</h5><p>说到泛型，大部分人肯定都不陌生，在我学习泛型之前，对他的概念是一个T类型的对象，它可以指代各种类型。没错，可以这么理解，但是其中又有很多值得思考的问题，泛型跟Object有什么区别，泛型的用法等等，这些都是值得我们去深思的一个问题。<br>以前一直都想着利用泛型来好好装逼，但是因为技术不足，也可以说是人懒，对java的理解没有这么深刻，学习的过程中总觉得特别困难，一直都处于一知半解的状态，最近在公司项目开发过程中，发现框架里面有好多东西都运用了泛型优化代码，感觉也差不多是再对泛型进一步学习的时候了。</p>
<p>说一说我印象最深刻的几行代码，是用来简化Android控件绑定的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">protect (V extends View) myFindView(<span class="keyword">int</span> resId)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">return</span> (V)findViewById(resId);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个是写在了基类的Activity中作为所有Activity的父类，在子类中findViewById的写法就变成了如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TextView  mTextView = myFindView(R.id.mTextView);</div></pre></td></tr></table></figure></p>
<p>对比android原生自带的findViewById是不是直接取消了类型的强转，这如果在Activity很多的情况下是可以少很多代码和时间的。<br>直接取消掉了类型的强转，是不是简单了许多。好了，这么一个强大的东西，是时候好好学习一波了。</p>
<h3 id="一、泛型的概念"><a href="#一、泛型的概念" class="headerlink" title="一、泛型的概念"></a>一、泛型的概念</h3><p>泛型实现了参数化类型的概念，使代码可以应用于多种类型。在你创建参数化类型的一个实例时，编译器会为你负责转型操作，并且保证类型的正确性。</p>
<h3 id="二、泛型的使用"><a href="#二、泛型的使用" class="headerlink" title="二、泛型的使用"></a>二、泛型的使用</h3><h4 id="普通泛型"><a href="#普通泛型" class="headerlink" title="普通泛型"></a>普通泛型</h4><p>有许多原因促成了泛型的出现，而最引人注目的一个原因就是为了创造容器类。基本上所有的程序运行时都要求你持有一大堆对象，所以容器类算得上最具重用性的类库之一。<br>接下来我们可以通过对比来裂解一下泛型作为容器类的好处<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder1</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> AModel mAModel;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Holder1</span><span class="params">(AModel AModel)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">this</span>.mAModel=AModel;</div><div class="line">	&#125;</div><div class="line">	<span class="function">AModel <span class="title">get</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">return</span> mAModel;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个类可以明确指定其持有的对象类型，但他的重用性就不怎么样了。试想一下如果我们也有一个BModel同样需要放在这样一个容器持有类中。再重新写一个类代码就显得太多太杂了，毕竟要实现的功能是差不多的。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder2</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Object mModel;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Holder2</span><span class="params">(Object model)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">this</span>.mModel=model;</div><div class="line">	&#125;</div><div class="line">	<span class="function">Object <span class="title">get</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">return</span> mModel;</div><div class="line">	&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></div><div class="line">	&#123;</div><div class="line">		Holder2 h2 = <span class="keyword">new</span> Holder2(<span class="keyword">new</span> Model());</div><div class="line">		Model model = (Model) h2.get();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在Holder 可以存放各种不同类型的对象了，因为所有的java类都是Object的子类，java支持向上向下转型的。所以这个代码可以作为任意类型的容器了。<br>有些情况下，我们确实希望容器能够同时持有多种类型的对象，但是，通常而言，我们只会使用容器来存储一种类型的对象。泛型的主要目前之一就是用来指定容器要持有什么类型的对象，而由编译器来保证类型的正确性。<br>因此，与其使用Object,我们更喜欢暂时不指定类型，而是稍后再决定具体使用什么类型。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder3</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">	<span class="keyword">private</span> T mModel;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Holder3</span><span class="params">(T model)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">this</span>.mModel=model;</div><div class="line">	&#125;</div><div class="line">	<span class="function">T <span class="title">get</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">return</span> mModel;</div><div class="line">	&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></div><div class="line">    &#123;</div><div class="line">    	Holder3&lt;Model&gt; h3 = <span class="keyword">new</span> Holder3(<span class="keyword">new</span> Model());</div><div class="line">       	Model model = h3.get();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在，当你创建Holder3对象时必须指明想持有什么类型的对象，将其置于尖括号内。然后你就能在Holder3存入该类型。<br>并且，在你从Holder3取出它的持有对象时，自动就是正确的类型。<br>现在我们来试试元组，持有多种不同类型。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TwoTuple</span>&lt;<span class="title">A</span>,<span class="title">B</span>&gt;</span></div><div class="line">   &#123;</div><div class="line">   	<span class="keyword">public</span> <span class="keyword">final</span> A first;</div><div class="line">       <span class="keyword">public</span> <span class="keyword">final</span> B second;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="title">TwoTuple</span><span class="params">(A a,B b)</span></span></div><div class="line">       &#123;</div><div class="line">       	first=a;</div><div class="line">           second=b;</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>现在我们拥有了一个可以持有两个对象的元组了，如果我们再需要三个对象的元组。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">ThreeTuple</span><span class="params">(A,B,C)</span> exrebds TwoTuple&lt;A,B&gt;</span></div><div class="line">   &#123;</div><div class="line">   	<span class="keyword">public</span> <span class="keyword">final</span> C third;</div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="title">ThreeTuple</span><span class="params">(A a,B b,C c)</span></span></div><div class="line">       &#123;</div><div class="line">       	<span class="keyword">super</span>(a,b)</div><div class="line">           third=c;</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<h5 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h5><pre><code>不知道有没有人注意到 Holder3&lt;Model&gt; h3 = new Holder3(new Model());在初始化这个对象持有类的时候我们指明了我们想要的类型。然后编译器自动帮我们编译成了这个类型。也就是说编译器在执行h3.get();的时候它是已经明确知道了h3.get()的类型了，并自动进行了强转。而Model model = (Model) h2.get();这个，当编译器在执行这一句的时候他还不知道h2.get()到底是什么类型，最后我们告诉它，要强转成Model以适配model这个实例化对象，来进行存储。
</code></pre><p>接下来讲讲泛型接口</p>
<h4 id="泛型接口"><a href="#泛型接口" class="headerlink" title="泛型接口"></a>泛型接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Info</span>&lt;<span class="title">T</span>&gt;</span>&#123;        <span class="comment">// 在接口上定义泛型  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getVar</span><span class="params">()</span> </span>; <span class="comment">// 定义抽象方法，抽象方法的返回值就是泛型类型  </span></div><div class="line">&#125;  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">InfoImpl</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Info</span>&lt;<span class="title">T</span>&gt;</span>&#123;   <span class="comment">// 定义泛型接口的子类  </span></div><div class="line">    <span class="keyword">private</span> T var ;             <span class="comment">// 定义属性  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InfoImpl</span><span class="params">(T var)</span></span>&#123;     <span class="comment">// 通过构造方法设置属性内容  </span></div><div class="line">        <span class="keyword">this</span>.setVar(var) ;    </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVar</span><span class="params">(T var)</span></span>&#123;  </div><div class="line">        <span class="keyword">this</span>.var = var ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getVar</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var ;  </div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsDemo24</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String arsg[])</span></span>&#123;  </div><div class="line">        Info&lt;String&gt; i = <span class="keyword">null</span>;        <span class="comment">// 声明接口对象  </span></div><div class="line">        i = <span class="keyword">new</span> InfoImpl&lt;String&gt;(<span class="string">"汤姆"</span>) ;  <span class="comment">// 通过子类实例化对象  </span></div><div class="line">        System.out.println(<span class="string">"内容："</span> + i.getVar()) ;  </div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line">----------------------------------------------------------  </div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Info</span>&lt;<span class="title">T</span>&gt;</span>&#123;        <span class="comment">// 在接口上定义泛型  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getVar</span><span class="params">()</span> </span>; <span class="comment">// 定义抽象方法，抽象方法的返回值就是泛型类型  </span></div><div class="line">&#125;  </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">InfoImpl</span> <span class="keyword">implements</span> <span class="title">Info</span>&lt;<span class="title">String</span>&gt;</span>&#123;   <span class="comment">// 定义泛型接口的子类  </span></div><div class="line">    <span class="keyword">private</span> String var ;                <span class="comment">// 定义属性  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InfoImpl</span><span class="params">(String var)</span></span>&#123;        <span class="comment">// 通过构造方法设置属性内容  </span></div><div class="line">        <span class="keyword">this</span>.setVar(var) ;    </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVar</span><span class="params">(String var)</span></span>&#123;  </div><div class="line">        <span class="keyword">this</span>.var = var ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVar</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var ;  </div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsDemo</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String arsg[])</span></span>&#123;  </div><div class="line">        Info i = <span class="keyword">null</span>;      <span class="comment">// 声明接口对象  </span></div><div class="line">        i = <span class="keyword">new</span> InfoImpl(<span class="string">"汤姆"</span>) ;    <span class="comment">// 通过子类实例化对象  </span></div><div class="line">        System.out.println(<span class="string">"内容："</span> + i.getVar()) ;  </div><div class="line">    &#125;  </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>泛型也可以应用于接口，例如生成器，作为工厂方法设计模式的一种应用。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line">	</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Generator</span>&lt;<span class="title">T</span>&gt; </span>&#123;<span class="comment">//生成器接口</span></div><div class="line">	<span class="function">T <span class="title">next</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> </span>&#123;<span class="comment">//咖啡类</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> counter = <span class="number">0</span>;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> id = counter++;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> getClass().getSimpleName() + <span class="string">" "</span> + id;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Latte</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mocha</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cappuccino</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Americano</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Breve</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 咖啡生成器类，随机生成咖啡</div><div class="line"> * <span class="doctag">@author</span> T157</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeGenerator</span> <span class="keyword">implements</span> <span class="title">Generator</span>&lt;<span class="title">Coffee</span>&gt;,<span class="title">Iterable</span>&lt;<span class="title">Coffee</span>&gt;</span>&#123;</div><div class="line">	<span class="keyword">private</span> Class[] types = &#123;Latte.class,Mocha.class,Cappuccino.class,Americano.class,Breve.class&#125;;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> mSize;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CoffeeGenerator</span><span class="params">()</span></span>&#123;&#125;;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CoffeeGenerator</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</div><div class="line">		mSize=size;</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;Coffee&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> CoffeeInterator();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Coffee <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			<span class="keyword">return</span> (Coffee)types[rand.nextInt(types.length)].newInstance();</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeInterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Coffee</span>&gt;</span>&#123;</div><div class="line">		<span class="keyword">int</span> count =mSize;</div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> count&gt;<span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> Coffee <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">			count--;</div><div class="line">			<span class="keyword">return</span> CoffeeGenerator.<span class="keyword">this</span>.next();</div><div class="line">		&#125;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span></div><div class="line">		&#123;</div><div class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></div><div class="line">	&#123;</div><div class="line">		CoffeeGenerator gen = <span class="keyword">new</span> CoffeeGenerator();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</div><div class="line">		&#123;</div><div class="line">			System.out.println(gen.next());</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(Coffee c: <span class="keyword">new</span> CoffeeGenerator(<span class="number">5</span>))</div><div class="line">		&#123;</div><div class="line">			System.out.println(c);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="泛型方法"><a href="#泛型方法" class="headerlink" title="泛型方法"></a>泛型方法</h4><p>只需要在方法返回类型前加泛型参数就可以啦，看代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span></span>&#123;  </div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">fun</span><span class="params">(T t)</span></span>&#123;            <span class="comment">// 可以接收任意类型的数据  </span></div><div class="line">        <span class="keyword">return</span> t ;                  <span class="comment">// 直接把参数返回  </span></div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsDemo</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;  </div><div class="line">        Demo d = <span class="keyword">new</span> Demo() ;   <span class="comment">// 实例化Demo对象  </span></div><div class="line">        String str = d.fun(<span class="string">"汤姆"</span>) ; <span class="comment">//   传递字符串  </span></div><div class="line">        <span class="keyword">int</span> i = d.fun(<span class="number">30</span>) ;     <span class="comment">// 传递数字，自动装箱  </span></div><div class="line">        System.out.println(str) ;   <span class="comment">// 输出内容  </span></div><div class="line">        System.out.println(i) ;     <span class="comment">// 输出内容  </span></div><div class="line">    &#125;  </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>通过泛型方法返回泛型类型实例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span>&lt;<span class="title">T</span>&gt;</span>&#123;    <span class="comment">// 指定上限</span></div><div class="line">    <span class="keyword">private</span> T var ;     <span class="comment">// 此类型由外部决定  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getVar</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var ;     </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVar</span><span class="params">(T var)</span></span>&#123;  </div><div class="line">        <span class="keyword">this</span>.var = var ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;       <span class="comment">// 覆写Object类中的toString()方法  </span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var.toString() ;      </div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsDemo</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;  </div><div class="line">        Info&lt;String&gt; i1 = <span class="keyword">new</span> Info&lt;String&gt;() ;  </div><div class="line">        Info&lt;String&gt; i2 = <span class="keyword">new</span> Info&lt;String&gt;() ;  </div><div class="line">        i1.setVar(<span class="string">"HELLO"</span>) ;        <span class="comment">// 设置内容  </span></div><div class="line">        i2.setVar(<span class="string">"汤姆"</span>) ;       <span class="comment">// 设置内容  </span></div><div class="line">        add(i1,i2) ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Info&lt;T&gt; i1,Info&lt;T&gt; i2)</span></span>&#123;  </div><div class="line">        System.out.println(i1.getVar() + <span class="string">" "</span> + i2.getVar()) ;  </div><div class="line">    &#125;  </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>使用泛型统一传入的参数类型<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Number</span>&gt;</span>&#123; <span class="comment">// 指定上限，只能是数字类型  </span></div><div class="line">    <span class="keyword">private</span> T var ;     <span class="comment">// 此类型由外部决定  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getVar</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var ;     </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVar</span><span class="params">(T var)</span></span>&#123;  </div><div class="line">        <span class="keyword">this</span>.var = var ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;       <span class="comment">// 覆写Object类中的toString()方法  </span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.var.toString() ;      </div><div class="line">    &#125;  </div><div class="line">&#125;;  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsDemo</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;  </div><div class="line">        Info&lt;Integer&gt; i = fun(<span class="number">30</span>) ;  </div><div class="line">        System.out.println(i.getVar()) ;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Number&gt; <span class="function">Info&lt;T&gt; <span class="title">fun</span><span class="params">(T param)</span></span>&#123;<span class="comment">//方法中传入或返回的泛型类型由调用方法时所设置的参数类型决定  </span></div><div class="line">        Info&lt;T&gt; temp = <span class="keyword">new</span> Info&lt;T&gt;() ;      <span class="comment">// 根据传入的数据类型实例化Info  </span></div><div class="line">        temp.setVar(param) ;        <span class="comment">// 将传递的内容设置到Info对象的var属性之中  </span></div><div class="line">        <span class="keyword">return</span> temp ;   <span class="comment">// 返回实例化对象  </span></div><div class="line">    &#125;  </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<hr>
<pre><code>学习完泛型我们可以知道，泛型并非只用一个T字幕来表达，它的命名风格基本为大写的英文字母，比如ABCDEFG... 泛型可以通过继承来定义上限。可以实现泛型的方法，泛型类，泛型接口，可以定义泛型数组泛型嵌套等一系列使用方法。

它跟Object的区别：是没有泛型的情况的下，通过对类型Object的引用来实现参数的“任意化”，“任意化”带来的缺点是要做显式的强制类型转换，而这种转换是要求开发者对实际参数类型可以预知的情况下进行的。对于强制类型转换错误的情况，编译器可能不提示错误，在运行的时候才出现异常，这是一个安全隐患。

泛型的好处是在编译的时候检查类型安全，并且所有的强制转换都是自动和隐式的，提高代码的重用率。
</code></pre><p><a href="http://iteye.blog.163.com/blog/static/18630809620131472312201/" target="_blank" rel="external">参考自网易博客北漂的小羊</a><br>java编程思想第四版 泛型篇<br><strong><em>By Xiaolong：You have a dream,you got to protect it!</em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java泛型/">Java泛型</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Lambda" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/20/Lambda/" class="article-date">
  	<time datetime="2016-06-20T14:52:55.000Z" itemprop="datePublished">2016-06-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/20/Lambda/">Java中的Lambda表达式的使用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>RxJava学习第一篇，一个优美的表达式，Lambda表达式。</p>
<h5 id="闲谈："><a href="#闲谈：" class="headerlink" title="闲谈："></a>闲谈：</h5><p>之前加入某个python群的时候群验证就要求用Lambda实现求和。<br>当时好像是这么写了 Lambda x,y:x+y.<br>把这个写成一个函数就可以重复利用了，例：f = Lambda x,y:x+y  f(x,y)<br>当时有种发现新大陆的感觉，觉得python真是强大。<br>后来才发现java、C# …中也有Lambda表达式的概念<br>嗯哼，Lambda也是吊吊哒。</p>
<p>最近在学习响应式编程框架:Rxjava,扩展RxAndroid+Retrofit，还有一些大神们开发出来的Rxjava在Android中牛逼的框架。<br>RxJava其中有很多的Lambda表达式用来代码简化。感觉这种技能装逼又能减少代码量的神器真的是不可或缺啊，好了不多说废话现在先来入门一下Lambda表达式。</p>
<h4 id="一、Lambda简介"><a href="#一、Lambda简介" class="headerlink" title="一、Lambda简介"></a>一、Lambda简介</h4><p>Lambda 表达式　Lambda 表达式”是一个匿名函数，它可以包含表达式和语句，并且可用于创建委托或表达式目录树类型。<br>所有 Lambda 表达式都使用 Lambda 运算符 =&gt;；，该运算符读为“goes to”。该 Lambda 运算符的左边是输入参数（如果有），右边包含表达式或语句块。Lambda 表达式 x =&gt; x * x 读作“x goes to x times x”。</p>
<p>Lambda表达式的本质只是一个”语法糖”,由编译器推断并帮你转换包装为常规的代码,因此你可以使用更少的代码来实现同样的功能。本人建议不要乱用,因为这就和某些很高级的黑客写的代码一样,简洁,难懂,难以调试,维护人员想骂娘.<br>Lambda表达式是Java SE 8中一个重要的新特性。Lambda表达式允许你通过表达式来代替功能接口。 Lambda表达式就和方法一样,它提供了一个正常的参数列表和一个使用这些参数的主体(body,可以是一个表达式或一个代码块)。<br>Lambda表达式还增强了集合库。 Java SE 8添加了2个对集合数据进行批量操作的包: java.util.function 包以及 java.util.stream 包。 流(stream)就如同迭代器(iterator),但附加了许多额外的功能。 总的来说,Lambda表达式和 stream 是自Java语言添加泛型(Generics)和注解(annotation)以来最大的变化。 在本文中,我们将从简单到复杂的示例中见认识Lambda表达式和stream的强悍。</p>
<h4 id="二、为什么使用Lambda表达式？"><a href="#二、为什么使用Lambda表达式？" class="headerlink" title="二、为什么使用Lambda表达式？"></a>二、为什么使用Lambda表达式？</h4><p>   我们为什么需要Lambda表达式<br>   主要有三个原因：</p>
<blockquote>
<p>1.更加紧凑的代码<br>     比如Java中现有的匿名内部类以及监听器(listeners)和事件处理器(handlers）都显得很冗长<br>2.修改方法的能力（我个人理解为代码注入，或者有点类似JavaScript中传一个回调函数给另外一个函数）<br>     比如Collection接口的contains方法，当且仅当传入的元素真正包含在集合中，才返回true。而假如我们想对一个字符串集合，传入一个字符串，只要这个字符串出现在集合中（忽略大小写）就返回true。<br>     简单地说，我们想要的是传入“一些我们自己的代码”到已有的方法中，已有的方法将会执行我们传入的代码。Lambda表达式能很好地支持这点<br>3.更好地支持多核处理<br>     例如，通过Java 8新增的Lambda表达式，我们可以很方便地并行操作大集合，充分发挥多核CPU的潜能。<br>     并行处理函数如filter、map和reduce。</p>
</blockquote>
<h4 id="三、Lambda表达式的语法"><a href="#三、Lambda表达式的语法" class="headerlink" title="三、Lambda表达式的语法"></a>三、Lambda表达式的语法</h4><pre><code>基本语法:
(parameters) -&gt; expression
或
(parameters) -&gt;{ statements; }
</code></pre><p>下面是Java Lambda表达式的简单例子:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 不需要参数,返回值为 5</span></div><div class="line">() -&gt; <span class="number">5</span></div><div class="line"></div><div class="line"><span class="comment">// 2. 接收一个参数(数字类型),返回其2倍的值</span></div><div class="line">x -&gt; <span class="number">2</span> * x</div><div class="line"></div><div class="line"><span class="comment">// 3. 接受2个参数(数字),并返回他们的差值</span></div><div class="line">(x, y) -&gt; x – y</div><div class="line"></div><div class="line"><span class="comment">// 4. 接收2个int型整数,返回他们的和</span></div><div class="line">(<span class="keyword">int</span> x, <span class="keyword">int</span> y) -&gt; x + y</div><div class="line"></div><div class="line"><span class="comment">// 5. 接受一个 string 对象,并在控制台打印,不返回任何值(看起来像是返回void)</span></div><div class="line">(String s) -&gt; System.out.print(s)</div></pre></td></tr></table></figure>
<p>好了，是不是对这种表达方式很感兴趣，让我们来看看开发需要准备的开发环境吧。</p>
<ul>
<li>JAVA8 (没有的话赶紧去装一个)</li>
<li>Eclipse 任意版本能运行java就行</li>
</ul>
<p>现在,我们已经知道什么是Lambda表达式，并且做好了前期准备，让我们先从一些基本的例子开始。 在本节中,我们将看到Lambda表达式如何影响我们编码的方式。 假设有一个玩家List，程序员可以使用 for 语句 (“for 循环”)来遍历,在Java SE 8中可以转换为另一种形式:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">String[] atp = &#123;<span class="string">"Rafael Nadal"</span>, <span class="string">"Novak Djokovic"</span>,</div><div class="line">       <span class="string">"Stanislas Wawrinka"</span>,</div><div class="line">       <span class="string">"David Ferrer"</span>,<span class="string">"Roger Federer"</span>,</div><div class="line">       <span class="string">"Andy Murray"</span>,<span class="string">"Tomas Berdych"</span>,</div><div class="line">       <span class="string">"Juan Martin Del Potro"</span>&#125;;</div><div class="line">List&lt;String&gt; players =  Arrays.asList(atp);</div><div class="line"></div><div class="line"><span class="comment">// 以前的循环方式</span></div><div class="line"><span class="keyword">for</span> (String player : players) &#123;</div><div class="line">     System.out.print(player + <span class="string">"; "</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 使用 Lambda 表达式以及函数操作(functional operation)</span></div><div class="line">players.forEach((player) -&gt; System.out.print(player + <span class="string">"; "</span>));</div><div class="line"></div><div class="line"><span class="comment">// 在 Java 8 中使用双冒号操作符(double colon operator)</span></div><div class="line">players.forEach(System.out::println);</div></pre></td></tr></table></figure>
<p>可以看到Lambda表达式可以将我们的代码缩减到一行。 另一个例子是在图形用户界面程序中,匿名类可以使用Lambda表达式来代替。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用匿名内部类</span></div><div class="line">btn.setOnAction(<span class="keyword">new</span> EventHandler&lt;ActionEvent&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(ActionEvent event)</span> </span>&#123;</div><div class="line">              System.out.println(<span class="string">"Hello World!"</span>); </div><div class="line">          &#125;</div><div class="line">    &#125;);</div><div class="line"> </div><div class="line"><span class="comment">// 或者使用 Lambda expression</span></div><div class="line">btn.setOnAction(event -&gt; System.out.println(<span class="string">"Hello World!"</span>));</div></pre></td></tr></table></figure></p>
<p>下面是使用Lambdas 来实现 Runnable接口 的示例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 1.1使用匿名内部类</span></div><div class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello world !"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;).start();</div><div class="line"></div><div class="line"><span class="comment">// 1.2使用 Lambda expression</span></div><div class="line"><span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">"Hello world !"</span>)).start();</div><div class="line"></div><div class="line"><span class="comment">// 2.1使用匿名内部类</span></div><div class="line">Runnable race1 = <span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello world !"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 2.2使用 Lambda expression</span></div><div class="line">Runnable race2 = () -&gt; System.out.println(<span class="string">"Hello world !"</span>);</div><div class="line"> </div><div class="line"><span class="comment">// 直接调用 run 方法(没开新线程哦!)</span></div><div class="line">race1.run();</div><div class="line">race2.run();</div></pre></td></tr></table></figure></p>
<p>Runnable 的 Lambda表达式,使用块格式,将五行代码转换成单行语句。 接下来,在下一节中我们将使用Lambdas对集合进行排序。</p>
<h6 id="使用Lambdas排序集合"><a href="#使用Lambdas排序集合" class="headerlink" title="使用Lambdas排序集合"></a>使用Lambdas排序集合</h6><p>在Java中,Comparator 类被用来排序集合。 在下面的例子中,我们将根据球员的 name, surname, name 长度 以及最后一个字母。 和前面的示例一样,先使用匿名内部类来排序,然后再使用Lambda表达式精简我们的代码。<br>在第一个例子中,我们将根据name来排序list。 使用旧的方式,代码如下所示:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">String[] players = &#123;<span class="string">"Rafael Nadal"</span>, <span class="string">"Novak Djokovic"</span>, </div><div class="line">    <span class="string">"Stanislas Wawrinka"</span>, <span class="string">"David Ferrer"</span>,</div><div class="line">    <span class="string">"Roger Federer"</span>, <span class="string">"Andy Murray"</span>,</div><div class="line">    <span class="string">"Tomas Berdych"</span>, <span class="string">"Juan Martin Del Potro"</span>,</div><div class="line">    <span class="string">"Richard Gasquet"</span>, <span class="string">"John Isner"</span>&#125;;</div><div class="line"> </div><div class="line"><span class="comment">// 1.1 使用匿名内部类根据 name 排序 players</span></div><div class="line">Arrays.sort(players, <span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (s1.compareTo(s2));</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>使用lambdas,可以通过下面的代码实现同样的功能:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1.2 使用 lambda expression 排序 players</span></div><div class="line">Comparator&lt;String&gt; sortByName = (String s1, String s2) -&gt; (s1.compareTo(s2));</div><div class="line">Arrays.sort(players, sortByName);</div><div class="line"></div><div class="line"><span class="comment">// 1.3 也可以采用如下形式:</span></div><div class="line">Arrays.sort(players, (String s1, String s2) -&gt; (s1.compareTo(s2)));</div></pre></td></tr></table></figure></p>
<p>其他的排序如下所示。 和上面的示例一样,代码分别通过匿名内部类和一些lambda表达式来实现Comparator :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1.1 使用匿名内部类根据 surname 排序 players</span></div><div class="line">Arrays.sort(players, <span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (s1.substring(s1.indexOf(<span class="string">" "</span>)).compareTo(s2.substring(s2.indexOf(<span class="string">" "</span>))));</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 1.2 使用 lambda expression 排序,根据 surname</span></div><div class="line">Comparator&lt;String&gt; sortBySurname = (String s1, String s2) -&gt; </div><div class="line">    ( s1.substring(s1.indexOf(<span class="string">" "</span>)).compareTo( s2.substring(s2.indexOf(<span class="string">" "</span>)) ) );</div><div class="line">Arrays.sort(players, sortBySurname);</div><div class="line"></div><div class="line"><span class="comment">// 1.3 或者这样,怀疑原作者是不是想错了,括号好多...</span></div><div class="line">Arrays.sort(players, (String s1, String s2) -&gt; </div><div class="line">      ( s1.substring(s1.indexOf(<span class="string">" "</span>)).compareTo( s2.substring(s2.indexOf(<span class="string">" "</span>)) ) ) </div><div class="line">    );</div><div class="line"></div><div class="line"><span class="comment">// 2.1 使用匿名内部类根据 name lenght 排序 players</span></div><div class="line">Arrays.sort(players, <span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (s1.length() - s2.length());</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 2.2 使用 lambda expression 排序,根据 name lenght</span></div><div class="line">Comparator&lt;String&gt; sortByNameLenght = (String s1, String s2) -&gt; (s1.length() - s2.length());</div><div class="line">Arrays.sort(players, sortByNameLenght);</div><div class="line"></div><div class="line"><span class="comment">// 2.3 or this</span></div><div class="line">Arrays.sort(players, (String s1, String s2) -&gt; (s1.length() - s2.length()));</div><div class="line"></div><div class="line"><span class="comment">// 3.1 使用匿名内部类排序 players, 根据最后一个字母</span></div><div class="line">Arrays.sort(players, <span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (s1.charAt(s1.length() - <span class="number">1</span>) - s2.charAt(s2.length() - <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 3.2 使用 lambda expression 排序,根据最后一个字母</span></div><div class="line">Comparator&lt;String&gt; sortByLastLetter = </div><div class="line">    (String s1, String s2) -&gt; (s1.charAt(s1.length() - <span class="number">1</span>) - s2.charAt(s2.length() - <span class="number">1</span>));</div><div class="line">Arrays.sort(players, sortByLastLetter);</div><div class="line"></div><div class="line"><span class="comment">// 3.3 or this</span></div><div class="line">Arrays.sort(players, (String s1, String s2) -&gt; (s1.charAt(s1.length() - <span class="number">1</span>) - s2.charAt(s2.length() - <span class="number">1</span>)));</div></pre></td></tr></table></figure></p>
<p>就是这样,简洁又直观。 在下一节中我们将探索更多lambdas的能力,并将其与 stream 结合起来使用。</p>
<h6 id="使用Lambdas和Streams"><a href="#使用Lambdas和Streams" class="headerlink" title="使用Lambdas和Streams"></a>使用Lambdas和Streams</h6><p>Stream是对集合的包装,通常和lambda一起使用。 使用lambdas可以支持许多操作,如 map, filter, limit, sorted, count, min, max, sum, collect 等等。 同样,Stream使用懒运算,他们并不会真正地读取所有数据,遇到像getFirst() 这样的方法就会结束链式语法。 在接下来的例子中,我们将探索lambdas和streams 能做什么。 我们创建了一个Person类并使用这个类来添加一些数据到list中,将用于进一步流操作。 Person 只是一个简单的MODEL类:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> String firstName, lastName, job, gender;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> salary, age;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String firstName, String lastName, String job,</span></span></div><div class="line">                String gender, <span class="keyword">int</span> age, <span class="keyword">int</span> salary)       &#123;</div><div class="line">          <span class="keyword">this</span>.firstName = firstName;</div><div class="line">          <span class="keyword">this</span>.lastName = lastName;</div><div class="line">          <span class="keyword">this</span>.gender = gender;</div><div class="line">          <span class="keyword">this</span>.age = age;</div><div class="line">          <span class="keyword">this</span>.job = job;</div><div class="line">          <span class="keyword">this</span>.salary = salary;</div><div class="line">&#125;</div><div class="line"><span class="comment">// Getter and Setter </span></div><div class="line"><span class="comment">// . . . . .</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>接下来,我们将创建两个list,都用来存放Person对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Person&gt; javaProgrammers = <span class="keyword">new</span> ArrayList&lt;Person&gt;() &#123;</div><div class="line">  &#123;</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Elsdon"</span>, <span class="string">"Jaycob"</span>, <span class="string">"Java programmer"</span>, <span class="string">"male"</span>, <span class="number">43</span>, <span class="number">2000</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Tamsen"</span>, <span class="string">"Brittany"</span>, <span class="string">"Java programmer"</span>, <span class="string">"female"</span>, <span class="number">23</span>, <span class="number">1500</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Floyd"</span>, <span class="string">"Donny"</span>, <span class="string">"Java programmer"</span>, <span class="string">"male"</span>, <span class="number">33</span>, <span class="number">1800</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Sindy"</span>, <span class="string">"Jonie"</span>, <span class="string">"Java programmer"</span>, <span class="string">"female"</span>, <span class="number">32</span>, <span class="number">1600</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Vere"</span>, <span class="string">"Hervey"</span>, <span class="string">"Java programmer"</span>, <span class="string">"male"</span>, <span class="number">22</span>, <span class="number">1200</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Maude"</span>, <span class="string">"Jaimie"</span>, <span class="string">"Java programmer"</span>, <span class="string">"female"</span>, <span class="number">27</span>, <span class="number">1900</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Shawn"</span>, <span class="string">"Randall"</span>, <span class="string">"Java programmer"</span>, <span class="string">"male"</span>, <span class="number">30</span>, <span class="number">2300</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Jayden"</span>, <span class="string">"Corrina"</span>, <span class="string">"Java programmer"</span>, <span class="string">"female"</span>, <span class="number">35</span>, <span class="number">1700</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Palmer"</span>, <span class="string">"Dene"</span>, <span class="string">"Java programmer"</span>, <span class="string">"male"</span>, <span class="number">33</span>, <span class="number">2000</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Addison"</span>, <span class="string">"Pam"</span>, <span class="string">"Java programmer"</span>, <span class="string">"female"</span>, <span class="number">34</span>, <span class="number">1300</span>));</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">List&lt;Person&gt; phpProgrammers = <span class="keyword">new</span> ArrayList&lt;Person&gt;() &#123;</div><div class="line">  &#123;</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Jarrod"</span>, <span class="string">"Pace"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"male"</span>, <span class="number">34</span>, <span class="number">1550</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Clarette"</span>, <span class="string">"Cicely"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"female"</span>, <span class="number">23</span>, <span class="number">1200</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Victor"</span>, <span class="string">"Channing"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"male"</span>, <span class="number">32</span>, <span class="number">1600</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Tori"</span>, <span class="string">"Sheryl"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"female"</span>, <span class="number">21</span>, <span class="number">1000</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Osborne"</span>, <span class="string">"Shad"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"male"</span>, <span class="number">32</span>, <span class="number">1100</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Rosalind"</span>, <span class="string">"Layla"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"female"</span>, <span class="number">25</span>, <span class="number">1300</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Fraser"</span>, <span class="string">"Hewie"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"male"</span>, <span class="number">36</span>, <span class="number">1100</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Quinn"</span>, <span class="string">"Tamara"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"female"</span>, <span class="number">21</span>, <span class="number">1000</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Alvin"</span>, <span class="string">"Lance"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"male"</span>, <span class="number">38</span>, <span class="number">1600</span>));</div><div class="line">    add(<span class="keyword">new</span> Person(<span class="string">"Evonne"</span>, <span class="string">"Shari"</span>, <span class="string">"PHP programmer"</span>, <span class="string">"female"</span>, <span class="number">40</span>, <span class="number">1800</span>));</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>现在我们使用forEach方法来迭代输出上述列表:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"所有程序员的姓名:"</span>);</div><div class="line">javaProgrammers.forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div><div class="line">phpProgrammers.forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div></pre></td></tr></table></figure></p>
<p>我们同样使用forEach方法,增加程序员的工资5%:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"给程序员加薪 5% :"</span>);</div><div class="line">Consumer&lt;Person&gt; giveRaise = e -&gt; e.setSalary(e.getSalary() / <span class="number">100</span> * <span class="number">5</span> + e.getSalary());</div><div class="line"></div><div class="line">javaProgrammers.forEach(giveRaise);</div><div class="line">phpProgrammers.forEach(giveRaise);</div></pre></td></tr></table></figure></p>
<p>另一个有用的方法是过滤器filter() ,让我们显示月薪超过1400美元的PHP程序员:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"下面是月薪超过 $1,400 的PHP程序员:"</span>)</div><div class="line">phpProgrammers.stream()</div><div class="line">          .filter((p) -&gt; (p.getSalary() &gt; <span class="number">1400</span>))</div><div class="line">          .forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div></pre></td></tr></table></figure></p>
<p>我们也可以定义过滤器,然后重用它们来执行其他操作:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 定义 filters</span></div><div class="line">Predicate&lt;Person&gt; ageFilter = (p) -&gt; (p.getAge() &gt; <span class="number">25</span>);</div><div class="line">Predicate&lt;Person&gt; salaryFilter = (p) -&gt; (p.getSalary() &gt; <span class="number">1400</span>);</div><div class="line">Predicate&lt;Person&gt; genderFilter = (p) -&gt; (<span class="string">"female"</span>.equals(p.getGender()));</div><div class="line"></div><div class="line">System.out.println(<span class="string">"下面是年龄大于 24岁且月薪在$1,400以上的女PHP程序员:"</span>);</div><div class="line">phpProgrammers.stream()</div><div class="line">          .filter(ageFilter)</div><div class="line">          .filter(salaryFilter)</div><div class="line">          .filter(genderFilter)</div><div class="line">          .forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div><div class="line"></div><div class="line"><span class="comment">// 重用filters</span></div><div class="line">System.out.println(<span class="string">"年龄大于 24岁的女性 Java programmers:"</span>);</div><div class="line">javaProgrammers.stream()</div><div class="line">          .filter(ageFilter)</div><div class="line">          .filter(genderFilter)</div><div class="line">          .forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div></pre></td></tr></table></figure></p>
<p>使用limit方法,可以限制结果集的个数:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"最前面的3个 Java programmers:"</span>);</div><div class="line">javaProgrammers.stream()</div><div class="line">          .limit(<span class="number">3</span>)</div><div class="line">          .forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div><div class="line"></div><div class="line"></div><div class="line">System.out.println(<span class="string">"最前面的3个女性 Java programmers:"</span>);</div><div class="line">javaProgrammers.stream()</div><div class="line">          .filter(genderFilter)</div><div class="line">          .limit(<span class="number">3</span>)</div><div class="line">          .forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; "</span>, p.getFirstName(), p.getLastName()));</div></pre></td></tr></table></figure></p>
<p>排序呢? 我们在stream中能处理吗? 答案是肯定的。 在下面的例子中,我们将根据名字和薪水排序Java程序员,放到一个list中,然后显示列表:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"根据 name 排序,并显示前5个 Java programmers:"</span>);</div><div class="line">List&lt;Person&gt; sortedJavaProgrammers = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .sorted((p, p2) -&gt; (p.getFirstName().compareTo(p2.getFirstName())))</div><div class="line">          .limit(<span class="number">5</span>)</div><div class="line">          .collect(toList());</div><div class="line"></div><div class="line">sortedJavaProgrammers.forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; %n"</span>, p.getFirstName(), p.getLastName()));</div><div class="line"> </div><div class="line">System.out.println(<span class="string">"根据 salary 排序 Java programmers:"</span>);</div><div class="line">sortedJavaProgrammers = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .sorted( (p, p2) -&gt; (p.getSalary() - p2.getSalary()) )</div><div class="line">          .collect( toList() );</div><div class="line"></div><div class="line">sortedJavaProgrammers.forEach((p) -&gt; System.out.printf(<span class="string">"%s %s; %n"</span>, p.getFirstName(), p.getLastName()));</div></pre></td></tr></table></figure></p>
<p>如果我们只对最低和最高的薪水感兴趣,比排序后选择第一个/最后一个 更快的是min和max方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"工资最低的 Java programmer:"</span>);</div><div class="line">Person pers = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .min((p1, p2) -&gt; (p1.getSalary() - p2.getSalary()))</div><div class="line">          .get()</div><div class="line"></div><div class="line">System.out.printf(<span class="string">"Name: %s %s; Salary: $%,d."</span>, pers.getFirstName(), pers.getLastName(), pers.getSalary())</div><div class="line"></div><div class="line">System.out.println(<span class="string">"工资最高的 Java programmer:"</span>);</div><div class="line">Person person = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .max((p, p2) -&gt; (p.getSalary() - p2.getSalary()))</div><div class="line">          .get()</div><div class="line"></div><div class="line">System.out.printf(<span class="string">"Name: %s %s; Salary: $%,d."</span>, person.getFirstName(), person.getLastName(), person.getSalary())</div></pre></td></tr></table></figure></p>
<p>上面的例子中我们已经看到 collect 方法是如何工作的。 结合 map 方法,我们可以使用 collect 方法来将我们的结果集放到一个字符串,一个 Set 或一个TreeSet中:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"将 PHP programmers 的 first name 拼接成字符串:"</span>);</div><div class="line">String phpDevelopers = phpProgrammers</div><div class="line">          .stream()</div><div class="line">          .map(Person::getFirstName)</div><div class="line">          .collect(joining(<span class="string">" ; "</span>)); <span class="comment">// 在进一步的操作中可以作为标记(token)   </span></div><div class="line"></div><div class="line">System.out.println(<span class="string">"将 Java programmers 的 first name 存放到 Set:"</span>);</div><div class="line">Set&lt;String&gt; javaDevFirstName = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .map(Person::getFirstName)</div><div class="line">          .collect(toSet());</div><div class="line"></div><div class="line">System.out.println(<span class="string">"将 Java programmers 的 first name 存放到 TreeSet:"</span>);</div><div class="line">TreeSet&lt;String&gt; javaDevLastName = javaProgrammers</div><div class="line">          .stream()</div><div class="line">          .map(Person::getLastName)</div><div class="line">          .collect(toCollection(TreeSet::<span class="keyword">new</span>));</div></pre></td></tr></table></figure></p>
<p>Streams 还可以是并行的(parallel)。 示例如下:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">System.out.println(<span class="string">"计算付给 Java programmers 的所有money:"</span>);</div><div class="line"><span class="keyword">int</span> totalSalary = javaProgrammers</div><div class="line">          .parallelStream()</div><div class="line">          .mapToInt(p -&gt; p.getSalary())</div><div class="line">          .sum();</div></pre></td></tr></table></figure></p>
<p>我们可以使用summaryStatistics方法获得stream 中元素的各种汇总数据。 接下来,我们可以访问这些方法,比如getMax, getMin, getSum或getAverage:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//计算 count, min, max, sum, and average for numbers</span></div><div class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>);</div><div class="line">IntSummaryStatistics stats = numbers</div><div class="line">          .stream()</div><div class="line">          .mapToInt((x) -&gt; x)</div><div class="line">          .summaryStatistics();</div><div class="line"></div><div class="line">System.out.println(<span class="string">"List中最大的数字 : "</span> + stats.getMax());</div><div class="line">System.out.println(<span class="string">"List中最小的数字 : "</span> + stats.getMin());</div><div class="line">System.out.println(<span class="string">"所有数字的总和   : "</span> + stats.getSum());</div><div class="line">System.out.println(<span class="string">"所有数字的平均值 : "</span> + stats.getAverage());</div></pre></td></tr></table></figure></p>
<p>OK,就是酱,就是这么吊，希望你喜欢!</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><pre><code>在本文中,我们学会了使用lambda表达式的不同方式,从基本的示例,到使用lambdas和streams的复杂示例。 此外,我们还学习了如何使用lambda表达式与Comparator 类来对Java集合进行排序。
</code></pre><p><strong><em>By Xiaolong：没有伞的孩子必须努力奔跑！</em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lambda/">Lambda</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Reptile3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/01/Reptile3/" class="article-date">
  	<time datetime="2016-06-01T12:56:04.000Z" itemprop="datePublished">2016-06-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/01/Reptile3/">java爬虫教程：模拟用户表单登录</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这个是爬虫教程第三篇，教大家如何模拟用户表单登录。</p>
<p>前期准备：</p>
<ul>
<li>JSOUP 1.83 jar包</li>
<li>Eclipse 任意版本能运行java就行</li>
<li>谷歌浏览器</li>
</ul>
<h5 id="第一步：依然是分析页面结构"><a href="#第一步：依然是分析页面结构" class="headerlink" title="第一步：依然是分析页面结构"></a>第一步：依然是分析页面结构</h5><p>我们要模拟CSDN用户表单登录，来获取用户登录后的数据。<br>在一些网站和论坛，部分内容总是需要会员用户等需要一定权限的用户才能看得到。<br>好了由此可见模拟用户表单登录的重要性了。</p>
<p>进入<a href="https://passport.csdn.net/account/login" target="_blank" rel="external">登录页</a>，在页面上按F12查看页面元素的内容。<br><img src="http://img.my.csdn.net/uploads/201606/13/1465824740_6409.png" alt=""><br>这次我们只要form标签，和其内部的账号密码输入框信息。</p>
<h5 id="第二步：讲解一下Post需要的操作具体流程"><a href="#第二步：讲解一下Post需要的操作具体流程" class="headerlink" title="第二步：讲解一下Post需要的操作具体流程"></a>第二步：讲解一下Post需要的操作具体流程</h5><p>一般表单的id都是唯一的，所以要过滤出表单是很容易的一件事情<br>这里表单的id值是fm1<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">List&lt;Element&gt; et = d1.select(<span class="string">"#fm1"</span>);<span class="comment">// 获取form表单</span></div></pre></td></tr></table></figure></p>
<p>下一步是获得表单下面的帐号和密码输入框控件，同样可以根据id来过滤，不过这里使用的是name属性。<br>一般网站设计都会把name属性配上value，post到服务端。<br>直接在Map对象中put帐号和密码的键值对，代码如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Map&lt;String, String&gt; datas = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">datas.put(e.attr(<span class="string">"name"</span>), e.attr(<span class="string">"value"</span>));</div></pre></td></tr></table></figure></p>
<p>这个就是表单的帐号密码输入框的键值<br>也可以不做遍历直接<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">datas.put(<span class="string">"username"</span>, <span class="string">"your username"</span>);</div><div class="line">datas.put(<span class="string">"password"</span>, <span class="string">"your password"</span>);</div></pre></td></tr></table></figure></p>
<p>哈哈，是不是少了许多。<br>经过这一步之后datas里已经存放了我们要post的数据了。<br>可以执行第二次请求将登录信息post上去了。<br>Response login = con2.ignoreContentType(true).method(Method.POST)<br>                .data(datas).cookies(rs.cookies()).execute();<br>携带登录的Map数据和第一次登录返回的cookie，进行post。</p>
<h5 id="第三步：开始写代码"><a href="#第三步：开始写代码" class="headerlink" title="第三步：开始写代码"></a>第三步：开始写代码</h5><p>好了就是这么简单。接下来看看代码吧。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.jsoup.Connection;</div><div class="line"><span class="keyword">import</span> org.jsoup.Jsoup;</div><div class="line"><span class="keyword">import</span> org.jsoup.Connection.Method;</div><div class="line"><span class="keyword">import</span> org.jsoup.Connection.Response;</div><div class="line"><span class="keyword">import</span> org.jsoup.nodes.Document;</div><div class="line"><span class="keyword">import</span> org.jsoup.nodes.Element;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 使用Jsoup模拟登陆CSDN</div><div class="line"> * </div><div class="line"> * </div><div class="line"> * 大体思路如下:</div><div class="line"> * </div><div class="line"> * 第一次请求登陆页面，获取页面信息，包含表单信息，和cookie（这个很重要），拿不到，会模拟登陆不上</div><div class="line"> * </div><div class="line"> * </div><div class="line"> * 第二次登陆，设置用户名，密码，把第一次的cooking，放进去，即可</div><div class="line"> * </div><div class="line"> * 怎么确定是否登陆成功？</div><div class="line"> * </div><div class="line"> * 登陆后，打印页面，会看到账户的详细信息。</div><div class="line"> * </div><div class="line"> * </div><div class="line"> * <span class="doctag">@date</span> 2016年6月13日</div><div class="line"> * <span class="doctag">@author</span> xiaolong</div><div class="line"> * </div><div class="line"> * </div><div class="line"> * **/</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginDemo</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">		LoginDemo loginDemo = <span class="keyword">new</span> LoginDemo();</div><div class="line">		loginDemo.login(<span class="string">"your account"</span>, <span class="string">"password"</span>);<span class="comment">// 输入CSDN的用户名，和密码</span></div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 模拟登陆CSDN</div><div class="line">	 * </div><div class="line">	 * <span class="doctag">@param</span> userName</div><div class="line">	 *            用户名</div><div class="line">	 * <span class="doctag">@param</span> pwd</div><div class="line">	 *            密码</div><div class="line">	 * </div><div class="line">	 * **/</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String userName, String pwd)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">		<span class="comment">// 第一次请求</span></div><div class="line">		Connection con = Jsoup</div><div class="line">				.connect(<span class="string">"https://passport.csdn.net/account/login"</span>);<span class="comment">// 获取连接</span></div><div class="line">		con.header(<span class="string">"User-Agent"</span>,</div><div class="line">				<span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0"</span>);<span class="comment">// 配置模拟浏览器</span></div><div class="line">		Response rs = con.execute();<span class="comment">// 获取响应</span></div><div class="line">		Document d1 = Jsoup.parse(rs.body());<span class="comment">// 转换为Dom树</span></div><div class="line">		List&lt;Element&gt; et = d1.select(<span class="string">"#fm1"</span>);<span class="comment">// 获取form表单，可以通过查看页面源码代码得知</span></div><div class="line"></div><div class="line">		<span class="comment">// 获取，cooking和表单属性，下面map存放post时的数据</span></div><div class="line">		Map&lt;String, String&gt; datas = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">		<span class="keyword">for</span> (Element e : et.get(<span class="number">0</span>).getAllElements()) &#123;</div><div class="line">			<span class="keyword">if</span> (e.attr(<span class="string">"name"</span>).equals(<span class="string">"username"</span>)) &#123;</div><div class="line">				e.attr(<span class="string">"value"</span>, userName);<span class="comment">// 设置用户名</span></div><div class="line">			&#125;</div><div class="line"></div><div class="line">			<span class="keyword">if</span> (e.attr(<span class="string">"name"</span>).equals(<span class="string">"password"</span>)) &#123;</div><div class="line">				e.attr(<span class="string">"value"</span>, pwd); <span class="comment">// 设置用户密码</span></div><div class="line">			&#125;</div><div class="line"></div><div class="line">			<span class="keyword">if</span> (e.attr(<span class="string">"name"</span>).length() &gt; <span class="number">0</span>) &#123;<span class="comment">// 排除空值表单属性</span></div><div class="line">				datas.put(e.attr(<span class="string">"name"</span>), e.attr(<span class="string">"value"</span>));</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="comment">/**</span></div><div class="line">		 * 第二次请求，post表单数据，以及cookie信息</div><div class="line">		 * </div><div class="line">		 * **/</div><div class="line">		Connection con2 = Jsoup</div><div class="line">				.connect(<span class="string">"https://passport.csdn.net/account/login"</span>);</div><div class="line">		con2.header(<span class="string">"User-Agent"</span>,</div><div class="line">				<span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0"</span>);</div><div class="line">		<span class="comment">// 设置cookie和post上面的map数据</span></div><div class="line">		Response login = con2.ignoreContentType(<span class="keyword">true</span>).method(Method.POST)</div><div class="line">				.data(datas).cookies(rs.cookies()).execute();</div><div class="line">		<span class="comment">// 打印，登陆成功后的信息</span></div><div class="line">		System.out.println(login.body());</div><div class="line"></div><div class="line">		<span class="comment">// 登陆成功后的cookie信息，可以保存到本地，以后登陆时，只需一次登陆即可</span></div><div class="line">		Map&lt;String, String&gt; map = login.cookies();</div><div class="line">		<span class="keyword">for</span> (String s : map.keySet()) &#123;</div><div class="line">			System.out.println(s + <span class="string">"      "</span> + map.get(s));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><pre><code>这个类中写了两次网站访问的请求
第一次请求用来获取cookie信息
第二次请求将携带cookie和登录数据的信息post出去用来模拟登录。
就是这么简单~~~

小Tips:
想要模拟用户表单登录，链接头信息是不可少的，&quot;User-Agent&quot;代表的是浏览器访问信息。
通过下图可以看到请求头可以有这么多的信息，
服务端可能会通过约束请求头来判别用户post/get的信息是否合法
所以请求头很重要~请求头很重要~请求头很重要~（重要的事情说三遍）
</code></pre><p><img src="http://img.my.csdn.net/uploads/201606/13/1465827533_1458.png" alt=""></p>
<pre><code>这个是登录后每一次操作都需要携带的头部信息。可以通过F12查看页面网络访问状态来查看请求头和返回头。
好啦，有了模拟表单登录了，是时候去大展身手了。
爬虫教程到此结束，希望有兴趣的小伙伴可以继续深入研究
</code></pre><p><strong><em>By Xiaolong：You have a dream,you got to protect it! </em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reptile/">Reptile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Reptile2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/08/Reptile2/" class="article-date">
  	<time datetime="2016-05-08T14:30:56.000Z" itemprop="datePublished">2016-05-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/08/Reptile2/">java爬虫教程：爬取CSDN博客文章</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这个是爬虫教程第二篇，教大家如何爬取普通页面的内容。</p>
<p>前期准备：</p>
<ul>
<li>JSOUP 1.83 jar包</li>
<li>Eclipse 任意版本能运行java就行</li>
<li>谷歌浏览器</li>
</ul>
<h5 id="第一步：分析页面结构"><a href="#第一步：分析页面结构" class="headerlink" title="第一步：分析页面结构"></a>第一步：分析页面结构</h5><p>我们要爬CSDN博客文章，直接访问某个人的CSDN博客主页，比如说我的CSDN主页：<a href="http://blog.csdn.net/guoxiaolongonly" target="_blank" rel="external">http://blog.csdn.net/guoxiaolongonly</a><br>进入主页，在页面上按F12查看标签的内容。<br><img src="http://img.blog.csdn.net/20160525125951156?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br>可以看到如上内容，基本的html就是js+css+html标签的构造，我们使用比较多的是a、img这两个元素下的内容。第一个是链接的元素，通常获取这个来实现往后的链接的跳转。第二个是图片元素，有时候需要爬图片链接来下载图片就爬这个Tag来过滤。里面的内容也都是一个链接地址。</p>
<h5 id="第二步：选取合适的过滤方法"><a href="#第二步：选取合适的过滤方法" class="headerlink" title="第二步：选取合适的过滤方法"></a>第二步：选取合适的过滤方法</h5><p>我现在想要爬的就是这个标题中的链接。<br><img src="http://img.blog.csdn.net/20160525130008173?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>这个标签里href属性放了我想要访问的文章详情的链接</p>
<pre><code>可以使用Jsoup的方法：Elements elements = doc.getElementsByTag(&quot;a&quot;);//找到所有a标签
对a标签进行过滤就行了
也可以直接获取class标签下的内容，再在这个class下找到a标签获取a标签的href属性值。
如：Element elementTitle = document.getElementsByClass(&quot;link_title&quot;).first();//标题。
这样只需要再找到这个elementTitle下的a元素就好了。
</code></pre><p>当然JSOUP过滤标签的方式很多，可以根据需要选择合适的方法来过滤。</p>
<h5 id="第三步：开始写代码"><a href="#第三步：开始写代码" class="headerlink" title="第三步：开始写代码"></a>第三步：开始写代码</h5><p>好了就是这么简单。接下来看看代码吧。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.BufferedWriter;</div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.jsoup.Jsoup;</div><div class="line"><span class="keyword">import</span> org.jsoup.nodes.Document;</div><div class="line"><span class="keyword">import</span> org.jsoup.nodes.Element;</div><div class="line"><span class="keyword">import</span> org.jsoup.select.Elements;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySearchTest</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String url = <span class="string">"http://blog.csdn.net"</span>;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String blogName = <span class="string">"guoxiaolongonly"</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		getArticleListFromUrl(url+<span class="string">"/"</span> + blogName);</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 获取文章列表</div><div class="line">	 * <span class="doctag">@param</span> listurl</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getArticleListFromUrl</span><span class="params">(String listurl)</span> </span>&#123;</div><div class="line">		Document doc = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			doc = Jsoup.connect(listurl).userAgent(<span class="string">"Mozilla/5.0"</span>).timeout(<span class="number">3000</span>).post();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// System.out.println(doc);</span></div><div class="line">		Elements elements = doc.getElementsByTag(<span class="string">"a"</span>);<span class="comment">//找到所有a标签</span></div><div class="line">		<span class="keyword">for</span> (Element element : elements) &#123;</div><div class="line">			String relHref = element.attr(<span class="string">"href"</span>); <span class="comment">// == "/"这个是href的属性值，一般都是链接。这里放的是文章的连接</span></div><div class="line">			String linkHref = element.text();</div><div class="line">			 <span class="comment">//用if语句过滤掉不是文章链接的内容。因为文章的链接有两个，但评论的链接只有一个，反正指向相同的页面就拿评论的链接来用吧</span></div><div class="line">			<span class="keyword">if</span> (!relHref.startsWith(<span class="string">"http://"</span>) &amp;&amp; relHref.contains(<span class="string">"details"</span>) &amp;&amp; relHref.endsWith(<span class="string">"comments"</span>))</div><div class="line">			&#123;</div><div class="line">				StringBuffer sb = <span class="keyword">new</span> StringBuffer();</div><div class="line">				sb.append(url).append(relHref);</div><div class="line">				System.out.println(sb.substring(<span class="number">0</span>, sb.length() - <span class="number">9</span>));<span class="comment">//去掉最后的#comment输出</span></div><div class="line">				getArticleFromUrl(sb.substring(<span class="number">0</span>, sb.length() - <span class="number">9</span>));<span class="comment">//可以通过这个url获取文章了</span></div><div class="line">			&#125;</div><div class="line"><span class="comment">//			System.out.println(linkHref);</span></div><div class="line">			<span class="keyword">if</span>(linkHref.equals(<span class="string">"下一页"</span>))<span class="comment">//如果有下一页</span></div><div class="line">			&#123;</div><div class="line">				getArticleListFromUrl(url + relHref);<span class="comment">//获取下一页的列表</span></div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 获取文章内容</div><div class="line">	 * <span class="doctag">@param</span> detailurl</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getArticleFromUrl</span><span class="params">(String detailurl)</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Document document = Jsoup.connect(detailurl).userAgent(<span class="string">"Mozilla/5.0"</span>).timeout(<span class="number">3000</span>).post();</div><div class="line">			Element elementTitle = document.getElementsByClass(<span class="string">"link_title"</span>).first();<span class="comment">//标题。 这边根据class的内容来过滤</span></div><div class="line">			System.out.println(elementTitle.text());</div><div class="line">			String filename = elementTitle.text().replaceAll(<span class="string">"/"</span>, <span class="string">"或"</span>);</div><div class="line">			Element elementContent = document.getElementsByClass(<span class="string">"article_content"</span>).first();<span class="comment">//内容。</span></div><div class="line">			saveArticle(filename , elementContent.text(), blogName);</div><div class="line">			<span class="comment">// String Content =elementContent.te  xt().replaceAll(" ", "\t");</span></div><div class="line">			<span class="comment">// System.out.println(elementContent.text()+"\n");</span></div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">    </div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 保存文章到本地</div><div class="line">	 * <span class="doctag">@param</span> titile</div><div class="line">	 * <span class="doctag">@param</span> content</div><div class="line">	 * <span class="doctag">@param</span> blogName</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">saveArticle</span><span class="params">(String titile, String content, String blogName)</span> </span>&#123;</div><div class="line">		String lujing = <span class="string">"d:\\MyLoadArticle\\"</span> + blogName + <span class="string">"\\"</span> + titile + <span class="string">".txt"</span>;<span class="comment">//保存到本地的路径和文件名</span></div><div class="line">		File file = <span class="keyword">new</span> File(lujing);</div><div class="line">		<span class="keyword">if</span> (!file.getParentFile().exists()) &#123;</div><div class="line">			file.getParentFile().mkdirs();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			file.createNewFile();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			FileWriter fw = <span class="keyword">new</span> FileWriter(file, <span class="keyword">true</span>);</div><div class="line">			BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(fw);</div><div class="line">			bw.write(content);</div><div class="line">			bw.flush();</div><div class="line">			bw.close();</div><div class="line">			fw.close();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><pre><code>这个类中我封装了获取文章列表、获取文章内容保存文章内容的方法。
首先解析首页获取首列表页中每个文章的链接，再依次访问每个链接爬取文章标题和内容。
如果列表页存在下一页。再对下一页列表进行相同的操作，是不是很好理解了。
文章保存格式为txt文本，保存的路径根据博客名来命名，保存的文件名称为文章标题，文本则保存文章内容。
有这个demo是不是可以写出文章搜索器啊，文章过滤器...甚至爬取整个csdnblog的所有文章都不是问题。就看你方法和过滤怎么做了。
大家可以设置blogName去爬你想要的文章了，比如说我：guoxiaolongonly
这边用post模拟浏览器请求。因为直接get，页面无法加载。
针对文本保存文档编码乱码问题。还希望大家自己研究一下。
好运~~ 晚安~
</code></pre><p><strong><em>By Xiaolong：You have a dream,you got to protect it! </em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reptile/">Reptile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Reptile1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/06/Reptile1/" class="article-date">
  	<time datetime="2016-05-06T14:53:53.000Z" itemprop="datePublished">2016-05-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/06/Reptile1/">java爬虫教程：JSOUP</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>爬虫教程第一篇，认识强大的java包JSOUP。<br>接下来我来介绍一下Java爬虫，(ˉ﹃ˉ)我大Java依然这么强大，谁还敢鄙视我大Java~</p>
<p>嗯哼，刚刚说Java强大，其实Java强大在它的第三方库。每一个jar包都是某个Java开发者的劳动成果，当然每一个Java开发者都应该自豪，因为正是我们的付出让Java日益强大。接下来要讲的是一个非常强大的工具包<a href="http://www.huqiwen.com/2012/05/03/use-jsoup-analytics-html-document/#" target="_blank" rel="external">JSOUP</a>，java爬虫实现基本依赖于它！</p>
<h3 id="一、Jsoup简介"><a href="#一、Jsoup简介" class="headerlink" title="一、Jsoup简介"></a>一、Jsoup简介</h3><p>在以往用java来处理解析HTML文档或者片段时，我们通常会采用<a href="http://htmlparser.sourceforge.net" target="_blank" rel="external">htmlparser</a>这个开源类库。现在我们有了JSOUP，以后的处理HTML的内容只需要使用JSOUP就已经足够了，JSOUP有更快的更新，更方便的API等。<br>jsoup 是一款 Java 的HTML 解析器，可直接解析某个URL地址、HTML文本内容。它提供了一套非常省力的API，可通过DOM，CSS以及类似于jQuery的操作方法来取出和操作数据，可以看作是java版的jQuery。<br>jsoup的主要功能如下：<br>从一个URL，文件或字符串中解析HTML；<br>使用DOM或CSS选择器来查找、取出数据；<br>可操作HTML元素、属性、文本；<br>jsoup是基于MIT协议发布的，可放心使用于商业项目。官方网站：<a href="http://jsoup.org/" target="_blank" rel="external">http://jsoup.org/</a></p>
<h3 id="二、解析遍历HTML文档"><a href="#二、解析遍历HTML文档" class="headerlink" title="二、解析遍历HTML文档"></a>二、解析遍历HTML文档</h3><p>Jsoup处理HTML文件是，是将用户输入的HTML文档，解析转换成一个Document对象进行处理。Jsoup一般支持以下几种来源内容的转换。</p>
<pre><code>1. 解析一个html字符串
2. 解析一个body片段
3. 根据一个url地址加载Document对象
4. 根据一个文件加载Document对象
</code></pre><h4 id="1-解析一个html字符串"><a href="#1-解析一个html字符串" class="headerlink" title="1.解析一个html字符串"></a>1.解析一个html字符串</h4><p>在处理一个html字符串。我们可能需要对其进行解析，并提取其内容，或校验其格式是否完整，或者想修改它。Jsoup可以帮助我们轻松的解决这些问题。<br>在Jsoup中有一个这样的静态方法Jsoup.parse(String html)，可以将我们的html片段转换成Document对象。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;div&gt;&lt;p align=\"center\"&gt;&lt;img alt=\"\" width=\"660\" height=\"852\" src=\"/erp/UserFiles/Image/51.jpg\" /&gt;这是P元素的内容&lt;/p&gt;"</span>;</div><div class="line">Document document = Jsoup.parse(html);</div></pre></td></tr></table></figure></p>
<p>使用上面的方法，就可以将html字符串，转换成Document对象，一旦有了Document对象，我们就可以使用其中适当的方法根据需求处理问题。我们可以看到这里转换的html片段并不是一个合法的html片段，里面的div标签没有闭合。这对于Jsoup来说不是问题，它可以很好的处理这类问题。</p>
<h4 id="2-解析body片段"><a href="#2-解析body片段" class="headerlink" title="2.解析body片段"></a>2.解析body片段</h4><p>假如我们现在有一个HTML片断 (比如. 一个 div 包含一对 p 标签; 一个不完整的HTML文档) 想对它进行解析。这个HTML片断可以是用户提交的一条评论或在一个CMS页面中编辑body部分。我们可以使用使用<a href="https://jsoup.org/apidocs/org/jsoup/Jsoup.html#parseBodyFragment(java.lang.String" target="_blank" rel="external">Jsoup.parseBodyFragment(String html)</a> 方法。<br>示例如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;div&gt;&lt;p align=\"center\"&gt;&lt;img alt=\"\" width=\"660\" height=\"852\" src=\"/erp/UserFiles/Image/51.jpg\" /&gt;这是P元素的内容&lt;/p&gt;"</span>;</div><div class="line">Document document = Jsoup.parseBodyFragment(html);</div></pre></td></tr></table></figure></p>
<p>看到这里可能会有疑问，这个和上面的html片段是一样的嘛。没错是一样的，parseBodyFragment 方法创建一个空壳的文档，并插入解析过的HTML到body元素中。假如使用正常的 Jsoup.parse(String html) 方法，通常也可以得到相同的结果，但是明确将用户输入作为 body片段处理，以确保用户所提供的任何糟糕的HTML都将被解析成body元素。</p>
<p><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Document.html#body(" target="_blank" rel="external">Document.body()</a> 方法能够取得文档body元素的所有子元素，与doc.getElementsByTag(“body”)相同。</p>
<h4 id="3-根据一个URL地址加载Document对象"><a href="#3-根据一个URL地址加载Document对象" class="headerlink" title="3.根据一个URL地址加载Document对象"></a>3.根据一个URL地址加载Document对象</h4><p>有时候我们可能希望通过一个url地址，然后提取里面的内容，转换成document对象。我们以前可能是使用http client等模拟一个请求，然后取得返回内容等，使用Jsoup方便简单的解决这个问题。示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Document document = Jsoup.connect(<span class="string">"http://www.baidu.com"</span>).get();</div><div class="line">String title = document.title();</div><div class="line">String text = document.text();</div></pre></td></tr></table></figure>
<p><a href="https://jsoup.org/apidocs/org/jsoup/Jsoup.html#connect(java.lang.String" target="_blank" rel="external">connect(String url)</a> 方法创建一个新的 <a href="https://jsoup.org/apidocs/org/jsoup/Connection.html" target="_blank" rel="external">Connection</a>, 和 <a href="https://jsoup.org/apidocs/org/jsoup/helper/HttpConnection.html#get(" target="_blank" rel="external">get()</a> 取得和解析一个HTML文件。如果从该URL获取HTML时发生错误，便会抛出 IOException，应适当处理。<br>Connection 接口还提供一个方法链来解决特殊请求，具体如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.connect(<span class="string">"http://test.com"</span>).data(<span class="string">"query"</span>, <span class="string">"Java"</span>).userAgent(<span class="string">"Mozilla"</span>).cookie(<span class="string">"auth"</span>, <span class="string">"token"</span>).timeout(<span class="number">3000</span>).post();</div></pre></td></tr></table></figure>
<p>可以向链接地址post参数，设置userAgent，cookie，timeout等，而且这里是采用的链接操作很方便（熟悉jQuery的应该很熟悉这样的链接操作）。</p>
<h4 id="4-根据文件加载document"><a href="#4-根据文件加载document" class="headerlink" title="4.根据文件加载document"></a>4.根据文件加载document</h4><p>有时候我们要处理的html内容，可能是存在硬盘上的某个文件里面，我们需要从中提取或者解析某些内容出来，我们可以通过Jsoup来这样处理。示例代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">File input = <span class="keyword">new</span> File(<span class="string">"d:/input.html"</span>);</div><div class="line">Document doc = Jsoup.parse(input, <span class="string">"UTF-8"</span>, <span class="string">"http://test.com/"</span>);</div></pre></td></tr></table></figure>
<p>看到这里可能有一个疑问，第一个参数是文件，第二是编码，第三个是什么呢?第三个参数是baseUrl，使用他我们可以方便的处理相对路径问题，如果不需要可以不传，这是一个多态方法，在前面的三个部分里面，都可以再加一个这样的baseUrl，后面会详细讲述。</p>
<h3 id="三、-数据抽取"><a href="#三、-数据抽取" class="headerlink" title="三、 数据抽取"></a>三、 数据抽取</h3><h4 id="1-使用Dom方法遍历文档"><a href="#1-使用Dom方法遍历文档" class="headerlink" title="1.使用Dom方法遍历文档"></a>1.使用Dom方法遍历文档</h4><p>通过第二章我们可以获取一个document的对象，我们可以通过这个对象来遍历文档，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.parse(input, <span class="string">"UTF-8"</span>, <span class="string">"http://test.com/"</span>);</div><div class="line">Element content = doc.getElementById(<span class="string">"content"</span>);</div><div class="line">Elements links = content.getElementsByTag(<span class="string">"a"</span>);</div><div class="line"><span class="keyword">for</span>(Element link : links) &#123;</div><div class="line">String linkHref = link.attr(<span class="string">"href"</span>);</div><div class="line">String linkText = link.text();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里我们可以方便的使用Doument对象的方法来获取内容。常用方法如下：</p>
<h5 id="查找元素"><a href="#查找元素" class="headerlink" title="查找元素"></a>查找元素</h5><ul>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementById(java.lang.String" target="_blank" rel="external">getElementById(String id)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByTag(java.lang.String" target="_blank" rel="external">getElementsByTag(String tag)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByClass(java.lang.String" target="_blank" rel="external">getElementsByClass(String className)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByAttribute(java.lang.String" target="_blank" rel="external">getElementsByAttribute(String key)</a>(and related methods)</li>
<li>Element siblings: <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#siblingElements(" target="_blank" rel="external">siblingElements()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#firstElementSibling(" target="_blank" rel="external">firstElementSibling()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#lastElementSibling(" target="_blank" rel="external">lastElementSibling()</a>;<a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#nextElementSibling(" target="_blank" rel="external">nextElementSibling()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#previousElementSibling(" target="_blank" rel="external">previousElementSibling()</a></li>
<li>Graph: <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Node.html#parent(" target="_blank" rel="external">parent()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Node.html#children(" target="_blank" rel="external">children()</a>), <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#child(int" target="_blank" rel="external">child(int index)</a></li>
</ul>
<h5 id="元素数据"><a href="#元素数据" class="headerlink" title="元素数据"></a>元素数据</h5><ul>
<li><a href="https://jsoup.org/apidocs/org/jsoup/select/Elements.html#attr(java.lang.String" target="_blank" rel="external">attr(String key)</a>获取属性<a href="https://jsoup.org/apidocs/org/jsoup/select/Elements.html#attr(java.lang.String, java.lang.String" target="_blank" rel="external">attr(String key, String value)</a>设置属性</li>
<li>attributes()获取所有属性</li>
<li>id(), className() and classNames()</li>
<li>text()获取文本内容text(String value) 设置文本内容</li>
<li>html()获取元素内HTMLhtml(String value)设置元素内的HTML内容</li>
<li>outerHtml()获取元素外HTML内容</li>
<li>data()获取数据内容（例如：script和style标签)</li>
<li>tag() and tagName()</li>
</ul>
<h5 id="操作HTML和文本"><a href="#操作HTML和文本" class="headerlink" title="操作HTML和文本"></a>操作HTML和文本</h5><ul>
<li>append(String html), prepend(String html)</li>
<li>appendText(String text), prependText(String text)</li>
<li>appendElement(String tagName), prependElement(String tagName)</li>
<li>html(String value)</li>
</ul>
<h4 id="2-使用选择器来查找元素"><a href="#2-使用选择器来查找元素" class="headerlink" title="2.使用选择器来查找元素"></a>2.使用选择器来查找元素</h4><p>使用jQuery时，我们无不为其强大的选择器叹服，jsoup有同样的强大的选择器，可以方便我们的对文档进行处理。示例代码如下：<br>jsoup elements对象支持类似于CSS (或jquery)的选择器语法，来实现非常强大和灵活的查找功能。.<br>这个select 方法在Document, Element,或Elements对象中都可以使用。且是上下文相关的，因此可实现指定元素的过滤，或者链式选择访问。<br>Select方法将返回一个Elements集合，并提供一组方法来抽取和处理结果。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Elements links = doc.select(<span class="string">"a[href]"</span>); <span class="comment">//带有&lt;span style="text-decoration: underline;"&gt;href&lt;/span&gt;属性的a元素</span></div><div class="line">Elements pngs = doc.select(<span class="string">"img[src$=.png]"</span>);</div><div class="line"><span class="comment">//扩展名为.&lt;span style="text-decoration: underline;"&gt;png&lt;/span&gt;的图片</span></div><div class="line">Element masthead = doc.select(<span class="string">"div.masthead"</span>).first();</div><div class="line"><span class="comment">//class等于&lt;span style="text-decoration: underline;"&gt;masthead&lt;/span&gt;的&lt;span style="text-decoration: underline;"&gt;div&lt;/span&gt;标签</span></div><div class="line">Elements resultLinks = doc.select(<span class="string">"h3.r &gt; a"</span>); <span class="comment">//在h3元素之后的a元素</span></div></pre></td></tr></table></figure></p>
<p>jsoup elements对象支持类似于CSS (或jquery)的选择器语法，来实现非常强大和灵活的查找功能。.<br>这个select 方法在Document, Element,或Elements对象中都可以使用。且是上下文相关的，因此可实现指定元素的过滤，或者链式选择访问。<br>Select方法将返回一个Elements集合，并提供一组方法来抽取和处理结果。</p>
<h4 id="3-从元素中抽取属性和文档"><a href="#3-从元素中抽取属性和文档" class="headerlink" title="3.从元素中抽取属性和文档"></a>3.从元素中抽取属性和文档</h4><ul>
<li>使用Jsoup抽取属性，一般方法如下：</li>
<li>要取得一个属性的值，可以使用Node.attr(String key) 方法</li>
<li>对于一个元素中的文本，可以使用Element.text()方法</li>
<li>对于要取得元素或属性中的HTML内容，可以使用Element.html(), 或 Node.outerHtml()方法<br>示例如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;p&gt;An &lt;a href='http://example.com/'&gt;&lt;b&gt;example&lt;/b&gt;&lt;/a&gt; link.&lt;/p&gt;"</span>;</div><div class="line">Document doc = Jsoup.parse(html);<span class="comment">//解析HTML字符串返回一个Document实现</span></div><div class="line">Element link = doc.select(<span class="string">"a"</span>).first();<span class="comment">//查找第一个a元素&lt;/pre&gt;</span></div><div class="line">String text = doc.body().text(); <span class="comment">// "An example link"//取得字符串中的文本</span></div><div class="line">String linkHref = link.attr(<span class="string">"href"</span>); <span class="comment">// "http://example.com/"//取得链接地址</span></div><div class="line">String linkText = link.text(); <span class="comment">// "example""//取得链接地址中的文本&lt;/pre&gt;</span></div><div class="line">String linkOuterH = link.outerHtml();</div><div class="line"><span class="comment">// "&lt;a href="http://example.com"&gt;&lt;b&gt;example&lt;/b&gt;&lt;/a&gt;"</span></div><div class="line">String linkInnerH = link.html(); <span class="comment">// "&lt;b&gt;example&lt;/b&gt;"//取得链接内的html内容</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-URL处理"><a href="#4-URL处理" class="headerlink" title="4.URL处理"></a>4.URL处理</h4><p>我们在处理HTML内容时，可能经常会遇到这种问题，需要将html页面里面的链接地址从相对地址转换成绝对地址，jsoup有一个方法用来解决此问题。我们前面对到的baseurl，就是用来解决此问题的。示例代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.connect(<span class="string">"http://www.baidu.com/"</span>).get();</div><div class="line">Element link = doc.select(<span class="string">"a"</span>).first();</div><div class="line">String relHref = link.attr(<span class="string">"href"</span>); <span class="comment">// == "/"</span></div><div class="line">String absHref = link.attr(<span class="string">"abs:href"</span>);</div><div class="line"><span class="comment">// "http://www.baidu.com/gaoji/preferences.html"</span></div></pre></td></tr></table></figure></p>
<p>在HTML元素中，URLs经常写成相对于文档位置的相对路径： <a href="/download">…</a>. 当你使用 Node.attr(String key) 方法来取得a元素的href属性时，它将直接返回在HTML源码中指定定的值。<br>假如你需要取得一个绝对路径，需要在属性名前加 abs: 前缀。这样就可以返回包含根路径的URL地址attr(“abs:href”)<br>因此，在解析HTML文档时，定义base URI非常重要。如果你不想使用abs: 前缀，还有一个方法能够实现同样的功能 Node.absUrl(String key)。</p>
<h3 id="数据修改"><a href="#数据修改" class="headerlink" title="数据修改"></a>数据修改</h3><h4 id="1-设置属性值"><a href="#1-设置属性值" class="headerlink" title="1.设置属性值"></a>1.设置属性值</h4><p>在处理html时，我们有时候可能需要修改里面的属性值，如图片地址、class名称等各种属性。<br>可以使用属性设置方法 Element.attr(String key, String value), 和 Elements.attr(String key, String value).<br>假如你需要修改一个元素的 class 属性，可以使用 Element.addClass(String className) 和Element.removeClass(String className) 方法。<br>Elements 提供了批量操作元素属性和class的方法，比如：要为div中的每一个a元素都添加一个rel=”nofollow”<br>可以使用如下方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doc.select(<span class="string">"div.comments a"</span>).attr(<span class="string">"rel"</span>, <span class="string">"nofollow"</span>);</div></pre></td></tr></table></figure></p>
<p>这里的jsoup方法同样支持链接操作，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doc.select(<span class="string">"div.masthead"</span>).attr(<span class="string">"title"</span>, <span class="string">"jsoup"</span>).addClass(<span class="string">"round-box"</span>);</div></pre></td></tr></table></figure></p>
<h4 id="2-设置元素的html内容"><a href="#2-设置元素的html内容" class="headerlink" title="2.设置元素的html内容"></a>2.设置元素的html内容</h4><p>我们需要向html里面添加html片段等内容时可以如下操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Element div = doc.select(<span class="string">"div"</span>).first(); <span class="comment">// &lt;div&gt;&lt;/div&gt;</span></div><div class="line">div.html(<span class="string">"&lt;p&gt;lorem ipsum&lt;/p&gt;"</span>); <span class="comment">// &lt;div&gt;&lt;p&gt;lorem ipsum&lt;/p&gt;&lt;/div&gt;</span></div><div class="line">div.prepend(<span class="string">"&lt;p&gt;First&lt;/p&gt;"</span>);<span class="comment">//在div前添加html内容</span></div><div class="line">div.append(<span class="string">"&lt;p&gt;Last&lt;/p&gt;"</span>);<span class="comment">//在div之后添加html内容</span></div><div class="line"><span class="comment">// 添完后的结果: &lt;div&gt;&lt;p&gt;First&lt;/p&gt;&lt;p&gt;lorem ipsum&lt;/p&gt;&lt;p&gt;Last&lt;/p&gt;&lt;/div&gt;</span></div><div class="line">Element span = doc.select(<span class="string">"span"</span>).first(); <span class="comment">// &lt;span&gt;One&lt;/span&gt;</span></div><div class="line">span.wrap(<span class="string">"&lt;li&gt;&lt;a href='http://example.com/'&gt;&lt;/a&gt;&lt;/li&gt;"</span>);</div><div class="line"><span class="comment">//对元素包裹一个外部HTML内容添完后的结果:</span></div><div class="line"><span class="comment">//&lt;li&gt;&lt;a href="http://example.com"&gt;&lt;span&gt;One&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span></div></pre></td></tr></table></figure></p>
<h4 id="3-设置元素的文本内容"><a href="#3-设置元素的文本内容" class="headerlink" title="3.设置元素的文本内容"></a>3.设置元素的文本内容</h4><p>如果我们需要修改元素内的文本内容，可以如下操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Element div = doc.select(<span class="string">"div"</span>).first(); <span class="comment">// &lt;div&gt;&lt;/div&gt;</span></div><div class="line">div.text(<span class="string">"five &gt; four"</span>); <span class="comment">// &lt;div&gt;five &amp;gt; four&lt;/div&gt;</span></div><div class="line">div.prepend(<span class="string">"First "</span>);</div><div class="line">div.append(<span class="string">" Last"</span>);</div><div class="line"><span class="comment">// now: &lt;div&gt;First five &amp;gt; four Last&lt;/div&gt;</span></div></pre></td></tr></table></figure></p>
<h6 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h6><p>文本设置方法与 HTML setter 方法一样：<br>Element.text(String text) 将清除一个元素中的内部HTML内容，然后提供的文本进行代替<br>Element.prepend(String first) 和 Element.append(String last) 将分别在元素的内部html前后添加文本节点。<br>对于传入的文本如果含有像 &lt;, &gt; 等这样的字符，将以文本处理，而非HTML。</p>
<p><strong><em>By Xiaolong：You have a dream,you got to protect it!</em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JSOUP/">JSOUP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Welcome" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/07/Welcome/" class="article-date">
  	<time datetime="2016-03-07T01:53:03.000Z" itemprop="datePublished">2016-03-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/07/Welcome/">Welcome To My Personal Blog</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="说说感想"><a href="#说说感想" class="headerlink" title="说说感想"></a>说说感想</h2><pre><code>经过几个小时的努力，我的个人博客终于架设完了。之前一直想要有一个个人博客，可以把自己学习的资源，自己的体会分享出来。现在终于可以实现啦~~&lt;(￣︶￣)&gt;

虽然现在很多平台类似于CSDN、博客园、甚至新浪博客，都已经很普遍了，而我更期待的是有一个个人管理的博客站点，这才是最好玩的一件事情。&lt;(‵□′)/~

之前学过java想直接用javaee写一个自己的站点，但是需要涉及的技术太多，还需要云服务器来存放服务器后台文件。过程特别繁琐~~嗯，特别麻烦~~反正我是懒得再自己去写框架找界面样式来搭建我的博客(ˉ﹃ˉ)~~

现在感谢github和hexo让我有这样的机会，将博客绑定域名，实现真正意义上的绝对权限的本地管理~
</code></pre><h2 id="讲一下原理"><a href="#讲一下原理" class="headerlink" title="讲一下原理"></a>讲一下原理</h2><pre><code>这个模式类似于GitHub 提供服务器和空间。用git 配合Hexo来管理本地文档。然后通过域名解析把自己买的域名指向，gitHub提供的的ip。再由gitHub来转换该域名对应访问的站点。

优点就是：不用自己购买服务器，架设服务器。不用自己写博客后端框架，更不用写前端样式啦，都是可以直接拿模版来操作的(￣︶￣)↗ 哈哈哈哈~~。

有兴趣的小伙伴赶紧学起来~
</code></pre><p>学架设：<a href="http://blog.csdn.net/chen825919148/article/details/40508467" target="_blank" rel="external">点击这里</a></p>
<h2 id="小Tips"><a href="#小Tips" class="headerlink" title="小Tips"></a>小Tips</h2><p>如果你是一名学生开发者，推荐你看看这个：<a href="http://www.qcloud.com/event/qcloudSchool" target="_blank" rel="external">腾讯云云加校园计划</a></p>
<p>你将会获得一个免费的域名，和一个一块钱/月的云服务器。可以去做好多好玩的事情啦。</p>
<p><strong><em>By Xiaolong</em></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/感想/">感想</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 小龙
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>