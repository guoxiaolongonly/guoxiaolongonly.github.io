<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Xiaolong, lucky" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="程序猿">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiaolong的个人博客">
<meta property="og:url" content="http://rngift.com/index.html">
<meta property="og:site_name" content="Xiaolong的个人博客">
<meta property="og:description" content="程序猿">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xiaolong的个人博客">
<meta name="twitter:description" content="程序猿">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rngift.com/"/>





  <title> Xiaolong的个人博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Xiaolong的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">每一天都值得被认真对待</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/pastLove" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            爱过的人
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2018/03/13/AnnualSummary 2017/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/13/AnnualSummary 2017/" itemprop="url">
                  2017年总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-13T15:19:37+08:00">
                2018-03-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/阶段性总结/" itemprop="url" rel="index">
                    <span itemprop="name">阶段性总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="闲谈"><a href="#闲谈" class="headerlink" title="闲谈"></a>闲谈</h3><p>有些时候真的不得不佩服有一些人真的是牛逼，跟我同事对比才发现人家看了编程思想是真的读懂了，我看了编程思想是看了一遍。最近问了他一些问题感觉他都能对答如流，想各种解决方案，不禁感觉自己任重道远。诶，学无止境！！</p>
<h3 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h3><p>这边其实更多的是对去年的反思吧，感觉很多时候基本都是要打脸之后才能明白自己所处的位置。在经过了一轮简历的投递和内推之后发现自己并没有特别多的优势，基本上全军覆没了，连面试机会都没有，这里分析一下问题根本原因，现在Andrid开发真的是烂大街，作为一个两年工作经验的，想找一份好的工作真的很难。</p>
<ol>
<li>大厂基本都直接校招，社招的要求基本很严格。</li>
<li>小公司大部分技术不成熟，很多时候一个人要做很多的活，接触的面虽然广，但是不精，这个其实就跟做重复工作没什么区别了。</li>
<li>个人上跳槽频繁，让HR觉得稳定性不高。</li>
<li>技术并不是过硬，虽有博客github，并没有多大优势。</li>
</ol>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ol>
<li>了解一线大厂需求，充实简历</li>
<li>小公司尽量避免不去了。</li>
<li>找一家的公司稳定待个几年。</li>
<li>技术充实，每个月一篇博客，每天坚持github push开源</li>
<li>打好扎实的java基础，多线程编程，网络编程思想</li>
</ol>
<p>以上！！</p>
<p><strong><em>By xiaolong：You have a dream,you got to protect it!</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2018/02/09/TravelFrog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/09/TravelFrog/" itemprop="url">
                  写一个旅行青蛙攻略APP
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-09T09:11:09+08:00">
                2018-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/个人开源/" itemprop="url" rel="index">
                    <span itemprop="name">个人开源</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="界面效果如下"><a href="#界面效果如下" class="headerlink" title="界面效果如下"></a>界面效果如下</h1><p><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/launcher.png" alt="启动页"><br><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/main.png" alt="首页"><br><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/animal.png" alt="小伙伴"><br><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/collect.png" alt="收藏"><br><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/specialy.png" alt="特产"><br><img src="https://raw.githubusercontent.com/guoxiaolongonly/TravelGuaGuide/master/screen/name.png" alt="称号"></p>
<pre><code>不要忘了我们的所有数据和界面都可以在github的json文件里面配置有需要的小伙伴自行拿去用吧!!
</code></pre><p><a href="https://github.com/guoxiaolongonly/TravelGuaGuide" target="_blank" rel="external">项目github地址</a><br><a href="https://fir.im/qwgl" target="_blank" rel="external">Apk下载地址</a></p>
<h1 id="设计意图"><a href="#设计意图" class="headerlink" title="设计意图"></a>设计意图</h1><p>最近旅行青蛙很火，我自己也在玩，然后发现一个痛点是每次找小动物喜欢吃什么，每个道具的用途，都需要打开浏览器搜索。实在不能忍，感觉很痛，于是决心自己写一个APP攻略！！</p>
<h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>1.需要先对界面上的每个功能放一张图解，还有基本玩法操作！！</p>
<p>2.针对出现的每个道具的名称和用途做一个分类查看器，描述名称，用途等… 比如说商城道具和带回来的特产，收藏品，抽奖的奖品等…</p>
<p>3.如果单机版其实就这么考虑。后面觉得应该做一个动态数据的功能。（因为如果游戏有新版本更新了APP也得更新新版本，所以我想给APP一个接口，用来传输每次更新的数据。这样我们就不用每次发一个版本了。 very nice!!）</p>
<p>4.既然需要提供接口，就需要一个服务器了。这边其实是有多种考虑。</p>
<ul>
<li>bomb后端云，这种免费后端数据库可以一键式增删改查，这个可是上上之选。</li>
<li>写个页面，导入jsoup，动态爬数据，技术帝的不二选择，不过网页经常变感觉还是很蛋疼的。</li>
<li>哈哈哈哈哈哈，因为我比较懒，不想再去看文档，所以在github上面写了一个json文件，发现文件在github上的页面结构好像跟平时json请求的一样，试着做了一下请求。发现鸡然可以，那就用github来维护吧，反正博客都github上搭过了)</li>
</ul>
<h1 id="产品规划"><a href="#产品规划" class="headerlink" title="产品规划"></a>产品规划</h1><pre><code>coding之前的一些其他细节，首现是需要什么样的页面，怎样才能长得好看。噗，自己写APP都要兼职PM.UI.UE。 心疼的抱住了自己。  
</code></pre><p>1.页面既定的规划就是提供一个首页，实现列表对每个模块做划分，</p>
<ul>
<li>入门操作，因为日版的APP很多东西还是看不懂的，做一个引导用户入门。</li>
<li>商店道具和作用介绍</li>
<li>收藏品介绍</li>
<li>特产介绍</li>
<li>称号介绍</li>
<li>小动物喜欢吃什么</li>
<li>进阶攻略 提供一些骨灰级玩家需要的信息。（比如收割草，给小动物喂食什么合适等等..）</li>
<li>更新数据</li>
</ul>
<ol>
<li>根据需求其实已经很明了了首页6个tab，<ul>
<li>入门和进阶</li>
<li>小动物介绍</li>
<li>商店道具介绍</li>
<li>特产介绍</li>
<li>称号介绍</li>
<li>收藏品介绍</li>
<li>另外配置一个侧拉的View用来展示作者介绍，和数据更新，2333，装逼用！！</li>
</ul>
</li>
</ol>
<h1 id="Then-coding"><a href="#Then-coding" class="headerlink" title="Then coding"></a>Then coding</h1><p>主要是考虑动态配置问题，不同数据分配不同页面</p>
<p>1.首页一个列表用来展示所有模块</p>
<p>2.模块下面可能有子模块，根据类别启动子模块的Activity。</p>
<p>3.功能，不同功能展示的页面效果也不一样。gridView</p>
<ul>
<li>小动物，中图，中文字描述，点击查看详情gridView</li>
<li>商店道具，中图，中文字描述，点击查看详情gridView</li>
<li>特产，小图，小文字描述，点击查看详情gridView</li>
<li>称号，中图，中文字描述，点击查看详情gridView</li>
<li>收藏品，中图，中文字描述，点击查看详情gridView</li>
<li>入门和进阶，子模块，实现做图右文字列表做选择gridView</li>
<li>详情页大图大文字listView 图片+文字每个段落</li>
<li>预留一个webActivity做web加载。 预留一个TextActivity做文本加载</li>
</ul>
<p>4.两种类型的模块选择页  ModularGridViewActivity,ModularListViewActivity.</p>
<p>5.三种详情查看页 BigPicDetailActivity,WebActivity,TextActivity</p>
<p>6.两种描述页 MiddleDecribeActivity,SmallDeScribeActivity</p>
<p>7.侧拉菜单</p>
<p>8.关于APP</p>
<p>最近太忙了，没时间写这个，今天花了一天时间把它全部做完了，功能设计什么的都不难，就是界面和一些交互体验，还有素材整理花了点时间。最终实现的结果可能跟之前预想的不太一样。</p>
<p>谈一谈不一样的地方<br>小动物，商店道具，特产，称号，收藏品，入门和进阶的页面，我写到了一个页面中。<br>原本预想其实就是分成好几个Activity来写，但是后来想想写了那么多Activity其实参数都一样，逻辑也都一样，就是页面的布局不一样而已。<br>写那么多的Activity其实可以写成一个Activity，然后Adapter做抽象，实现不同的 Adapter来实现不同的列表。<br>后面又想了一下，Adapter其实也不用做什么操作，只有布局不一样，点击响应和数据传递都是一样的。就把布局直接传给了Adapter。由数据来确定初始化什么布局，和布局的样式。<br>最终实现就是这样，但是也看出了这样实现的一些弊端，就是不适合数据量大的场景。不过我们的数据量确实不大，就先这样了！！nice day!!</p>
<hr>
<p>就写到这里了。攻略也不想整理了！！！！  因为根本就找不到用户 2333！！</p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/12/29/BluetoothForAndroid5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/29/BluetoothForAndroid5/" itemprop="url">
                  蓝牙协议学习整理（四）蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-29T16:09:36+08:00">
                2017-12-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android蓝牙/" itemprop="url" rel="index">
                    <span itemprop="name">Android蓝牙</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第四章-蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）"><a href="#第四章-蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）" class="headerlink" title="第四章 蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）"></a>第四章 蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）</h2><h3 id="一、IrDA互操作协议"><a href="#一、IrDA互操作协议" class="headerlink" title="一、IrDA互操作协议"></a>一、IrDA互操作协议</h3><p>IrOBEX 红外对象交互协议，简称OBEX，使高层协议同时运作在蓝牙和红外的无线链路之上。</p>
<p><img src="http://img.blog.csdn.net/20171229155728786?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>主要操作指令有：连接操作、断开操作、Put操作、Get操作。</p>
<h4 id="1、连接操作-操作码0x80"><a href="#1、连接操作-操作码0x80" class="headerlink" title="1、连接操作 ,操作码0x80"></a>1、连接操作 ,操作码0x80</h4><table><br>   <tr><br>      <td>字节0</td><br>      <td>字节1、2</td><br>      <td>字节3</td><br>      <td>字节4</td><br>      <td>字节5、6</td><br>      <td>字节7～n</td><br>   </tr><br>   <tr><br>      <td>0x80</td><br>      <td>连接请求分组长度</td><br>      <td>OBEX版本号</td><br>      <td>标志</td><br>      <td>客户端可接收最大的OBEX分组长度</td><br>      <td>可选头</td><br>   </tr><br></table>

<p><img src="http://img.blog.csdn.net/20171229155842107?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<table><br>   <tr><br>      <td>字节0</td><br>      <td>字节1、2</td><br>      <td>字节3</td><br>      <td>字节4</td><br>      <td>字节5、6</td><br>      <td>字节7～n</td><br>   </tr><br>   <tr><br>      <td>0x80 Connect命令</td><br>      <td>7</td><br>      <td>0x10</td><br>      <td>标志</td><br>      <td>65534</td><br>      <td>可选头</td><br>   </tr><br></table>

<p><strong>连接响应</strong><br><img src="http://img.blog.csdn.net/20171229155929503?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<h4 id="2、断开操作"><a href="#2、断开操作" class="headerlink" title="2、断开操作"></a>2、断开操作</h4><p>操作码为0x81</p>
<h4 id="3、Put操作"><a href="#3、Put操作" class="headerlink" title="3、Put操作"></a>3、Put操作</h4><p>操作码为0x02</p>
<p>连接成功后，客户端通过Put请求向服务器“推送”对象，如果对象较大，Put请求可以用多个Put请求分组。</p>
<p><img src="http://img.blog.csdn.net/20171229160055997?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h4 id="4、Get操作"><a href="#4、Get操作" class="headerlink" title="4、Get操作"></a>4、Get操作</h4><p>操作码为0x03</p>
<h3 id="二、音频与电话控制协议"><a href="#二、音频与电话控制协议" class="headerlink" title="二、音频与电话控制协议"></a>二、音频与电话控制协议</h3><h4 id="1、框架部分"><a href="#1、框架部分" class="headerlink" title="1、框架部分"></a>1、框架部分</h4><p><img src="http://img.blog.csdn.net/20171229160153980?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>蓝牙音频如上图协议栈所示：音频通过基带传输同步面向连接分组实现，没有以规范的形式给出，不是协议栈的一部分。<br>    TCS_Binary是一种基于分组电话控制二进制编码指令集，位于L2CAP之上。实现蓝牙无绳电话、对讲机功能。<br>    RFCOMM用于AT指令，拨号上网、蓝牙耳机、耳麦、传真通过AT发送指令控制。</p>
<h4 id="2、音频部分"><a href="#2、音频部分" class="headerlink" title="2、音频部分"></a>2、音频部分</h4><p>   64kbps电信级语言质量音频流<br>    CVSD  continuous variable slope delta 连续可变斜率增量。<br>    PCM  pulse code modulation 。<br>    PCM存在斜率效应。CVSD使用音节压缩算法，编码步长根据信号斜率变化自动调整，是现在比较好的编码方案，提高语言的抗干扰能力。</p>
<h4 id="3、电话控制部分"><a href="#3、电话控制部分" class="headerlink" title="3、电话控制部分"></a>3、电话控制部分</h4><pre><code>TCS-Binary电话控制部分。
</code></pre><p>（1）、电话呼叫</p>
<pre><code>呼叫控制、呼叫建立、呼叫拆除；
</code></pre><p>（2）、组管理</p>
<pre><code>访问权限请求、分布式配置、快速内部成员访问。
</code></pre><h3 id="三、网络封装协议-BNEP"><a href="#三、网络封装协议-BNEP" class="headerlink" title="三、网络封装协议  BNEP"></a>三、网络封装协议  BNEP</h3><p>BNEP BluetoothNetworkEncapsulation Protocol 网络封装协议。<br>    为了使集成蓝牙技术的电脑、电话、PDA、家用电器等网络设备交换信息，需要在网络层统一数据分组。网络封装协议将来自不同网络的数据分组重新封装，通过L2CAP进行传输。这部分协议感觉在现实中用处不大，有更多简单便捷的方法去实现网络功能。<br>    BNEP支持Ipv4、Ipv6、IPX</p>
<p><img src="http://img.blog.csdn.net/20171229160349916?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="四、音视频分发协议AVDTP"><a href="#四、音视频分发协议AVDTP" class="headerlink" title="四、音视频分发协议AVDTP"></a>四、音视频分发协议AVDTP</h3><p>AVDTPAudio/Video Distribution Transport Protocol音视频分发传输协议</p>
<p><img src="http://img.blog.csdn.net/20171229160422944?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>有关A/V的协议 AVDTP音视频分发传输协议、AVCTP音视频控制传输协议、GAVDP通用音视频分发框架、A2DP高级音频分发框架、AVCRP音视频遥控框架</p>
<h4 id="1、基本概念术语"><a href="#1、基本概念术语" class="headerlink" title="1、基本概念术语"></a>1、基本概念术语</h4><p>流stream:流是音视频传输的数据形式，单向传输，在AVDTP中被分为媒介分组。流有句柄HS统一标识。</p>
<p><img src="http://img.blog.csdn.net/20171229160502080?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h4 id="2、信令"><a href="#2、信令" class="headerlink" title="2、信令"></a>2、信令</h4><p>AVDTP信令列表</p>
<table><br>   <tr><br>      <td>命令</td><br>      <td>信令标识符</td><br>      <td>描述</td><br>   </tr><br>   <tr><br>      <td>AVDTP_DISCOVER</td><br>      <td>0x01</td><br>      <td>发现设备中的流端点</td><br>   </tr><br>   <tr><br>      <td>AVDTP_GET_CAPABILITIES</td><br>      <td>0x02</td><br>      <td>获得流端点的信息能力</td><br>   </tr><br>   <tr><br>      <td>AVDTP_SET_CONFIGURATION</td><br>      <td>0x03</td><br>      <td>对SEP进行配置</td><br>   </tr><br>   <tr><br>      <td>AVDTP_GET_CONFIGURATION</td><br>      <td>0x04</td><br>      <td>获取SEP当前配置</td><br>   </tr><br>   <tr><br>      <td>AVDTP_RECONFIGURE</td><br>      <td>0x05</td><br>      <td>对SEP重新配置</td><br>   </tr><br>   <tr><br>      <td>AVDTP_OPEN</td><br>      <td>0x06</td><br>      <td>成功的配置SEP后，打开流</td><br>   </tr><br>   <tr><br>      <td>AVDTP_START</td><br>      <td>0x07</td><br>      <td>流被打开：用于开始形成流；流暂停时：用于重新形成流。</td><br>   </tr><br>   <tr><br>      <td>AVDTP_CLOSE</td><br>      <td>0x08</td><br>      <td>对SEP关闭</td><br>   </tr><br>   <tr><br>      <td>AVDTP_SUSPEND</td><br>      <td>0x09</td><br>      <td>请求SEP暂停</td><br>   </tr><br>   <tr><br>      <td>AVDTP_SECURITY_CONTROL</td><br>      <td>0x0A</td><br>      <td>设置设备内容保护、或者请求设备状况信息</td><br>   </tr><br>   <tr><br>      <td>AVDTP_ABORT</td><br>      <td>0x0B</td><br>      <td>中断正在建立或者传输的过程</td><br>   </tr><br>   <tr><br>      <td>AVDTP_GET_ALL_CAPABILITIES</td><br>      <td> </td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>AVDTP_DELAYREPORT</td><br>      <td> </td><br>      <td> </td><br>   </tr><br></table>

<pre><code>这部分信令，实现了蓝牙的A2DP 数据流的控制
</code></pre><p><strong>（1）、流的信令管理流程</strong></p>
<p><img src="http://img.blog.csdn.net/20171229160645996?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20171229160703608?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><strong>（2）、get capabilities  获取支持特性</strong></p>
<p><img src="http://img.blog.csdn.net/20171229160738415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><strong>（3）、set configuration 配置音频参数</strong></p>
<p><img src="http://img.blog.csdn.net/20171229160806185?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>其他指令类似去上面两个的操作。</p>
<h3 id="五、音视频控制传输协议AVCTP"><a href="#五、音视频控制传输协议AVCTP" class="headerlink" title="五、音视频控制传输协议AVCTP"></a>五、音视频控制传输协议AVCTP</h3><p><img src="http://img.blog.csdn.net/20171229160834464?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>AVCTP可以使音视频设备同时支持多个应用框架，每个应用框架定义了各自相应的消息格式与应用规则。</p>
<p>这部分操作，在现实的应用中也有不足的地方，蓝牙传输的数据量有限，实现这些功能有一定的不足。随着科学技术的发展，蓝牙在无线通信方面的优点、缺点都凸显出来，找的合适的方向，合理的发展方向是硬道理。</p>
<p>蓝牙芯片厂商：</p>
<p>CSR公司（Cambridge Silicon Radio）(目前最大的蓝牙芯片的全球供应商)</p>
<p>Broadcom公司</p>
<p>ISSC公司</p>
<p>TI公司 (CC2541)</p>
<p>MTK公司（MT6620）</p>
<p>传送门：<br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78414870" target="_blank" rel="external">（一）蓝牙的概述</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932321" target="_blank" rel="external">（二）蓝牙协议规范（射频、基带链路控制、链路管理）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932372" target="_blank" rel="external">（三）蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932616" target="_blank" rel="external">（四）蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）</a></p>
<p><a href="http://blog.csdn.net/xubin341719" target="_blank" rel="external">引用自xubin的博客</a></p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/12/29/BluetoothForAndroid4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/29/BluetoothForAndroid4/" itemprop="url">
                  蓝牙协议学习整理（三）蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-29T15:53:27+08:00">
                2017-12-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android蓝牙/" itemprop="url" rel="index">
                    <span itemprop="name">Android蓝牙</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第三章-蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）"><a href="#第三章-蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）" class="headerlink" title="第三章 蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）"></a>第三章 蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）</h2><h3 id="一、主机控制接口协议-HCI"><a href="#一、主机控制接口协议-HCI" class="headerlink" title="一、主机控制接口协议  HCI"></a>一、主机控制接口协议  HCI</h3><p>蓝牙主机-主机控模型<br><img src="http://img.blog.csdn.net/20171229144618138?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>蓝牙软件协议栈堆的数据传输过程：<br><img src="http://img.blog.csdn.net/20171229144652458?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="1、蓝牙控制器接口数据分组："><a href="#1、蓝牙控制器接口数据分组：" class="headerlink" title="1、蓝牙控制器接口数据分组："></a>1、蓝牙控制器接口数据分组：</h3><p>指令分组、事件分组、数据分组</p>
<p><strong>（1）、指令分组</strong><br><img src="http://img.blog.csdn.net/20171229144809764?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20171229144827809?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>如：Accpet Connection Request</p>
<ul>
<li>Opcode为：0x0409</li>
<li>参数长度为: 07 </li>
<li>参数中蓝牙地址为：00:0d:fd:5f:16:9f    </li>
<li>角色为：从设备  0x01</li>
</ul>
<p>大端数据模式</p>
<ul>
<li>指令为：09 04 07 9f 16 5f fd 0d 00 01</li>
</ul>
<p><strong>（2）、事件分组</strong><br><img src="http://img.blog.csdn.net/20171229144950189?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20171229145133698?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>如上图：</p>
<ul>
<li>Opcode :0x0409</li>
<li>状态： 0x00</li>
<li>总长度： 4字节</li>
<li>命令状态：0x0f</li>
</ul>
<p><strong>（3）、数据分组</strong><br>ACL 数据分组</p>
<table><br>   <tr><br>      <td>连接句柄（12bit）</td><br>      <td>PB(2bit)</td><br>      <td>BC(2bit)</td><br>      <td>数据长度（16bit）</td><br>   </tr><br>   <tr><br>      <td colspan="4">数据…………</td><br>   </tr><br></table>

<pre><code>注：PB  Packet_Boundary  BC Broadcast Flag
</code></pre><p>SCO 数据分组</p>
<table><br>   <tr><br>      <td>连接句柄（12bit）</td><br>      <td>PB(2bit)</td><br>      <td>BC(2bit)</td><br>      <td>数据长度（16bit）</td><br>   </tr><br>   <tr><br>      <td colspan="4">数据…………</td><br>   </tr><br></table>

<p><strong>（4）、RS232分组指示器:</strong></p>
<table><br>   <tr><br>      <td>HCI 分组类型</td><br>      <td>RS232分组指示器</td><br>   </tr><br>   <tr><br>      <td>HCI指令分组</td><br>      <td>0x01</td><br>   </tr><br>   <tr><br>      <td>HCI ACL数据分组</td><br>      <td>0x02</td><br>   </tr><br>   <tr><br>      <td>HCI SCO数据分组</td><br>      <td>0x03</td><br>   </tr><br>   <tr><br>      <td>HCI事件分组</td><br>      <td>0x04</td><br>   </tr><br>   <tr><br>      <td>HCI错误消息分组</td><br>      <td>0x05</td><br>   </tr><br>   <tr><br>      <td>HCI协商分组</td><br>      <td>0x06</td><br>   </tr><br></table>

<h4 id="2、HCI控制命令"><a href="#2、HCI控制命令" class="headerlink" title="2、HCI控制命令"></a>2、HCI控制命令</h4><p><strong>（1）、链路控制指令</strong></p>
<table><br>   <tr><br>      <td>命令</td><br>      <td>OCF</td><br>      <td>概述</td><br>   </tr><br>   <tr><br>      <td>Inquiry</td><br>      <td>0x0001</td><br>      <td>蓝牙设备进入查询模式，搜索临近设备</td><br>   </tr><br>   <tr><br>      <td>Inquiry Cancel</td><br>      <td>0x0002</td><br>      <td>退出查询模式</td><br>   </tr><br>   <tr><br>      <td>Periodic Inquiry Mode</td><br>      <td>0x0003</td><br>      <td>蓝牙设备在指定周期内自动查询</td><br>   </tr><br>   <tr><br>      <td>Exit Periodic Inquiry Mode</td><br>      <td>0x0004</td><br>      <td>退出自动查询模式</td><br>   </tr><br>   <tr><br>      <td>Create Connection</td><br>      <td>0x0005</td><br>      <td>按指定蓝牙设备的BD_ADDR创建ACL链路</td><br>   </tr><br>   <tr><br>      <td>Disconnect</td><br>      <td>0x0006</td><br>      <td>终止现有连接</td><br>   </tr><br>   <tr><br>      <td>Add SCO Connection</td><br>      <td>0x0007</td><br>      <td>利用连接句柄参数指定的ACL连接创建SCO</td><br>   </tr><br>   <tr><br>      <td>Cancel Create Connection</td><br>      <td>0x0008</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Accept Connection Request</td><br>      <td>0x0009</td><br>      <td>接收新的呼入连接请求</td><br>   </tr><br>   <tr><br>      <td>Reject Connection Request</td><br>      <td>0x000A</td><br>      <td>拒绝新的呼入连接请求</td><br>   </tr><br>   <tr><br>      <td>Link Key Request Reply</td><br>      <td>0x000B</td><br>      <td>应答从主机控制器发出的链路密钥请求事件，并指定存储在主机上的链路密钥做为与BD_ADDR指定的蓝牙设备进行连接使用的链路密钥请求事件</td><br>   </tr><br>   <tr><br>      <td>Link Key Request Negative Reply</td><br>      <td>0x000C</td><br>      <td>如果主机上没有存储链路密钥，作为与BD_ADDR指定的蓝牙设备进行连接使用的链路密钥，就应答从主机控制器发出的链路密钥请求事件</td><br>   </tr><br>   <tr><br>      <td>PIN Code Request Reply</td><br>      <td>0x000D</td><br>      <td>应答从主机控制器发出的PIN请求事件，并指定用于连接的PIN</td><br>   </tr><br>   <tr><br>      <td>PIN Code Request Negative Reply</td><br>      <td>0x000E</td><br>      <td>当主机不能指定连接的PIN时，应回答从机控制器发出的PIN请求事件</td><br>   </tr><br>   <tr><br>      <td>Change Connection Packet Type</td><br>      <td>0x000F</td><br>      <td>改变正在建立连接的分组类型</td><br>   </tr><br>   <tr><br>      <td>Authentication Request</td><br>      <td>0x0011</td><br>      <td>指定连接句柄关联的两个蓝牙设备之间建立身份鉴权</td><br>   </tr><br>   <tr><br>      <td>Set Connection Encryption</td><br>      <td>0x0013</td><br>      <td>建立取消连接加密</td><br>   </tr><br>   <tr><br>      <td>Change Connection Link Key</td><br>      <td>0x0015</td><br>      <td>强制关联了连接句柄的两个设备建立连接，并生成一个新的链路密钥</td><br>   </tr><br>   <tr><br>      <td>Master Link Key</td><br>      <td>0x0017</td><br>      <td>强制关联了连接句柄的两个设备利用主设备时链路密钥或常规密钥</td><br>   </tr><br>   <tr><br>      <td>Remote Name Request</td><br>      <td>0x0019</td><br>      <td>获取远端设备的名称</td><br>   </tr><br>   <tr><br>      <td>Cancel Remote Name Request</td><br>      <td> </td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Read Remote Supported Features</td><br>      <td>0x001B</td><br>      <td>请求远端设备所支持的特性列表</td><br>   </tr><br>   <tr><br>      <td>Read Remote Extended Features</td><br>      <td> </td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Read Remote Version Information</td><br>      <td>0x001D</td><br>      <td>从远端设备读取版本信息</td><br>   </tr><br>   <tr><br>      <td>Read Clock Offset</td><br>      <td>0x001F</td><br>      <td>读取远端的时钟信息</td><br>   </tr><br></table>

<p><strong>（2）、链路策略指令</strong></p>
<table><br>   <tr><br>      <td>命令</td><br>      <td>OCF</td><br>      <td>简介</td><br>   </tr><br>   <tr><br>      <td>Hold Mode</td><br>      <td>0x0001</td><br>      <td>改变LM状态和本地及远程设备为主模式的LM位置</td><br>   </tr><br>   <tr><br>      <td>Sniff Mode</td><br>      <td>0x0003</td><br>      <td>改变LM状态和本地及远程设备为呼吸模式的LM位置</td><br>   </tr><br>   <tr><br>      <td>Exit Sniff Mode</td><br>      <td>0x0004</td><br>      <td>结束连接句柄在当前呼吸模式里的呼吸模式</td><br>   </tr><br>   <tr><br>      <td>Park State</td><br>      <td>0x0005</td><br>      <td>改变LM状态和本地及远程设备为休眠模式的LM位置</td><br>   </tr><br>   <tr><br>      <td>Exit Park State</td><br>      <td>0x0006</td><br>      <td>切换从休眠模式返回到激活模式的蓝牙设备</td><br>   </tr><br>   <tr><br>      <td>QoS Setup</td><br>      <td>0x0007</td><br>      <td>指出连接句柄的服务质量参数</td><br>   </tr><br>   <tr><br>      <td>Role Discovery</td><br>      <td>0x0009</td><br>      <td>蓝牙设备连接后确定自己的主从角色</td><br>   </tr><br>   <tr><br>      <td>Switch Role</td><br>      <td>0x000B</td><br>      <td>角色互换</td><br>   </tr><br>   <tr><br>      <td>Read Link Policy Settings</td><br>      <td>0x000C</td><br>      <td>为指定连接句柄读链路策略设置。链路策略设置允许主机控制器指定用于连接句柄的LM连接模式</td><br>   </tr><br>   <tr><br>      <td>Write Link Policy Settings</td><br>      <td>0x000D</td><br>      <td>为指定连接句柄写链路策略设置。链路策略设置允许主机控制器指定用于连接句柄的LM连接模式</td><br>   </tr><br>   <tr><br>      <td>Read Default Link Policy Settings</td><br>      <td>0x000E</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Write Default Link Policy Settings</td><br>      <td>0x000F</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Flow Specification</td><br>      <td>0X0010</td><br>      <td> </td><br>   </tr><br></table>

<p><strong>（3）、主机控制器与基带指令</strong></p>
<table><br>   <tr><br>      <td>Set Event Mark</td><br>      <td>0x0001</td><br>      <td>使能主机过滤HCI产生的事件</td><br>   </tr><br>   <tr><br>      <td>Reset</td><br>      <td>0x0003</td><br>      <td>复位蓝牙控制器、链路管理器、基带链路管理器</td><br>   </tr><br>   <tr><br>      <td>Set Event Filter</td><br>      <td>0x0005</td><br>      <td>使能主机指定不同事件过滤</td><br>   </tr><br>   <tr><br>      <td>Flush</td><br>      <td>0x0008</td><br>      <td>针对指定的蓝牙句柄，放弃所有作为当前待传输数据，甚至当前是属于多个在主机控制器里的L2CAP指令的数据块</td><br>   </tr><br>   <tr><br>      <td>Read PIN Type</td><br>      <td>0x0009</td><br>      <td>主机读取指定主机的PIN类型是可变的还是固定的</td><br>   </tr><br>   <tr><br>      <td>Write PIN Type</td><br>      <td>0x000A</td><br>      <td>主机写入指定主机的PIN类型是可变的还是固定的</td><br>   </tr><br>   <tr><br>      <td>Create New Unit Key</td><br>      <td>0x000B</td><br>      <td>创建新的单一密钥</td><br>   </tr><br>   <tr><br>      <td>Read Stored Link Key</td><br>      <td>0x000D</td><br>      <td>读取存放在蓝牙控制器中的单个或者多个密钥</td><br>   </tr><br>   <tr><br>      <td>Write Stored Link Key</td><br>      <td>0x0011</td><br>      <td>写入存放在蓝牙控制器中的单个或者多个密钥</td><br>   </tr><br>   <tr><br>      <td>Delete Stored Link Key</td><br>      <td>0x0012</td><br>      <td>删除存放在蓝牙控制器中的单个或者多个密钥</td><br>   </tr><br>   <tr><br>      <td>Write Local Name</td><br>      <td>0x0013</td><br>      <td>修改蓝牙设备名称</td><br>   </tr><br>   <tr><br>      <td>Read Local Name</td><br>      <td>0x0014</td><br>      <td>读取蓝牙设备名称</td><br>   </tr><br>   <tr><br>      <td>Read Connection Accept Timeout</td><br>      <td>0x0015</td><br>      <td>读连接识别超时参数值，定时器终止后蓝牙硬件自动拒绝连接</td><br>   </tr><br>   <tr><br>      <td>Write Connection Accept Timeout</td><br>      <td>0x0016</td><br>      <td>写连接识别超时参数值，定时器终止后蓝牙硬件自动拒绝连接</td><br>   </tr><br>   <tr><br>      <td>Read Page Timeout</td><br>      <td>0x0017</td><br>      <td>读寻呼超时参数值，本地设备返回连接失败前，该值是允许蓝牙硬件定义等待远程设备连接申请时间</td><br>   </tr><br>   <tr><br>      <td>Write Page Timeout</td><br>      <td>0x0018</td><br>      <td>写寻呼超时参数值，本地设备返回连接失败前，该值是允许蓝牙硬件定义等待远程设备连接申请时间</td><br>   </tr><br>   <tr><br>      <td>Read Scan Enable</td><br>      <td>0x0019</td><br>      <td>写出扫描允许参数值—用来控制蓝牙设备周期性查询</td><br>   </tr><br>   <tr><br>      <td>Write Scan Enable</td><br>      <td>0x001A</td><br>      <td>读出扫描允许参数值—用来控制蓝牙设备周期性查询</td><br>   </tr><br>   <tr><br>      <td>Read Page Scan Activity</td><br>      <td>0x001B</td><br>      <td>读寻呼扫描间隔、寻呼扫描区间参数</td><br>   </tr><br>   <tr><br>      <td>Write Page Scan Activity</td><br>      <td>0x001C</td><br>      <td>写寻呼扫描间隔、寻呼扫描区间参数</td><br>   </tr><br>   <tr><br>      <td>Read Inquiry Scan Activity</td><br>      <td>0x001D</td><br>      <td>读查询扫描间隔、查询扫描区间参数</td><br>   </tr><br>   <tr><br>      <td>Write Inquiry Scan Activity</td><br>      <td>0x001E</td><br>      <td>写查询扫描间隔、查询扫描区间参数</td><br>   </tr><br>   <tr><br>      <td>Read Authentication Enable</td><br>      <td>0x001F</td><br>      <td>读取鉴权允许参数—控制蓝牙设备是否对每个连接进行鉴权</td><br>   </tr><br>   <tr><br>      <td>Write Authentication Enable</td><br>      <td>0x0020</td><br>      <td>写取鉴权允许参数—控制蓝牙设备是否对每个连接进行鉴权</td><br>   </tr><br>   <tr><br>      <td>Read Encryption Mode</td><br>      <td>0x0021</td><br>      <td>读加密模式数值—控制蓝牙设备是否对每个连接进行加密</td><br>   </tr><br>   <tr><br>      <td>Write Encryption Mode</td><br>      <td>0x0022</td><br>      <td>写加密模式数值—控制蓝牙设备是否对每个连接进行加密</td><br>   </tr><br>   <tr><br>      <td>Read Class Of Device</td><br>      <td>0x0023</td><br>      <td>读取设备类型参数值，用于区别设备能力</td><br>   </tr><br>   <tr><br>      <td>Write Class Of Device</td><br>      <td>0x0024</td><br>      <td>写设备类型参数值，用于区别设备能力</td><br>   </tr><br>   <tr><br>      <td>Read Voice Setting</td><br>      <td>0x0025</td><br>      <td>读取语音设置参数值，控制语音连接的各种设置</td><br>   </tr><br>   <tr><br>      <td>Write Voice Setting</td><br>      <td>0x0026</td><br>      <td>写语音设置参数值，控制语音连接的各种设置</td><br>   </tr><br>   <tr><br>      <td>Read Automatic Flush Timeout</td><br>      <td>0x0027</td><br>      <td>对指定句柄，读取刷新超时值</td><br>   </tr><br>   <tr><br>      <td>Write Automatic Flush Timeout</td><br>      <td>0x0028</td><br>      <td>对指定句柄，写入刷新超时值</td><br>   </tr><br>   <tr><br>      <td>Read Num Broadcast Retransmissions</td><br>      <td>0x0029</td><br>      <td>读取设备的广播重复发送次数，重复发送提高广播消息的可靠性</td><br>   </tr><br>   <tr><br>      <td>Write Num Broadcast Retransmissions</td><br>      <td>0x002A</td><br>      <td>写入设备的广播重复发送次数，重复发送提高广播消息的可靠性</td><br>   </tr><br>   <tr><br>      <td>Read Hold Mode Activity</td><br>      <td>0x002B</td><br>      <td>读取Hold Mode Activity的参数值，用来确定Hold挂起的时间</td><br>   </tr><br>   <tr><br>      <td>Write Hold Mode Activity</td><br>      <td>0x002C</td><br>      <td>写入Hold Mode Activity的参数值，用来确定Hold挂起的时间</td><br>   </tr><br>   <tr><br>      <td>Read Transmit Power Level</td><br>      <td>0x002D</td><br>      <td>对指定句柄，读取传输功率的参数值</td><br>   </tr><br>   <tr><br>      <td>Read Synchronous Flow Control Enable</td><br>      <td>0x002E</td><br>      <td>读取SCO流量控制设置。通过使用该设置，主机控制器决定是否主机控制器发送与SCO连接句柄相关的完成分组事件的数量</td><br>   </tr><br>   <tr><br>      <td>Write Synchronous Flow Control Enable</td><br>      <td>0x002F</td><br>      <td>读写入SCO流量控制设置。通过使用该设置，主机控制器决定是否主机控制器发送与SCO连接句柄相关的完成分组事件的数量</td><br>   </tr><br>   <tr><br>      <td>Set Host Controller To Host Flow Control</td><br>      <td>0x0031</td><br>      <td>主机控制器的打开、关闭，主机控制器到主机的流量控制</td><br>   </tr><br>   <tr><br>      <td>Host Buffer Size</td><br>      <td>0x0033</td><br>      <td>主机通知主机控制器自己的ACL、SCO数据缓冲区大小。主机控制器分段传输数据，而数据不会超出这个范围</td><br>   </tr><br>   <tr><br>      <td>Host Number Of Completed Packets</td><br>      <td>0x0035</td><br>      <td>当主机对于任何连接的句柄准备接受较多的HCI指令时，该指令用于通过主机指出主机控制器</td><br>   </tr><br>   <tr><br>      <td>Read Link Supervision Timeout</td><br>      <td>0x0036</td><br>      <td>读取连接管理超时参数。主从蓝牙设备用该参数监视链路丢失情况</td><br>   </tr><br>   <tr><br>      <td>Write Link Supervision Timeout</td><br>      <td>0x0037</td><br>      <td>写入连接管理超时参数。主从蓝牙设备用该参数监视链路丢失情况</td><br>   </tr><br>   <tr><br>      <td>Read Number of Supported IAC</td><br>      <td>0x0038</td><br>      <td>读取查询扫描期间本地蓝牙扫描的查询识别码（ICA）的数值</td><br>   </tr><br>   <tr><br>      <td>Read Current IAC LAP</td><br>      <td>0x0039</td><br>      <td>读取创建在查询扫描期间本地蓝牙设备正同时扫描的蓝牙识别码的LAP</td><br>   </tr><br>   <tr><br>      <td>Write Current IAC LAP</td><br>      <td>0x003A</td><br>      <td>写入创建在查询扫描期间本地蓝牙设备正同时扫描的蓝牙识别码的LAP</td><br>   </tr><br>   <tr><br>      <td>Read Page Scan Period Mode</td><br>      <td>0x003B</td><br>      <td>读取本地蓝牙设备的强制寻呼扫描区间模式</td><br>   </tr><br>   <tr><br>      <td>Write Page Scan Period Mode</td><br>      <td>0x003C</td><br>      <td>写入本地蓝牙设备的强制寻呼扫描区间模式</td><br>   </tr><br>   <tr><br>      <td>Read Page Scan Mode</td><br>      <td>0x003D</td><br>      <td>读取本地蓝牙设备的默认寻呼扫描区间模式</td><br>   </tr><br>   <tr><br>      <td>Write Page Scan Mode</td><br>      <td>0x003E</td><br>      <td>写入本地蓝牙设备的默认寻呼扫描区间模式</td><br>   </tr><br></table>

<p><strong>（4）、信息指令参数</strong></p>
<table><br>   <tr><br>      <td>Read Local Version Information</td><br>      <td>0x0001</td><br>      <td>读取本地蓝牙版本信息</td><br>   </tr><br>   <tr><br>      <td>Read Local Supported Features</td><br>      <td>0x0003</td><br>      <td>读取本地蓝牙设备特征表</td><br>   </tr><br>   <tr><br>      <td>Read Local Extended Features</td><br>      <td>0x0004</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Read Buffer Size</td><br>      <td>0x0005</td><br>      <td>返回HCI缓冲容量。缓冲容量用于传输缓冲数据</td><br>   </tr><br>   <tr><br>      <td>Read Country Code [Deprecated]</td><br>      <td>0x0007</td><br>      <td>读取国家代码状态参数值</td><br>   </tr><br>   <tr><br>      <td>Read BD ADDR</td><br>      <td>0x0009</td><br>      <td>读取BD_ADDR的参数值</td><br>   </tr><br></table><br><strong>（5）、状态指令参数</strong><br><table><br>   <tr><br>      <td>Read Failed Contact Count</td><br>      <td>0x0001</td><br>      <td>读取对于其他设备特殊连接的Failed Contact Count参数值。Failed Contact Count记录在刷新时终止及当前正在传输的L2CAP数据指令被自动刷新后，主单元或从单元不能连续响应事件次数</td><br>   </tr><br>   <tr><br>      <td>Reset Failed Contact Count</td><br>      <td>0x0002</td><br>      <td>复位时对于其他设备的连接的Failed Contact Count的参数值。Failed Contact Count记录在刷新时终止及当前正在传输的L2CAP数据指令被自动刷新后，主单元或从单元不能连续响应事件次数</td><br>   </tr><br>   <tr><br>      <td>Get Link Quality</td><br>      <td>0x0003</td><br>      <td>读取指定连接句柄的Link Quality的值</td><br>   </tr><br>   <tr><br>      <td>Read RSSI</td><br>      <td>0x0005</td><br>      <td>读取对于其他蓝牙设备连接句柄的接收信号强度指示</td><br>   </tr><br>   <tr><br>      <td>Read AFH Channel Map</td><br>      <td>0x0007</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>Read BD Clock</td><br>      <td>0x0009</td><br>      <td> </td><br>   </tr><br></table><br><strong>（6）、测试指令</strong><br><table><br>   <tr><br>      <td>Read Loopback Mode</td><br>      <td>0x0001</td><br>      <td>读取主机端控制器会送模式的设置值。回送模式设置可以确定信息发送路径</td><br>   </tr><br>   <tr><br>      <td>Write Loopback Mode</td><br>      <td>0x0002</td><br>      <td>写入主机控制器会送模式的设置值。回送模式设置可以确定信息发送路径</td><br>   </tr><br>   <tr><br>      <td>Enable Device Under Test Mode</td><br>      <td>0x0003</td><br>      <td>允许本地蓝牙设备模块通过LMP测试指令接入测试模式。当主机要求本地设备作为待测试设备，实现蓝牙测试模式文件中规定测试场景，则发送该指令</td><br>   </tr><br></table>

<p><strong>（7）、错误代码</strong></p>
<table><br>   <tr><br>      <td>错误代码</td><br>      <td>错误含义</td><br>      <td>错误代码</td><br>      <td>错误含义</td><br>   </tr><br>   <tr><br>      <td>0x01</td><br>      <td>位置HCI指令</td><br>      <td>0x14</td><br>      <td>由于另一端引起连接中断：资源限制</td><br>   </tr><br>   <tr><br>      <td>0x02</td><br>      <td>不能连接</td><br>      <td>0x15</td><br>      <td>由于另一端引起连接中断：关机</td><br>   </tr><br>   <tr><br>      <td>0x03</td><br>      <td>硬件故障</td><br>      <td>0x16</td><br>      <td>本机中断连接</td><br>   </tr><br>   <tr><br>      <td>0x04</td><br>      <td>寻呼超时</td><br>      <td>0x17</td><br>      <td>重复尝试</td><br>   </tr><br>   <tr><br>      <td>0x05</td><br>      <td>身份验证失败</td><br>      <td>0x18</td><br>      <td>不允许匹配</td><br>   </tr><br>   <tr><br>      <td>0x06</td><br>      <td>键丢失</td><br>      <td>0x19</td><br>      <td>未知LMP PDU</td><br>   </tr><br>   <tr><br>      <td>0x07</td><br>      <td>存储器已满</td><br>      <td>0x1A</td><br>      <td>不支持远端特性</td><br>   </tr><br>   <tr><br>      <td>0x08</td><br>      <td>连接超时</td><br>      <td>0x1B</td><br>      <td>拒绝SCO补偿</td><br>   </tr><br>   <tr><br>      <td>0x09</td><br>      <td>最大连接数</td><br>      <td>0x1C</td><br>      <td>拒绝SCO间歇模式</td><br>   </tr><br>   <tr><br>      <td>0x0A</td><br>      <td>连接到设备A的最大SCO连接数</td><br>      <td>0x1D</td><br>      <td>拒绝SCO无线模式</td><br>   </tr><br>   <tr><br>      <td>0x0B</td><br>      <td>ACL连接已存在</td><br>      <td>0x1E</td><br>      <td>非法链路管理参数</td><br>   </tr><br>   <tr><br>      <td>0x0C</td><br>      <td>指令非法</td><br>      <td>0x1F</td><br>      <td>未特别指明错误</td><br>   </tr><br>   <tr><br>      <td>0x0D</td><br>      <td>由于资源有限，主机被拒绝</td><br>      <td>0x20</td><br>      <td>不支持链路管理器协议参数</td><br>   </tr><br>   <tr><br>      <td>0x0E</td><br>      <td>由于安全原因，主机被拒绝</td><br>      <td>0x21</td><br>      <td>不允许角色改变</td><br>   </tr><br>   <tr><br>      <td>0x0F</td><br>      <td>由于远端设备单连接设备，主机拒绝</td><br>      <td>0x22</td><br>      <td>链路管理响应超时</td><br>   </tr><br>   <tr><br>      <td>0x10</td><br>      <td>主机超时</td><br>      <td>0x23</td><br>      <td>链路管理错误处理事务冲突</td><br>   </tr><br>   <tr><br>      <td>0x11</td><br>      <td>不支持特性或参数值</td><br>      <td>0x24</td><br>      <td>不允许LMP PDU</td><br>   </tr><br>   <tr><br>      <td>0x12</td><br>      <td>非法主机控制接口指令</td><br>      <td>0x25~0xFF</td><br>      <td>保留</td><br>   </tr><br>   <tr><br>      <td>0x13</td><br>      <td>由于另一端引起连接中断：用户中断连接</td><br>      <td> </td><br>      <td> </td><br>   </tr><br></table>

<h3 id="二、逻辑链路控制与适配协议-L2CAP"><a href="#二、逻辑链路控制与适配协议-L2CAP" class="headerlink" title="二、逻辑链路控制与适配协议  L2CAP"></a>二、逻辑链路控制与适配协议  L2CAP</h3><p>L2CAP位于基带之上，将基带的数据分组转换为便于高层应用的数据分组格式，并提供协议复用和服务质量交换等功能。L2CAP只支持ACL数据传输，不支持SCO数据。</p>
<p>L2CAP本身不提供加强信道可靠性和保证数据完整性的机制，其信道的可靠性依靠基带提供。</p>
<p><img src="http://img.blog.csdn.net/20171229150912346?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写代码片"></p>
<h4 id="1、协议复用："><a href="#1、协议复用：" class="headerlink" title="1、协议复用："></a>1、协议复用：</h4><p>底层传输协议没有提供对高层协议的复用机制，因而L2CAP支持高层协议复用，L2CAP层可以区分其上的SDP、RFCOMM、TCS等。</p>
<h3 id="2、分段重组："><a href="#2、分段重组：" class="headerlink" title="2、分段重组："></a>2、分段重组：</h3><p>L2CAP层帮助实现基带的短PDU和高层的长PDU相互传输，L2CAP本身不完成任何PDU的分段重组，具体的分段重组有低层和高层来完成。</p>
<h3 id="3、服务质量"><a href="#3、服务质量" class="headerlink" title="3、服务质量"></a>3、服务质量</h3><p>Qualityof Serivce 信息的交换：蓝牙建立连接的过程中，L2CAP允许交互蓝牙所期望的服务质量，建立完成后，通过监视资源的使用情况，来保证服务质量。</p>
<p>###4、组抽象：</p>
<p>L2CAP忽略地址组概念，他只关心数据。<br>    L2CAP信道有三种类型：<br>        <strong>A、面向连接信道：</strong>Connection-OrientedCO，用于两个设备之间的数据通信。<br>        <strong>B、无连接信道：</strong>Connection-LessCL，用来向一组设备广播方式传输数据。CID为固定值：0x0002。<br>        <strong>C、信令信道：</strong>Signaling，用于创建CO通道，可以通过协商改变CO信道的特性。<br>CL信道的L2CAP_PDU</p>
<table><br>   <tr><br>      <td>长度（2bytes）</td><br>      <td>信道ID（0x0002）</td><br>      <td>PSM(最小为2bytes)</td><br>      <td>有效载荷</td><br>   </tr><br></table>

<p>PSM为 协议/服务复用器Protocol/Service Multiplexer，一般为SDP、RFCOMM、TCS等中介协议复用。小于0x1000的值，0x0001对应SDP，0x0003对应RFCOMM、0x0005对应TCS。</p>
<p><strong>（1）、蓝牙逻辑链路控制与适配协议信令：</strong><br>    L2CAP的信令通道的CID为0x0001<br>    <strong>信令指令分组：</strong></p>
<table><br>   <tr><br>      <td>长度（2byte）</td><br>      <td>CID(0x0001)</td><br>      <td>指令1</td><br>      <td>指令2</td><br>      <td>……………</td><br>      <td>指令n</td><br>   </tr><br>   <tr><br>      <td colspan="2">L2CAP 分组头部分</td><br>      <td colspan="4"> </td><br>   </tr><br></table>

<p><strong>信令指令格式：</strong></p>
<table><br>   <tr><br>      <td>代码（1byte）</td><br>      <td>标识符（1byte）</td><br>      <td>长度(2byte)</td><br>      <td>数据</td><br>   </tr><br>   <tr><br>      <td colspan="4">信令指令头</td><br>   </tr><br></table><br><img src="http://img.blog.csdn.net/20171229151442563?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><br>如上图所示，一条L2CAP信令，1为L2CAP分组头，2为信令指令头，3为数据部分。<br>L2CAP:<br>         Role:Master<br>         Address:11<br>         PDULength: 6  //指令的长度，值为06 00<br>         ChannelID: 0x0001  (Signaling)//L2CAP的信令通道，值为01 00<br>         Code:Information request//信息请求，值为0a<br>         Identifier:1//标识符，值为01<br>         CommandLength: 2//命令长度，值为02 00<br>         InfoType:Extended features supported//02 00<br>所以这条指令完整的为：<br>06 00 01 00 0a 01 02 00 02 00<br><br><strong>信令的其他操作如下：</strong><br><img src="http://img.blog.csdn.net/20171229151535240?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><br><strong>L2CAP信令指令码：</strong><br><table><br>   <tr><br>      <td>Code</td><br>      <td>Description</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>0x00</td><br>      <td>RESERVED</td><br>      <td>保留</td><br>   </tr><br>   <tr><br>      <td>0x01</td><br>      <td>Command reject</td><br>      <td>拒绝命令</td><br>   </tr><br>   <tr><br>      <td>0x02</td><br>      <td>Connection request</td><br>      <td>连接请求</td><br>   </tr><br>   <tr><br>      <td>0x03</td><br>      <td>Connection response</td><br>      <td>连接响应</td><br>   </tr><br>   <tr><br>      <td>0x04</td><br>      <td>Configure request</td><br>      <td>配置请求</td><br>   </tr><br>   <tr><br>      <td>0x05</td><br>      <td>Configure response</td><br>      <td>配置响应</td><br>   </tr><br>   <tr><br>      <td>0x06</td><br>      <td>Disconnection request</td><br>      <td>断开请求</td><br>   </tr><br>   <tr><br>      <td>0x07</td><br>      <td>Disconnection response</td><br>      <td>断开响应</td><br>   </tr><br>   <tr><br>      <td>0x08</td><br>      <td>Echo request</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>0x09</td><br>      <td>Echo response</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>0x0A</td><br>      <td>Information request</td><br>      <td>信息请求</td><br>   </tr><br>   <tr><br>      <td>0x0B</td><br>      <td>Information response</td><br>      <td>信息响应</td><br>   </tr><br></table>

<p>1）、连接请求Connection_Request Code=0x02</p>
<table><br>   <tr><br>      <td>代码（0x02）</td><br>      <td>标识符（1字节）</td><br>      <td>长度（2字节）</td><br>      <td>PSM（2字节）</td><br>      <td>源CID（2字节）</td><br>   </tr><br></table><br>例如：SDP 连接请求<br><br><img src="http://img.blog.csdn.net/20171229151712043?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><br>如上红框所示：<br><table><br>   <tr><br>      <td>代码（0x02）</td><br>      <td>标识符（1字节）</td><br>      <td>长度（2字节）</td><br>      <td>PSM（2字节）</td><br>      <td>源CID（2字节）</td><br>   </tr><br>   <tr><br>      <td>0x02</td><br>      <td>3</td><br>      <td>4</td><br>      <td>SDP</td><br>      <td>0x0040</td><br>   </tr><br></table><br>2）、连接相应Connection_Response Code=0x03<br><table><br>   <tr><br>      <td>代码（0x03）</td><br>      <td>标识符</td><br>      <td>长度</td><br>      <td>目标CID</td><br>      <td>源CID</td><br>      <td>结果</td><br>      <td>状态</td><br>   </tr><br></table>

<p>例如：SDP请求响应<br><img src="http://img.blog.csdn.net/20171229151924175?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>如上面红框所示：</p>
<table><br>   <tr><br>      <td>代码（0x03）</td><br>      <td>标识符</td><br>      <td>长度</td><br>      <td>目标CID</td><br>      <td>源CID</td><br>      <td>结果</td><br>      <td>状态</td><br>   </tr><br>   <tr><br>      <td>0x03</td><br>      <td>3</td><br>      <td>8</td><br>      <td>0x0040</td><br>      <td>0x0040</td><br>      <td>0x0000</td><br>      <td> </td><br>   </tr><br></table>

<p><strong>（2）、MTU MAXIMUMTRANSMISSION UNIT最大传输单元 </strong></p>
<p><img src="http://img.blog.csdn.net/20171229152051005?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br>MTU最大传输单元，L2CAP应用必须支持最小为48字节的MTU，默认值为672<br><strong>（3）、QoS 服务质量</strong></p>
<h3 id="三、服务发现协议SDP"><a href="#三、服务发现协议SDP" class="headerlink" title="三、服务发现协议SDP"></a>三、服务发现协议SDP</h3><p>SDP两种服务发现模式：<br>    <strong>1）、服务搜索：</strong>查询具有特定服务属性的服务；<br>    <strong>2）、服务浏览：</strong>简单的浏览全部可用服务。</p>
<h4 id="1-、PDU-格式：（协议数据单元）"><a href="#1-、PDU-格式：（协议数据单元）" class="headerlink" title="1 、PDU 格式：（协议数据单元）"></a>1 、PDU 格式：（协议数据单元）</h4><table><br>   <tr><br>      <td>PDU ID（1byte）</td><br>      <td>Transaction ID（2byte）</td><br>      <td>参数长度（2byte）</td><br>      <td>参数1</td><br>      <td>……</td><br>      <td>参数N</td><br>   </tr><br>   <tr><br>      <td colspan="3">Header</td><br>      <td colspan="3"> </td><br>   </tr><br></table>

<p>不同PDU ID实现SDP的不同功能，概述如下表格：</p>
<table><br>   <tr><br>      <td>Value</td><br>      <td>Parameter Descirption</td><br>      <td> </td><br>   </tr><br>   <tr><br>      <td>0x00</td><br>      <td>Reserved </td><br>      <td>保留</td><br>   </tr><br>   <tr><br>      <td>0x01</td><br>      <td>SDP_ErrorResponse</td><br>      <td>错误响应</td><br>   </tr><br>   <tr><br>      <td>0x02</td><br>      <td>SDP_ServiceSearchRequest</td><br>      <td>服务搜索请求</td><br>   </tr><br>   <tr><br>      <td>0x03</td><br>      <td>SDP_ServiceSearchResponse</td><br>      <td>服务搜索响应</td><br>   </tr><br>   <tr><br>      <td>0x04</td><br>      <td>SDP_ServiceAttributeRequest</td><br>      <td>服务属性请求</td><br>   </tr><br>   <tr><br>      <td>0x05</td><br>      <td>SDP_ServiceAttributeResponse</td><br>      <td>服务属性响应</td><br>   </tr><br>   <tr><br>      <td>0x06</td><br>      <td>SDP_ServiceSearchAttributeRequest</td><br>      <td>服务搜索属性请求</td><br>   </tr><br>   <tr><br>      <td>0x07</td><br>      <td>SDP_ServiceSearchAttributeResponse</td><br>      <td>服务搜索属性响应</td><br>   </tr><br>   <tr><br>      <td>0x08-0xff</td><br>      <td>Reserved</td><br>      <td>保留</td><br>   </tr><br></table>

<h3 id="2、服务记录表"><a href="#2、服务记录表" class="headerlink" title="2、服务记录表"></a>2、服务记录表</h3><p>SDP的服务记录表对每一个服务进行描述，每条记录包含服务句柄、一组服务属性：<br><img src="http://img.blog.csdn.net/20171229154027505?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<ul>
<li>Service Record Attributes：服务记录；</li>
<li>Service Record Handle 服务句柄；</li>
</ul>
<p><img src="http://img.blog.csdn.net/20171229154104731?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>四、串口仿真协议   RFCOMM</p>
<p>为建立在串口之上的传统应用提供环境接口，使他们可以做比较少协议改动就可以在蓝牙无线通信无线链路上工作。多路串口仿真是RFCOMM的重要功能，通过多路复用器(multiplexer)，一条L2CAP链路可以同时 多个串行应用。<br>    两台设备间的串口仿真:<br>    <img src="http://img.blog.csdn.net/20171229154137723?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>RFCOMM 两个蓝牙设备之间可以支持多达60多路仿真串口。</p>
<p><strong>RFCOMM帧类型如下：</strong></p>
<p><table><br>   <tr><br>      <td>SABM</td><br>      <td>异步平衡模式设置指令</td><br>   </tr><br>   <tr><br>      <td>UA</td><br>      <td>未加编号的确认响应</td><br>   </tr><br>   <tr><br>      <td>DM</td><br>      <td>断开连接模式响应</td><br>   </tr><br>   <tr><br>      <td>DISC</td><br>      <td>断开连接指令</td><br>   </tr><br>   <tr><br>      <td>UIH</td><br>      <td>带头校验的未编号信息命令和响应</td><br>   </tr><br></table><br><img src="http://img.blog.csdn.net/20171229154247445?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>传送门：<br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78414870" target="_blank" rel="external">（一）蓝牙的概述</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932321" target="_blank" rel="external">（二）蓝牙协议规范（射频、基带链路控制、链路管理）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932372" target="_blank" rel="external">（三）蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932616" target="_blank" rel="external">（四）蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）</a></p>
<p><a href="http://blog.csdn.net/xubin341719" target="_blank" rel="external">引用自xubin的博客</a></p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/12/29/BluetoothForAndroid3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/29/BluetoothForAndroid3/" itemprop="url">
                  蓝牙协议学习整理（二）蓝牙协议规范（射频、基带链路控制、链路管理）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-29T15:49:56+08:00">
                2017-12-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android蓝牙/" itemprop="url" rel="index">
                    <span itemprop="name">Android蓝牙</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第二章-蓝牙协议规范（射频、基带链路控制、链路管理）"><a href="#第二章-蓝牙协议规范（射频、基带链路控制、链路管理）" class="headerlink" title="第二章 蓝牙协议规范（射频、基带链路控制、链路管理）"></a>第二章 蓝牙协议规范（射频、基带链路控制、链路管理）</h2><p><img src="http://img.blog.csdn.net/20171229114644415?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>蓝牙协议是蓝牙设备间交换信息所应该遵守的规则。与开放系统互联（OSI）模型一样，蓝牙技术的协议体系也采用了分层结构，从底层到高层形成了蓝牙协议栈，各层协议定义了所完成的功能和使用数据分组格式，以保证蓝牙产品间的互操作性。</p>
<h3 id="一、射频协议"><a href="#一、射频协议" class="headerlink" title="一、射频协议"></a>一、射频协议</h3><p>射频位置如上图红色部分。</p>
<h4 id="1、工作频率"><a href="#1、工作频率" class="headerlink" title="1、工作频率"></a>1、工作频率</h4><p>蓝牙工作在2.4GHz ISM频段上，蓝牙采用跳频扩谱技术主动的避免工作频段受干扰（微波炉的工作频率也是2.4GHz）。<br><img src="http://img.blog.csdn.net/20171229114755376?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>|    地理位置        |    ISM频段范围    |    射频信道频率    |<br>|—————|—————|———–|<br>|中国、美国、欧洲    |2400.0～2483.5MHz|F=(2402+k)MHz,k在0、1、……78中随机取值|<br>|    法国            |2446.5～2483.5MHz|F=(2454+k)MHz,k在0、1、……22中随机取值|<br>|    日本            |2471.0～2497.0MHz|F=(2473+k)MHz,k在0、1、……22中随机取值|<br>|    西班牙        |2445.0～2475.0MHz|F=(2449+k)MHz,k在0、1、……22中随机取值|</p>
<p>我国的蓝牙频率在2.402GHz～2.483GHz,蓝牙每个频道的宽度为1MHz，为了减少带外辐射的干扰，保留上、下保护为3.5MHz和2MHz，79个跳频点中至少75个伪随机码跳动，30S内任何一个频点使用时长不能超过0.4S。</p>
<h4 id="2、跳频技术、发射功率、时隙"><a href="#2、跳频技术、发射功率、时隙" class="headerlink" title="2、跳频技术、发射功率、时隙"></a>2、跳频技术、发射功率、时隙</h4><p><strong>（1）、发射功率：</strong>蓝牙发射功率分三级：一级功率100mW(20dBm)；二级功率2.5mW(4dBm)；三级功率1mW(0dBm)；<br><strong>（2）、物理信道：</strong>蓝牙物理信道有伪随机序列控制的79个跳频点构成，不同跳频序列代表不同的信道。<br><img src="http://img.blog.csdn.net/20171229115505075?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><strong>（3）、时隙：</strong>蓝牙跳频速率为1600次/s,每个时间为625uS(1S/1600)称为一个时隙；<br><img src="http://img.blog.csdn.net/20171229115555374?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="二、基带与链路控制协议"><a href="#二、基带与链路控制协议" class="headerlink" title="二、基带与链路控制协议"></a>二、基带与链路控制协议</h3><p><img src="http://img.blog.csdn.net/20171229115905108?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>蓝牙发送数据时，基带部分将来自高层的数据进行信道编码，向下发给射频进行发送；接收数据时，将解调恢复空中数据并上传给基带，基带进行信道编码传送给上层。</p>
<p>作用：跳频选择、蓝牙编址、链路类型、信道编码、收发规则、信道控制、音频规范、安全设置。</p>
<h4 id="1、蓝牙分组编码为小端模式；"><a href="#1、蓝牙分组编码为小端模式；" class="headerlink" title="1、蓝牙分组编码为小端模式；"></a>1、蓝牙分组编码为小端模式；</h4><h4 id="2、蓝牙地址"><a href="#2、蓝牙地址" class="headerlink" title="2、蓝牙地址"></a>2、蓝牙地址</h4><ul>
<li><strong>BD_ADDR：</strong>BluetoothDevice Address；</li>
<li><strong>LAP:</strong>LowerAddress Part 低地址部分；</li>
<li><strong>UAP:</strong> UpperAddress Part 高地址部分；</li>
<li><strong>NAP:</strong> Non-significantAddress Part 无效地址部分。</li>
</ul>
<p><img src="http://img.blog.csdn.net/20171229120127670?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>3、蓝牙时钟</p>
<p>每个蓝牙设备都有一个独立运行的内部系统时钟，称为本地时钟（Local Clock），决定定时器的收发跳频。为了与其他设备同步，本地时钟要加一个偏移量（offset），提供给其他设备同步。</p>
<p>蓝牙基带四个关键周期：312.5uS、625uS、1.25mS、1.28S。</p>
<p><img src="http://img.blog.csdn.net/20171229120236696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<ol>
<li><strong>CLKN：</strong>本地时钟：</li>
<li><strong>CLKE:</strong>预计时钟，扫描寻呼过程中用到；</li>
<li><p><strong>CLK：</strong>设备实际运行的时钟频率。</p>
<p>CLKE、CLK由CLKN加上一个偏移量得到的。</p>
<p><img src="http://img.blog.csdn.net/20171229124607640?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
</li>
</ol>
<h4 id="4、蓝牙物理链路："><a href="#4、蓝牙物理链路：" class="headerlink" title="4、蓝牙物理链路："></a>4、蓝牙物理链路：</h4><p>通信设备间物理层的数据连接通道就是物理链路。</p>
<p>ACL（Asynchronous Connectionless）异步无连接链路；对时间要求不敏感的数据通信，如文件数据、控制信令等。</p>
<p>SCO（Synochronous Connection Oriented）同步面向连接链路；对时间比较敏感的通信，如：语音；最多只支持3条SCO链路，不支持重传。</p>
<p>ACL用于数据传输；</p>
<h4 id="5、蓝牙基带分组："><a href="#5、蓝牙基带分组：" class="headerlink" title="5、蓝牙基带分组："></a>5、蓝牙基带分组：</h4><pre><code>基带分组至少包括：接入码、分组头、有效载荷；
</code></pre><p><img src="http://img.blog.csdn.net/20171229133330554?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="列表内容"></p>
<p><strong>（1）、接入码</strong>用于同步、直流、载频泄漏偏置补偿标识；<br><strong>（2）、分组头</strong>包含链路信息，确保纠正较多的错误。<br>分组类型如下：</p>
<table><br>   <tr><br>      <td>分组类别</td><br>      <td>Type(b3b2b1b0)</td><br>      <td>时隙</td><br>      <td>SCO</td><br>      <td>ACL</td><br>   </tr><br>   <tr><br>      <td rowspan="4">链路控制分组</td><br>          <td>0000 </td><br>          <td rowspan="4">1</td><br>          <td>NULL</td><br>          <td>NULL</td><br>   </tr><br>   <tr><br>         <td>0001 </td><br>         <td>POLL</td><br>         <td>POLL</td><br>   </tr><br>     <tr><br>         <td>0010 </td><br>         <td>FHS</td><br>         <td>FHS</td><br>   </tr><br>    <tr><br>         <td>0011 </td><br>         <td>DM1</td><br>         <td>DM1</td><br>   </tr><br>         <td rowspan="6">单时隙分组</td><br>          <td>0100</td><br>          <td rowspan="6">1</td><br>          <td>未定义</td><br>          <td rowspan="5">NULL</td><br>   <br>   <tr><br>         <td>0101</td><br>         <td>HV1</td><br>   </tr><br>     <tr><br>         <td>0110</td><br>         <td>HV2</td><br>   </tr><br>    <tr><br>         <td>0111</td><br>         <td>HV3</td><br>   </tr><br>   <tr><br>         <td>1000</td><br>         <td>DV</td><br>   </tr><br>   <tr><br>         <td>1001</td><br>         <td>NULL</td><br>         <td>AUX1</td><br>   </tr><br>         <td rowspan="4">3时隙分组</td><br>          <td>1010</td><br>          <td rowspan="4">3</td><br>          <td rowspan="4">未定义</td><br>          <td>DM3</td><br>   <br>   <tr><br>         <td>1011</td><br>         <td>DH3</td><br>   </tr><br>     <tr><br>         <td>1100</td><br>         <td rowspan="2">未定义</td><br>   </tr><br>    <tr><br>         <td>1101</td><br>   </tr><br>            <td rowspan="2">5时隙分组</td><br>          <td>1010</td><br>          <td rowspan="2">5</td><br>          <td rowspan="2">未定义</td><br>          <td rowspan="2">DM5</td><br>   <br>   <tr><br>         <td>1111</td><br>   </tr><br></table>

<p>ACL分组形式为：D(M|H)（1|3|5）,D代表数据分组，M代表用2/3比例的FEC的中等速率分组；H代表不使用纠错码的高速率分组；1、3、5分别代表分组所占用的时隙数目；<br>    DM1、DM3、DM5、DH1、DH3、DH5</p>
<p>SCO分组形式为：HV(1|2|3)。HV代表高质量语言分组，1、2、3有效载荷所采用的纠错码方法。1为1/3比例FEC，设备2个时隙发送一个单时隙分组；2为2/3比例FEC，设备4个时隙发送一个单时隙分组；3为不使用纠错码，设备6个时隙发送一个单时隙分组</p>
<p>HV1、HV2、HV3</p>
<p><strong>ALC 分组：</strong></p>
<table><br>   <tr><br>      <td rowspan="2">类型 </td><br>      <td rowspan="2">有效载荷头/字节</td><br>      <td rowspan="2">用户有效载荷/字节</td><br>      <td rowspan="2">FEC</td><br>      <td rowspan="2">CRC</td><br>      <td rowspan="2">对称最大速率/kbps</td><br>      <td colspan="2">非对称速率/kbps</td><br>   </tr><br>   <tr><br>      <td>前向</td><br>      <td>后向</td><br>   </tr><br>   <tr><br>      <td>DM1</td><br>      <td>1</td><br>      <td>0～17</td><br>      <td>2/3</td><br>      <td>有</td><br>      <td>108.8</td><br>      <td>108.8</td><br>      <td>108.8</td><br>   </tr><br>   <tr><br>      <td>DH1</td><br>      <td>1</td><br>      <td>0～27</td><br>      <td>无</td><br>      <td>有</td><br>      <td>172.8</td><br>      <td>172.8</td><br>      <td>172.8</td><br>   </tr><br>   <tr><br>      <td>DM3</td><br>      <td>2</td><br>      <td>0～121</td><br>      <td>2/3</td><br>      <td>有</td><br>      <td>258.1</td><br>      <td>387.2</td><br>      <td>54.4</td><br>   </tr><br>   <tr><br>      <td>DH3</td><br>      <td>2</td><br>      <td>0～183</td><br>      <td>无</td><br>      <td>有</td><br>      <td>390.4</td><br>      <td>585.6</td><br>      <td>86.4</td><br>   </tr><br>   <tr><br>      <td>DM5</td><br>      <td>2</td><br>      <td>0～224</td><br>      <td>2/3</td><br>      <td>有</td><br>      <td>286.7</td><br>      <td>477.8</td><br>      <td>36.3</td><br>   </tr><br>   <tr><br>      <td>MH5</td><br>      <td>2</td><br>      <td>0～339</td><br>      <td>无</td><br>      <td>有</td><br>      <td>433.9</td><br>      <td>723.2</td><br>      <td>57.6</td><br>   </tr><br>   <tr><br>      <td>AUX1</td><br>      <td>1</td><br>      <td>0～29</td><br>      <td>无</td><br>      <td>无</td><br>      <td>185.6</td><br>      <td>185.6</td><br>      <td>185.6</td><br>   </tr><br></table><br><strong>SCO分组：</strong><br><table><br>   <tr><br>      <td>类型</td><br>      <td>有效载荷头/字节</td><br>      <td>用户有效载荷/字节</td><br>      <td>FEC</td><br>      <td>CRC</td><br>      <td>有效载荷长度</td><br>      <td>同步速率/kbps</td><br>      <td>占用Tsco数目/语言长度</td><br>   </tr><br>   <tr><br>      <td>HV1</td><br>      <td rowspan="3">无</td><br>      <td>10</td><br>      <td>1/3</td><br>      <td rowspan="3"> </td><br>      <td rowspan="4">240位</td><br>      <td rowspan="3">64</td><br>      <td>2/1.25ms</td><br>   </tr><br>   <tr><br>      <td>HV2</td><br>      <td>20</td><br>      <td>2/3</td><br>      <td>4/2.5ms</td><br>   </tr><br>   <tr><br>      <td>HV3</td><br>      <td>30</td><br>      <td>无</td><br>      <td>6/3.75ms</td><br>   </tr><br>   <tr><br>      <td>DV</td><br>      <td>1D</td><br>      <td>10+(0-9)D</td><br>      <td>2/3D</td><br>      <td>有D</td><br>      <td>64+57.6D</td><br>      <td> </td><br>   </tr><br></table>

<pre><code>注释：D 只对数据段有用，DV分组包含数据段，也包含语言段。
</code></pre><p><strong>（3）、有效载荷</strong>  分语言有效载荷、数据有效载荷。</p>
<h4 id="6、蓝牙的逻辑信道"><a href="#6、蓝牙的逻辑信道" class="headerlink" title="6、蓝牙的逻辑信道"></a>6、蓝牙的逻辑信道</h4><ul>
<li>链路控制信道：LinkControl  LC</li>
<li>链路管理信道：Link Manage LM</li>
<li>用户异步数据信道：User AsynchronizationUA</li>
<li>用户同步数据信道：UserSynchronization US</li>
<li>用户等时数据信道：UserIsochronous UI  UI</li>
</ul>
<h4 id="7、蓝牙的收发规则"><a href="#7、蓝牙的收发规则" class="headerlink" title="7、蓝牙的收发规则"></a>7、蓝牙的收发规则</h4><p><img src="http://img.blog.csdn.net/20171229143427545?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>上图为RX缓存。<br><img src="http://img.blog.csdn.net/20171229143503808?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>上图为TX缓存。<br>新分组到达时，ACL链路的RX缓存器要流量控制，SCO数据不需要流量控制；</p>
<h4 id="8、蓝牙基带信道和网络控制"><a href="#8、蓝牙基带信道和网络控制" class="headerlink" title="8、蓝牙基带信道和网络控制"></a>8、蓝牙基带信道和网络控制</h4><p><strong>（1）、链路控制器状态：</strong><br>    待机、连接<br>    寻呼page、寻呼扫描pagescan、查询inquiry、查询扫描inquiry scan、主设备相应Master Response、从设备相应Slave Response、查询相应inquiry response<br><strong>（2） 、连接状态</strong><br>    激活模式active、呼吸模式sniff、保持模式hold、休眠模式park。<br><strong>（3）、待机状态</strong><br>         待机状态是蓝牙设备缺省低功耗状态，此状态下本地时钟以低精度运行。蓝牙从待机转入寻呼扫描状态，对其他<font color="red">寻呼进行响应</font>成为<font color="blue">从设备</font>；也可以从待机状态进入<font color="red">查询扫描状态</font>，完成一个完整的寻呼，成为<font color="blue">主设备</font>。</p>
<h4 id="9、接入过程"><a href="#9、接入过程" class="headerlink" title="9、接入过程"></a>9、接入过程</h4><p>注释：<br>    IAC Inquiry AccessCode 查询接入码；<br>    GIAC:通用查询接入码 DIAC：专用查询接入码；<br>    DAC：DeviceAccess Code 设备接入码；<br>LAP：<br>         建立连接，必须使用查询、寻呼；查询过程使用IAC，发现覆盖区域内的设备、设备的地址及其时钟；连接过程使用DAC，建立连接的设备处理寻呼过程，成为主设备。</p>
<p> <strong>（1）、查询过程</strong><br>    蓝牙设备通过查询来发现通信范围内的其他蓝牙设备。查询信息分为GIAC、DIAC两种。查询发起设备收集所有相应设备的地址、时钟信息。<br>    一设备进入查询状态去发现其他设备，查询状态下连续不断的在不同频点发送查询消息。查询的跳频序列有GIAC的LAP导出。<br>    一设备想被其他设备发现，就要周期性进入 查询扫描状态，以便相应查询消息。如：我们选择设备多长时间可见，其实就是  进入查询扫描状态。<br><strong>A、查询扫描</strong><br>    查询扫描状态下，接收设备扫描接入码的时间长度，足以完成对16个频率的扫描。扫描区间长度Twindow inquiry scan。扫描在同一个频率上进行，查询过程用32跳专用查询跳频序列，此序列有通用查询的地址决定，相位有本地时钟决定，每隔1.28S变化一次。<br><strong>B、查询</strong><br>    与寻呼类似，TX用查询跳频序列、RX用查询相应跳频序列。<br><strong>C、查询相应</strong><br>    从设备响应查询操作。每个设备都有自己的时钟，使用查询序列相位相同的几率比较小。为了避免多个设备在同一查询跳频信道同时激活，从设备查询响应规定：从设备收到查询消息，产生0-1023只觉得额一个随机数，锁定当时相位输入值进行跳频选择，从设备此后的RAND时隙中返回到连接或者待机状态。</p>
<p> <strong>（2）、寻呼扫描</strong><br>    DAC：DeviceAccess Code 设备接入码<br>    寻呼扫描状态下的设备扫描窗口Twindowpage scan内监听自己的DAC。监听只在一个跳频点进行。Twindow page scan足够覆盖16个寻呼扫描频点。<br>    寻呼扫描状态，扫描在同一个频率上进行，持续1.28S，在选择另一个不同频率。</p>
<p><table><br>   <tr><br>      <td>SR模式</td><br>      <td>Tpage scan</td><br>      <td>寻呼次数Npage</td><br>   </tr><br>   <tr><br>      <td>R0</td><br>      <td>连续</td><br>      <td>&gt;=1</td><br>   </tr><br>   <tr><br>      <td>R1</td><br>      <td>&lt;=1.28S</td><br>      <td>&gt;=128</td><br>   </tr><br>   <tr><br>      <td>R2</td><br>      <td>&lt;=2.56S</td><br>      <td>&gt;=256</td><br>   </tr><br>   <tr><br>      <td>预留</td><br>      <td>–</td><br>      <td>–</td><br>   </tr><br></table><br><strong>（3）、寻呼</strong><br>    主设备使用寻呼发起一个主—从设备连接，通过在不同的跳频点上重复发送从设备DAC来扑捉从设备，从设备在寻呼扫描状态被唤醒，接收寻呼。<br><strong>（4）、寻呼相应过程</strong></p>
<h3 id="三、链路管理器"><a href="#三、链路管理器" class="headerlink" title="三、链路管理器"></a>三、链路管理器</h3><p><img src="http://img.blog.csdn.net/20171229144429343?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>如上图红色部分，负责完成设备：功率管理、链路质量管理、链路控制管理、数据分组管理、链路安全管理。</p>
<h4 id="1、链路管理协议数据单元"><a href="#1、链路管理协议数据单元" class="headerlink" title="1、链路管理协议数据单元"></a>1、链路管理协议数据单元</h4><p>蓝牙链路管理器接收到高层的控制信息后，不是向自身的基带部分分发控制信息，就是与另一台设备的链路管理器进行协商管理。这些控制信息封装在链路管理协议数据单元LMP_PDU中，由ACL分组的有效载荷携带。</p>
<h4 id="2、链路管理器协议规范"><a href="#2、链路管理器协议规范" class="headerlink" title="2、链路管理器协议规范"></a>2、链路管理器协议规范</h4><p><strong>（1）、设备功率管理</strong><br>         RSSI保持模式、呼吸模式、休眠模式。<br><strong>（2）、链路质量管理 QoSQuality of Service</strong><br>    A、ACL链路。<br>    B、SCO链路。<br><strong>（3）、链路控制管理</strong><br>    设备寻呼模式、设备角色转换、时钟计时设置、信息交换:版本信息、支持特性、设备名称；建立连接、链路释放。<br><strong>（4）、数据分组管理</strong></p>
<p>传送门：<br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78414870" target="_blank" rel="external">（一）蓝牙的概述</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932321" target="_blank" rel="external">（二）蓝牙协议规范（射频、基带链路控制、链路管理）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932372" target="_blank" rel="external">（三）蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932616" target="_blank" rel="external">（四）蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）</a></p>
<p><a href="http://blog.csdn.net/xubin341719" target="_blank" rel="external">引用自xubin的博客</a></p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/11/01/BluetoothForAndroid1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/01/BluetoothForAndroid1/" itemprop="url">
                  Android 端蓝牙模块的开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-01T17:31:58+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android蓝牙/" itemprop="url" rel="index">
                    <span itemprop="name">Android蓝牙</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###背景<br>因为可穿戴设备等硬件设备的兴起，蓝牙模块的开发已经成为大多数移动开发者必备的技能。<br>这段时间由于业务需求，花了一阵子的时间在研究蓝牙模块的传输。也整理了一些相关的经验拿出来分享给大家。</p>
<h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><p>在此过程中需要大家先了解一下，在蓝牙开发过程中经常碰到的名词。BLE,SPP,OPP等。</p>
<ol>
<li>BLE（Bluetooth Low Energy）——蓝牙低功耗技术，这是蓝牙4.0推出的一个低功耗蓝牙部分。低功耗蓝牙适用于实时性要求比较高，但是数据速率比较低的产品，如遥控类的，如鼠标，键盘，遥控鼠标(Air Mouse)，传感设备的数据发送，如心跳带，血压计，温度传感器等。</li>
<li>SPP（Serial Port Profile）—— SPP为蓝牙串口传输协议，能在蓝牙设备之间创建串口进行数据传输的协议。蓝牙串口的目的是针对如何在两个不同设备（通信的两端）上的应用之间保证一条完整的通信路径。<br> 当然SSP还有另外一个名词，简单配对模式(Secure Simple Pairing).</li>
<li>OPP（Object push profile） 面向对象传输协议，用于文件文件传输。</li>
<li>HFP (Hands-free Profile) HFP(Hands-free Profile)，让蓝牙设备可以控制电话，如接听、挂断、拒接、语音拨号等，拒接、语音拨号要视蓝牙耳机及电话是否支持</li>
</ol>
<p>更多蓝牙协议可以到<a href="http://blog.csdn.net/guoxiaolongonly/article/details/78414870" target="_blank" rel="external">蓝牙协议介绍</a><br>大家可以根据需求选择相应的功能做开发。<br>代码还在github上，有时间继续整理~~  囧~ 这里会把ble和普通蓝牙spp,文件传输 opp开发做整理。</p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/11/01/BluetoothForAndroid2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/01/BluetoothForAndroid2/" itemprop="url">
                  蓝牙协议学习整理（一）蓝牙的概述
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-01T15:45:51+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android蓝牙/" itemprop="url" rel="index">
                    <span itemprop="name">Android蓝牙</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第一章-蓝牙的概述"><a href="#第一章-蓝牙的概述" class="headerlink" title="第一章 蓝牙的概述"></a>第一章 蓝牙的概述</h2><h3 id="一、蓝牙版本信息"><a href="#一、蓝牙版本信息" class="headerlink" title="一、蓝牙版本信息"></a>一、蓝牙版本信息</h3><p>蓝牙共有六个版本1.1/1.2/2.0/2.1/3.0/4.0</p>
<h4 id="1、1-1版本"><a href="#1、1-1版本" class="headerlink" title="1、1.1版本"></a>1、1.1版本</h4><p>传输率约在748~810kb/s，因是早期设计，容易受到同频率之产品所干扰下影响通讯质量。</p>
<h4 id="2、1-2版本"><a href="#2、1-2版本" class="headerlink" title="2、1.2版本"></a>2、1.2版本</h4><p>同样是只有748~810kb/s 的传输率，但在加上了(改善 Software)抗干扰跳频功能。</p>
<h4 id="3、2-0-EDR版本"><a href="#3、2-0-EDR版本" class="headerlink" title="3、2.0+EDR版本"></a>3、2.0+EDR版本</h4><p>是1.2的改良提升版，传输率约在1.8M/s~2.1M/s，开始支持双工模式——即一面作语音通讯，同时亦可以传输档案/高质素图片，2.0 版本当然也支持 Stereo 运作。</p>
<p>应用最为广泛的是Bluetooth2.0+EDR标准，该标准在2004年已经推出，支持Bluetooth 2.0+EDR标准的产品也于2006年大量出现。虽然Bluetooth 2.0+EDR标准在技术上作了大量的改进，但从1.X标准延续下来的配置流程复杂和设备功耗较大的问题依然存在。</p>
<h4 id="4、2-1版本"><a href="#4、2-1版本" class="headerlink" title="4、2.1版本"></a>4、2.1版本</h4><p>更佳的省电效果：蓝牙2.1版加入了SniffSubrating的功能，透过设定在2个装置之间互相确认讯号的发送间隔来达到节省功耗的目的。</p>
<h4 id="5、3-0-HS版本"><a href="#5、3-0-HS版本" class="headerlink" title="5、3.0+HS版本"></a>5、3.0+HS版本</h4><p>2009年4月21日，蓝牙技术联盟(Bluetooth SIG)正式颁布了新一代标准规范”Bluetooth Core Specification Version 3.0 High Speed”(蓝牙核心规范3.0版 )，蓝牙3.0的核心是”GenericAlternate MAC/PHY”(AMP)，这是一种全新的交替射频技术，允许蓝牙协议栈针对任一任务动态地选择正确射频。最初被期望用于新规范的技术包括802.11以及UMB，但是新规范中取消了UMB的应用。</p>
<h4 id="6、4-0-版本"><a href="#6、4-0-版本" class="headerlink" title="6、4.0 版本"></a>6、4.0 版本</h4><p>蓝牙4.0包括三个子规范，即传统蓝牙技术、高速蓝牙和新的蓝牙低功耗技术。蓝牙 4.0的改进之处主要体现在三个方面，电池续航时间、节能和设备种类上。拥有低成本，跨厂商互操作性，3毫秒低延迟、100米以上超长距离、AES-128加密等诸多特色此外，蓝牙4.0的有效传输距离也有所提升。3.0版本的蓝牙的有效传输距离为10米(约 32英尺)，而蓝牙4.0的有效传输距离最高可达到100米(约328英尺)。</p>
<h4 id="7、典型蓝牙与BLE蓝牙对比"><a href="#7、典型蓝牙与BLE蓝牙对比" class="headerlink" title="7、典型蓝牙与BLE蓝牙对比"></a>7、典型蓝牙与BLE蓝牙对比</h4><p><img src="http://img.blog.csdn.net/20171229112207537?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="蓝牙与BLE对比"></p>
<h3 id="二、蓝牙的技术特点"><a href="#二、蓝牙的技术特点" class="headerlink" title="二、蓝牙的技术特点"></a>二、蓝牙的技术特点</h3><p>简单地说，蓝牙是一种短程宽带无线电技术，是实现语音和数据无线传输的全球开放性标准。它使用跳频扩谱（FHSS）、时分多址（TDMA）、码分多址（CDMA）等先进技术，在小范围内建立多种通信与信息系统之间的信息传输。</p>
<h4 id="1、Bluetooth的主要技术特点："><a href="#1、Bluetooth的主要技术特点：" class="headerlink" title="1、Bluetooth的主要技术特点："></a>1、Bluetooth的主要技术特点：</h4><p><strong>（1）、工作频段</strong> ：2.4GHz的工科医（ISM）频段，无需申请许可证。大多数国家使用79个频点，载频为(2402+k)MHz（k=0，1, 2…78），载频间隔1MHz。采用TDD时分双工方式。<br><strong>（2）、传输速率</strong>：1Mb/s（V2.0以上版本）<br><strong>（3）、调试方式</strong>：BT=0.5的GFSK调制，调制指数为0.28-0.35。<br><strong>（4）、采用跳频技术</strong>：跳频速率为1600跳/秒，在建链时（包括寻呼和查询）提高为3200跳/秒。蓝牙通过快跳频和短分组技术减少同频干扰，保证传输的可靠性。<br><strong>（5）、语音调制方式</strong>：连续可变斜率增量调制（CVSD，ContinuousVariable Slope Delta Modulation），抗衰落性强，即使误码率达到4%，话音质量也可接受。<br><strong>（6）、支持电路交换和分组交换业务</strong>：蓝牙支持实时的同步定向联接（SCO链路）和非实时的异步不定向联接（ACL链路），前者主要传送语音等实时性强的信息，后者以数据包为主。语音和数据可以单独或同时传输。蓝牙支持一个异步数据通道，或三个并发的同步话音通道，或同时传送异步数据和同步话音的通道。每个话音通道支持64kbps的同步话音；异步通道支持723.2/57.6kbps的非对称双工通信或433.9kbps的对称全双工通信。<br><strong>（7）、支持点对点及点对多点通信</strong>：蓝牙设备按特定方式可组成两种网络：微微网(Piconet)和分布式网络(Scatternet)，其中微微网的建立由两台设备的连接开始，最多可由八台设备组成。在一个微微网中，只有一台为主设备（Master），其它均为从设备（Slave），不同的主从设备对可以采用不同的链接方式，在一次通信中，链接方式也可以任意改变。几个相互独立的微微网以特定方式链接在一起便构成了分布式网络。所有的蓝牙设备都是对等的，所以在蓝牙中没有基站的概念。<br><strong>（8）、工作距离</strong>：蓝牙设备分为三个功率等级，分别是：100mW（20dBm）、2.5mW（4dBm）和1mW（0dBm），相应的有效工作范围为：100米、10米和1米。</p>
<h3 id="三、Bluetooth的系统构成"><a href="#三、Bluetooth的系统构成" class="headerlink" title="三、Bluetooth的系统构成"></a>三、Bluetooth的系统构成</h3><p><img src="http://img.blog.csdn.net/20171229113217333?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="构成"></p>
<h4 id="1、无线射频单元-Radio-："><a href="#1、无线射频单元-Radio-：" class="headerlink" title="1、无线射频单元(Radio)："></a>1、无线射频单元(Radio)：</h4><p>负责数据和语音的发送和接收，特点是短距离、低功耗。蓝牙天线一般体积小、重量轻，属于微带天线。</p>
<h4 id="2、基带或链路控制单元-LinkController-："><a href="#2、基带或链路控制单元-LinkController-：" class="headerlink" title="2、基带或链路控制单元(LinkController)："></a>2、基带或链路控制单元(LinkController)：</h4><p>进行射频信号与数字或语音信号的相互转化，实现基带协议和其它的底层连接规程。</p>
<h4 id="3、链路管理单元-LinkManager-："><a href="#3、链路管理单元-LinkManager-：" class="headerlink" title="3、链路管理单元(LinkManager)："></a>3、链路管理单元(LinkManager)：</h4><p>负责管理蓝牙设备之间的通信，实现链路的建立、验证、链路配置等操作。</p>
<h4 id="4、蓝牙软件协议实现："><a href="#4、蓝牙软件协议实现：" class="headerlink" title="4、蓝牙软件协议实现："></a>4、蓝牙软件协议实现：</h4><p>如上图紫色部分，这个后面我们做详细说明。<br><img src="http://img.blog.csdn.net/20171229113418020?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="四、蓝牙协议规范"><a href="#四、蓝牙协议规范" class="headerlink" title="四、蓝牙协议规范"></a>四、蓝牙协议规范</h3><p>传输协议、中介协议、应用协议；</p>
<h4 id="1、传输协议"><a href="#1、传输协议" class="headerlink" title="1、传输协议"></a>1、传输协议</h4><p>负责蓝牙设备间，互相确认对方的位置，以及建立和管理蓝牙设备间的物理链路；</p>
<ul>
<li><p>底层传输协议：蓝牙射频（Radio）部分、基带链路管理控制器（Baseband&amp;Link Controller）、链路管理协议（Link ManagerProtocol LMP）。负责语言、数据无线传输的物理实现以及蓝牙设备间的联网组网。</p>
</li>
<li><p>高层传输协议：逻辑链路控制与适配器（LogicalLink Control and Adaptation Protocol）L2CAP 、主机控制接口（HostControl Interface，HCI）。为高层应用屏蔽了跳频序列选择等底层传输操作，为高层程序提供有效、有利于实现数据分组格式。</p>
</li>
</ul>
<h4 id="2、中介协议"><a href="#2、中介协议" class="headerlink" title="2、中介协议"></a>2、中介协议</h4><p>为高层应用协议或者程序，在蓝牙逻辑链路上工作提供必要的支持，为应用提供不同标准接口。</p>
<ul>
<li>串口仿真协议：RFCOMM、服务发现协议：SDP、互操作协议IrDA、网络访问协议：PPP、IP、TCP、UDP、电话控制协议：TCS、AT指令集。</li>
</ul>
<p><img src="http://img.blog.csdn.net/20171229114202004?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h4 id="3、应用协议"><a href="#3、应用协议" class="headerlink" title="3、应用协议"></a>3、应用协议</h4><p>蓝牙协议栈之上的应用软件和所涉及到的协议，如：拨号上网、语言功能的应用程序。</p>
<p>蓝牙的应用框架如下：</p>
<ol>
<li>通用应用类框架：查询、建立连接服务等；</li>
<li>蓝牙电话应用类框架：电话控制、语言；</li>
<li>蓝牙连网应用类框架：网络应用相关；</li>
<li>对象交互服务类框架：IrDA、OBEX；</li>
<li>蓝牙音视频控制类框架。</li>
</ol>
<h3 id="五、硬件接口"><a href="#五、硬件接口" class="headerlink" title="五、硬件接口"></a>五、硬件接口</h3><p>一般蓝牙芯片通过UART、USB、SDIO、I2S、PcCard和主控芯片通信。如下图所示，通过UART和主控芯片通信。<br><img src="http://img.blog.csdn.net/20171229114547261?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ3VveGlhb2xvbmdvbmx5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>传送门：<br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78414870" target="_blank" rel="external">（一）蓝牙的概述</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932321" target="_blank" rel="external">（二）蓝牙协议规范（射频、基带链路控制、链路管理）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932372" target="_blank" rel="external">（三）蓝牙协议规范（HCI、L2CAP、SDP、RFOCMM）</a><br><a href="http://blog.csdn.net/guoxiaolongonly/article/details/78932616" target="_blank" rel="external">（四）蓝牙协议规范（irOBEX、BNEP、AVDTP、AVCTP）</a><br><a href="http://blog.csdn.net/xubin341719" target="_blank" rel="external">引用自xubin的博客</a></p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/09/30/Ticket/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/30/Ticket/" itemprop="url">
                  Android端的彩票开奖查询系统
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-30T11:02:46+08:00">
                2017-09-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/个人开源/" itemprop="url" rel="index">
                    <span itemprop="name">个人开源</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="实现如下"><a href="#实现如下" class="headerlink" title="实现如下"></a>实现如下</h1><p><a href="https://github.com/xiaolongonly/Ticket-Analysis/blob/master/operate.gif" target="_blank" rel="external">假装插入了图片</a><br>初版历时半个多月</p>
<h2 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h2><ol>
<li><p>开奖结果查询</p>
<ul>
<li>近期开奖查询</li>
<li>历史开奖查询（最多五十期）</li>
</ul>
</li>
<li><p>关注彩种</p>
</li>
<li>一些简单的趋势分析</li>
<li>号码预测（号码预测做的比较简单，直接算出每个号码的多期平均值，和期望平均值做对比。取均值。理论上应该是范围内的都是概率发生的，这一块其实可以加入奇偶频率，号码频率，和一些其他的条件来做预测，后面会继续做优化）</li>
<li>接口原因，能用到的接口只有四个。 自己编写了规则文档。还有一些其他必要的功能。</li>
<li>最后面想说的是这里其实更需要一个后台来爬取数据做动态更新。（打算写一个后台和爬虫来搞）</li>
</ol>
<h1 id="设计意图"><a href="#设计意图" class="headerlink" title="设计意图"></a>设计意图</h1><p>设计意图来自身边的朋友，对这一块投注存在的需求。</p>
<h3 id="随机组合出所有可能再做筛选，然后投注"><a href="#随机组合出所有可能再做筛选，然后投注" class="headerlink" title="随机组合出所有可能再做筛选，然后投注"></a>随机组合出所有可能再做筛选，然后投注</h3><p>起初有个朋友让我帮忙写一个体育彩票36选7三个数字固定，其余数字随机的可能结果，然后动了一下脑子想了一下，<br>这些数据有<br>(33 X 32 X 31 X 30)/(4 X 3 X 2 X 1) = 40920种，<br>如果整组号码随机组合的结果有<br>(36 X 35 X 34 X 32 X 31 X 30)/(7 X 6 X 5 X 4 X 3 X 2 X 1) = 8347680种<br>由此可见其中大奖概率是很低的</p>
<p>特等奖(7)  中奖概率为 概率公式打不出来((C7 7) / (C36 7)) = 1/8347680 (全复式共1注)</p>
<p>一等奖(6+1)  (((C8 7) *(C28 0)-(C7 7))/(C36 7)) = 1/1192526（全复式共7注）</p>
<p>二等奖(6)   1/42590(全复式共中196注)</p>
<p>三等奖(5+1) 1/14197(全复式共中588注)</p>
<p>四等奖(5)   1/1052(全复式共中7938注)</p>
<p>五等奖(4+1) 1/631(全复式共中13230注)</p>
<p>六等奖(4)   1/73(全复式共中114660注)</p>
<p>无奖(3+1)   1/73（全复式共中114660注）</p>
<p>无奖(3)     1/12（全复式共中716625注）</p>
<p>无奖(2+1)   1/19（全复式共中429975注）</p>
<p>无奖(2)     1/4（全复式共中2063880注）</p>
<p>无奖(1+1)   1/12（全复式共中687960注）</p>
<p>无奖(1)     1/3（全复式共中2637180注）</p>
<p>无奖(0+1)   1/22（全复式共中376740注）</p>
<p>下面给出这类彩票的中奖概率计算公式</p>
<p>n个全是正选号码：<a href="https://github.com/xiaolongonly/Ticket-Analysis/blob/master/7.png" target="_blank" rel="external">image</a></p>
<p>n个正选加一个特别号码：<a href="https://github.com/xiaolongonly/Ticket-Analysis/blob/master/6%2B1.png" target="_blank" rel="external">image</a> - <a href="https://github.com/xiaolongonly/Ticket-Analysis/blob/master/7.png" target="_blank" rel="external">image</a></p>
<p>想起了我大学的时候的概率统计，学概率统计的时候老师就说过了，赌博（指合法的彩票这类的），还有保险这个行业，基本上都能从概率学来计算，而且如果仔细算一下这里面的概率，就能发现这些都是非常暴利的行业。好吧，没研究过体彩的盈利手段，可能都是从税上面征的。而保险其实如果有经过大规模的数据分析的话，是可以知道赔保的概率很低，所以基本上买保险的人数乘以保险额会远远大于预估出来的全部需要出险的赔偿额的，剩下的都是利润利润。<br>如果从心理学上面来讲的话，买保险大家都是图个心安，买彩票则是赌。不禁感叹人类果然智慧无限，对这两类人群都做了细致的划分和业务推销..扯远了扯远了..</p>
<p>回归正题吧，可见如果要买到所有号码可能就血本无归了，基本是赢不了啦。</p>
<p>在聊下这个朋友，这个朋友后面需要我帮忙演算一下多期开奖结果的均值，也就是一万期，十万期…甚至几千万期之后的开奖均值，模拟演算了一下36选7一千万组数据的均值大概在129.495左右。</p>
<h3 id="靠近均值附近中奖的概率高"><a href="#靠近均值附近中奖的概率高" class="headerlink" title="靠近均值附近中奖的概率高"></a>靠近均值附近中奖的概率高</h3><p>理论上来讲既然均值是这个值，如果能通过数据证明大多数的开奖数据都会比较接近这个均值，就是分布概率会在均值附近，是不是就能证明往靠近均值的地方买彩票中奖率会高一些。<br>算一下最小值 1+2+3+4+5+6+7=28   最大值 30+31+32+33+34+35+36=241这些都只有一组，而越往中间，选择越多如果是 30的话就可以1+2+3+4+5+6+9/1+2+3+4+5+7+8 ..是有这个趋势的。不过从另外一个维度分析，正因为均值区域概率太大，在这一块的组合也多，也就是说在改区域块的中奖概率也跟这里面的组合数是一致的。最终结果还是每个开奖的概率都相等，成功把自己扳倒了…</p>
<h3 id="如果每个号码的开奖概率相同，那么买出现概率最低的码是不是就能中奖"><a href="#如果每个号码的开奖概率相同，那么买出现概率最低的码是不是就能中奖" class="headerlink" title="如果每个号码的开奖概率相同，那么买出现概率最低的码是不是就能中奖"></a>如果每个号码的开奖概率相同，那么买出现概率最低的码是不是就能中奖</h3><p>想起小时候，跟朋友玩猜大小游戏的时候如果小的次数开多了，他们就会一直猜大，甚至加注猜大，坐庄的我每次都被搞的慌的要死，虽然知道大小概率还是50%，但也没办法，因为确实是很邪门的一件事情。</p>
<p>在一千万组数据下来的时候会发现，每一个号码的开奖次数都是接近相等的，现在假设我有（1-10） 10个号码，10选1，一千期内出现的概率为  100次 102次 105 次 98次 95次 93次 112次 88次 97次 94次 96次，根据期数多了每个号码开奖概率会趋于相等的原理，如果一直买 88次的是不是就稳赢了，好吧，如果学过概率统计就知道独立事件是互不影响的。不要想太多。更何况36/7的组合想要不让最低号码全中奖一直到开奖概率平均也是能做到的。</p>
<h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>帮朋友做了这两个应用之后，开始研究这方面的需求，感觉现在的市场确实会有这方面的分析需求。<br>那我要做些什么功能来满足他们呢。</p>
<p>1.求平均，不管是35/7 ,22/5或是其他 做一个千万把求平均的功能（已完成，仅支持，不重复，无颜色随机）</p>
<p>2.随机摇号 做一个随机摇号的功能，当然生成数量有限 (已完成)</p>
<p>3.最重要的功能，开奖结果查询，将每一种彩票的开奖结果罗列出来。(已完成)</p>
<p>4.开奖结果分析，用折线图来展示开奖结果，比如说多期内同一个号码的开奖次数统计（已完成）</p>
<p>5.每一期的平均统计等 （已完成）</p>
<p>6.其他 （号码收藏后期会添加）</p>
<p>项目<a href="https://github.com/xiaolongonly/Ticket-Analysis" target="_blank" rel="external">github地址</a></p>
<p><strong><em>By Xiaolong：每一天都值得被认真对待! </em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/08/09/AndroidPdfViewer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/09/AndroidPdfViewer/" itemprop="url">
                  AndroidPdf框架一览（一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-09T14:59:45+08:00">
                2017-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android第三方/" itemprop="url" rel="index">
                    <span itemprop="name">Android第三方</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>本章会讲四种可以在Android端使用的pdf框架，并介绍其优势和劣势。</p>
<p>###（1）android-pdfview</p>
<p>第一个当然是github上面star 最多<a href="https://github.com/JoanZapata/android-pdfview" target="_blank" rel="external">android-pdfview</a>，它是基于谷歌的一款开源PDF浏览框架<a href="https://code.google.com/archive/p/vudroid/" target="_blank" rel="external">VuDroid</a>封装的Android端框架，<br>支持缩略图，缩放，页面枚举，默认起始页。还有pdf加载监听，pdf页面滑动监听。<br>功能很强大，不过很可惜，功能有限，作者也在15年停止了维护。</p>
<p>###（2）pdfium</p>
<p><a href="https://pdfium.googlesource.com/pdfium/" target="_blank" rel="external">pdfium</a>是谷歌开源的一款高性能的PDF渲染组件，用来作Chrome内核的pdf渲染。支持pdf加密文件打开，支持获取pdf文档信息，作者，标题，副标题，创建日期等…可以将指定的pdf页面渲染成bitmap，这个框架足以实现基本所有pdf定制化操作。美中不足的是框架比较大，对于移动端的包压缩是一个挑战</p>
<p>###（3）mupdf<br><a href="https://mupdf.com/" target="_blank" rel="external">mupdf</a>是一款轻量级的pdf浏览框架，基本上支持前面两者的功能，如果是文本的pdf文档还支持搜索，标注等功能。当之无愧的强大。虽说轻量，但编译出来的so库也不小。</p>
<p>###（4）Android原生<br>Android在API19提供了<a href="https://developer.android.com/reference/android/graphics/pdf/PdfRenderer.html" target="_blank" rel="external">android.graphics.pdf</a> 这个pdf管理库，主要提供两个类pdfRender 和pdfDocument，pdfdocument 是将View转成pdf文件（require API19），pdfRender是将pdf文件绘制到bitmap上(require API21)，这个就是原生提供的pdf浏览框架,但因为API要求很容易被拒之门外，不过随着API迭代，以后可能就无所谓了。</p>
<h3 id="2-四者做一下对比"><a href="#2-四者做一下对比" class="headerlink" title="2.四者做一下对比"></a>2.四者做一下对比</h3><p>因为所有的框架都是将pdf转成图片做展示，所以定制化自己都能实现，那在这里这边对四者做一下对比。  这边的信息查看指pdf创建信息，大小指so库大小</p>
<table>
<thead>
<tr>
<th>框架名称</th>
<th>支持信息查看</th>
<th>支持文本检索</th>
<th>API要求</th>
<th>原始/打包后大小</th>
</tr>
</thead>
<tbody>
<tr>
<td>VuDroid</td>
<td>false</td>
<td>false</td>
<td>API16 or lower</td>
<td>19M-&gt;6.7M</td>
</tr>
<tr>
<td>pdfium</td>
<td>true</td>
<td>false</td>
<td>API16 or lower</td>
<td>30M-&gt;15.3M</td>
</tr>
<tr>
<td>mupdf</td>
<td>true</td>
<td>true</td>
<td>API16 or lower</td>
<td>70.2-&gt;36.6M</td>
</tr>
<tr>
<td>PdfRenderer</td>
<td>false</td>
<td>false</td>
<td>API21</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>总结：mupdf功能最强大，pdfium次之，VuDroid和PdfRender都差不多。<br>但因为PdfRender有API限制。mupdf库有点大，所以大家根据需求来选择。</p>
<h3 id="3-源码和Demo"><a href="#3-源码和Demo" class="headerlink" title="3.源码和Demo"></a>3.源码和Demo</h3><p><a href="https://code.google.com/archive/p/vudroid/" target="_blank" rel="external">VuDroid源码</a></p>
<p><a href="https://github.com/JoanZapata/android-pdfview" target="_blank" rel="external">VuDroidDemo下载地址</a></p>
<p><a href="https://pdfium.googlesource.com/pdfium/" target="_blank" rel="external">pdfium源码</a></p>
<p><a href="https://github.com/xiaolongonly/PDFiumForAndroidDemo" target="_blank" rel="external">pdfiumDemo下载地址</a><br>//写的并不是很好，正在看其他的开源框架思考更好的封装思路ing~~~<br><a href="https://mupdf.com/" target="_blank" rel="external">mupdf源码</a> </p>
<p><a href="https://github.com/xiaolongonly/MuPdfForAndroid" target="_blank" rel="external">mupdfDemo下载地址</a> </p>
<p><a href="https://developer.android.com/reference/android/graphics/pdf/PdfRenderer.html" target="_blank" rel="external">PdfRendererWiki</a> </p>
<p><a href="https://github.com/googlesamples/android-PdfRendererBasic" target="_blank" rel="external">PdfRenderer下载地址</a></p>
<p><strong><em>By Xiaolong,每一天都值得被认真对待！</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2017/07/20/Introspection 2017-07-20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/lucky.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/20/Introspection 2017-07-20/" itemprop="url">
                  自省
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-20T20:33:17+08:00">
                2017-07-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/阶段性总结/" itemprop="url" rel="index">
                    <span itemprop="name">阶段性总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="想离职却又变心的自己"><a href="#想离职却又变心的自己" class="headerlink" title="想离职却又变心的自己"></a>想离职却又变心的自己</h3><p>最近下班时间都在玩游戏，基本没怎么花时间反思最近的自己，现在做一下阶段总结。在这家公司待了三个多月了，最直观的感受是在这边基本上没人能带着你工作，手头的项目也都是我一个人在做，先后做了一个离线版的应用还有另外一个面向企业的应用的改版。在这期间也遇到了很多问题，一步一步克服了，但总的感觉最近的生活太安逸。之前一段时间还有想要离开这里去外地城市发展的想法，后来想想自己的技术尚浅，在加上已经换了两家公司了，决定还是先在这边多做学习。</p>
<h3 id="代码与我"><a href="#代码与我" class="headerlink" title="代码与我"></a>代码与我</h3><p>我觉得大多数程序员的梦想就是能写出很优雅的代码，能造出好用的轮子，我也是千千万万普通程序猿中的一员，也拥有着和他们一样的想法，我当初选择软件工程的原因是：我想成为一名很厉害的黑客，</p>
<blockquote>
<p>因为在高中期间，无意中得到了一份易语言的邮件发送代码，然后就用这个做了好多盗QQ号软件，其实是很简单的，因为就一个用户界面让用户自愿输入帐号密码，然后把帐号密码发送到我的邮箱，那时候一天能盗几百个号，我记得最蠢的事情是我把帐号列表post在空间，然后有人问我为什么他的帐号在上面，想想真是尴尬。不过这些好玩的东西现在都做不了了。</p>
</blockquote>
<p>只要有一台电脑在面前就能操控很多东西能做很多事情。事实是我太天真了。上了大学第一个学期的课的时候我的梦想就破灭了。哈哈，因为发现C++居然写的是控制台，不带图形界面的。我这个职业拉控件，写写忽悠人的软件的小朋友，眉头一皱，发现黑客并不是那么简单。大学总算过来了， 虽然算不上班级中的佼佼者，但是还是带着大多数同学完成了课程设计。<br>大一写的好像是黑杰克，控制台界面，PC跟玩家对战，PC毫无智商可言，233，只要牌小于15就会加牌，随机分牌，<br>大二软件工程用C#写的<a href="http://download.csdn.net/download/guoxiaolongonly/8292765" target="_blank" rel="external">家庭财务管理系统</a>（就一个GridView带统计功能），Java课程用Java写了<a href="http://download.csdn.net/download/guoxiaolongonly/8292775" target="_blank" rel="external">俄罗斯方块</a>。C#课程C#写了一个<a href="http://download.csdn.net/download/guoxiaolongonly/8292809" target="_blank" rel="external">写字板</a>的应用，跟着老师一步一步写的。自己写的并不多，自己也是刷过ACM做过各种好玩的<a href="http://download.csdn.net/download/guoxiaolongonly/8739163" target="_blank" rel="external">算法</a>的。</p>
<p>大二下的J2EE，用strut2+hibernate写了个<a href="http://download.csdn.net/download/guoxiaolongonly/8920765" target="_blank" rel="external">博客系统</a>。实现了基本增删改查操作。</p>
<p>大三：现代算法课写了护士排班，虽然我到现在也不明白，遗传算法和模拟退火算法的这些数据基数是怎么来的。</p>
<blockquote>
<p>最开始我弄了一部分基准数据在里面，然后让遗传值无限接近这个基准，那其实我觉得算法应该是一次一次输入数据一次比一次更准确，因为有对前面数据的统计。所以我的算法是错误的，分数不高。坑爹的是我把这份代码送了班级的另一名同学，结果他拿了比我还高的分数。</p>
</blockquote>
<p>大三：Andorid课程设计，<a href="http://download.csdn.net/download/guoxiaolongonly/8920793" target="_blank" rel="external">五子棋人机对战版</a>，那时候本来想写蓝牙对战，但是感觉难度蛮高，虽然也有demo实现，但是没有去做参考。人工智能：五子棋AI，一份网上参考的代码，打败了全班的小伙伴。带着我们小组成了第一名。基于极大极小搜索算法和剪枝优化策略下的五子棋算法，跟上面那个一样。</p>
<p>大四：大四的话基本没怎么做事情了，那时候设计模式课程设计拿的是比赛的项目，和小伙伴们参加了比赛，边比赛边创业。那时候的<a href="http://android.myapp.com/myapp/detail.htm?apkName=com.duopai" target="_blank" rel="external">朵拍</a>。拿了奖，入驻了众创空间，可能那就是离梦想最近的一次了。可是我们还是太年轻了。当然也是发现自身存在的不足和所需的技术实现难度，在毕业之前大家各自放弃了梦想，投入了工作。最后<a href="https://github.com/xiaolongonly/MyFinalSchoolExam" target="_blank" rel="external">毕业设计</a>，做的是一个移动端的任务发布平台，跟之前到位的功能有点像。用户可以在上面发任务，然后，接单的用户可以私下与其接洽，大致如此。提供地图标记和发布功能，提供聊天功能（WebSocket），提供用户有移动端和服务端。服务端用的是php一键式的~</p>
<p>写代码的日子总是这么有意思，其实我也仔细思考过写代码能做的最棒的事情是什么？就是，当有一天你已成家，有自己的孩子，你可以给你的孩子定制一些简单的小程序和游戏。我觉得这是一件超级幸福的事情，这就是写代码最幸福的追求吧。</p>
<p>那其实作为一个软件工程师职业，大多数人更想的是做出很好用的轮子，帮助很多初学的程序猿，让自己成为行业内知名的人物。</p>
<p>我觉得要做到这些，无异于就以下几点，首先要热爱自己的职业，其次是需要花时间在里面，搜罗各种资源让自己成长。在其次就是多思考，多创新。现在我也在朝这一目标往前走。</p>
<p>在前面一段时间我学习Andorid的资源都是来自网上，各种教学视频，各种各样的论坛博客，还有代码仓库。这边学一点，那边学一点，到最后将零零散散的知识拼凑到一起，勉勉强强能应付工作，但是遇到一些更深入的细节问题往往都不知道答案，很多时候我都知道，这里就是需要这么写，但是为什么需要这么写，自己从未去深入探究，<br>在这半年，我开始发现阅读一些有用的框架源码能发现一些很有意思的设计模式，还有一些优质的设计思想，我才发现自己当初真的算初学Java，入门的Andorid。</p>
<p>我觉得做一行开发，确实需要系统的去学习，我以前看的过郭霖的第一行代码，以为自己真正了解Android开发了，却没发现那本只是入门书籍。往里面还有很多路要走，现在我开始看中级进阶的书籍了。以前对开发都只是知道皮毛，没有深入去探究，现在终于可以通过学习把那些零散的点一点一点的拼凑起来，希望自己最终能实现自己的梦想吧。</p>
<h3 id="自省"><a href="#自省" class="headerlink" title="自省"></a>自省</h3><p>曾经我以为我和大多数刚毕业的开发者不一样，我比他们拥有更强的技术，但是后面我才发现其实都是一样的，我也是那个搬着轮子瞎开心的程序猿，并没有比别人厉害，也不能做到一蹴而就，发现写代码这东西除非用心，除非花时间，除非热爱，除非有天分，很少有人能在短时间成为技术大牛的。</p>
<p>总之，未来还长，边学边往前走吧。</p>
<p><strong><em>By xiaolong：You have a dream,you got to protect it!</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/lucky.jpg"
               alt="小龙" />
          <p class="site-author-name" itemprop="name">小龙</p>
           
              <p class="site-description motion-element" itemprop="description">程序猿</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xiaolongonly" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/guoxiaolongonly" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-android"></i>
                  
                  CSDN
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小龙</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
