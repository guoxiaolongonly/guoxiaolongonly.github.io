<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="JSOUP爬虫," />










<meta name="description" content="爬虫教程第一篇，认识强大的java包JSOUP。接下来我来介绍一下Java爬虫，(ˉ﹃ˉ)我大Java依然这么强大，谁还敢鄙视我大Java~
嗯哼，刚刚说Java强大，其实Java强大在它的第三方库。每一个jar包都是某个Java开发者的劳动成果，当然每一个Java开发者都应该自豪，因为正是我们的付出让Java日益强大。接下来要讲的是一个非常强大的工具包JSOUP，java爬虫实现基本依赖于它！">
<meta property="og:type" content="article">
<meta property="og:title" content="java爬虫教程：JSOUP">
<meta property="og:url" content="http://rngift.com/2016/05/06/Reptile1/index.html">
<meta property="og:site_name" content="Xiaolong的个人博客">
<meta property="og:description" content="爬虫教程第一篇，认识强大的java包JSOUP。接下来我来介绍一下Java爬虫，(ˉ﹃ˉ)我大Java依然这么强大，谁还敢鄙视我大Java~
嗯哼，刚刚说Java强大，其实Java强大在它的第三方库。每一个jar包都是某个Java开发者的劳动成果，当然每一个Java开发者都应该自豪，因为正是我们的付出让Java日益强大。接下来要讲的是一个非常强大的工具包JSOUP，java爬虫实现基本依赖于它！">
<meta property="og:updated_time" content="2018-03-12T14:04:11.515Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="java爬虫教程：JSOUP">
<meta name="twitter:description" content="爬虫教程第一篇，认识强大的java包JSOUP。接下来我来介绍一下Java爬虫，(ˉ﹃ˉ)我大Java依然这么强大，谁还敢鄙视我大Java~
嗯哼，刚刚说Java强大，其实Java强大在它的第三方库。每一个jar包都是某个Java开发者的劳动成果，当然每一个Java开发者都应该自豪，因为正是我们的付出让Java日益强大。接下来要讲的是一个非常强大的工具包JSOUP，java爬虫实现基本依赖于它！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rngift.com/2016/05/06/Reptile1/"/>





  <title>java爬虫教程：JSOUP | Xiaolong的个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Xiaolong的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">每一天都值得被认真对待</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rngift.com/2016/05/06/Reptile1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaolong的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">java爬虫教程：JSOUP</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-06T22:53:53+08:00">
                2016-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java爬虫/" itemprop="url" rel="index">
                    <span itemprop="name">Java爬虫</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>爬虫教程第一篇，认识强大的java包JSOUP。<br>接下来我来介绍一下Java爬虫，(ˉ﹃ˉ)我大Java依然这么强大，谁还敢鄙视我大Java~</p>
<p>嗯哼，刚刚说Java强大，其实Java强大在它的第三方库。每一个jar包都是某个Java开发者的劳动成果，当然每一个Java开发者都应该自豪，因为正是我们的付出让Java日益强大。接下来要讲的是一个非常强大的工具包<a href="http://www.huqiwen.com/2012/05/03/use-jsoup-analytics-html-document/#" target="_blank" rel="external">JSOUP</a>，java爬虫实现基本依赖于它！</p>
<h3 id="一、Jsoup简介"><a href="#一、Jsoup简介" class="headerlink" title="一、Jsoup简介"></a>一、Jsoup简介</h3><p>在以往用java来处理解析HTML文档或者片段时，我们通常会采用<a href="http://htmlparser.sourceforge.net" target="_blank" rel="external">htmlparser</a>这个开源类库。现在我们有了JSOUP，以后的处理HTML的内容只需要使用JSOUP就已经足够了，JSOUP有更快的更新，更方便的API等。<br>jsoup 是一款 Java 的HTML 解析器，可直接解析某个URL地址、HTML文本内容。它提供了一套非常省力的API，可通过DOM，CSS以及类似于jQuery的操作方法来取出和操作数据，可以看作是java版的jQuery。<br>jsoup的主要功能如下：<br>从一个URL，文件或字符串中解析HTML；<br>使用DOM或CSS选择器来查找、取出数据；<br>可操作HTML元素、属性、文本；<br>jsoup是基于MIT协议发布的，可放心使用于商业项目。官方网站：<a href="http://jsoup.org/" target="_blank" rel="external">http://jsoup.org/</a></p>
<h3 id="二、解析遍历HTML文档"><a href="#二、解析遍历HTML文档" class="headerlink" title="二、解析遍历HTML文档"></a>二、解析遍历HTML文档</h3><p>Jsoup处理HTML文件是，是将用户输入的HTML文档，解析转换成一个Document对象进行处理。Jsoup一般支持以下几种来源内容的转换。</p>
<pre><code>1. 解析一个html字符串
2. 解析一个body片段
3. 根据一个url地址加载Document对象
4. 根据一个文件加载Document对象
</code></pre><h4 id="1-解析一个html字符串"><a href="#1-解析一个html字符串" class="headerlink" title="1.解析一个html字符串"></a>1.解析一个html字符串</h4><p>在处理一个html字符串。我们可能需要对其进行解析，并提取其内容，或校验其格式是否完整，或者想修改它。Jsoup可以帮助我们轻松的解决这些问题。<br>在Jsoup中有一个这样的静态方法Jsoup.parse(String html)，可以将我们的html片段转换成Document对象。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;div&gt;&lt;p align=\"center\"&gt;&lt;img alt=\"\" width=\"660\" height=\"852\" src=\"/erp/UserFiles/Image/51.jpg\" /&gt;这是P元素的内容&lt;/p&gt;"</span>;</div><div class="line">Document document = Jsoup.parse(html);</div></pre></td></tr></table></figure></p>
<p>使用上面的方法，就可以将html字符串，转换成Document对象，一旦有了Document对象，我们就可以使用其中适当的方法根据需求处理问题。我们可以看到这里转换的html片段并不是一个合法的html片段，里面的div标签没有闭合。这对于Jsoup来说不是问题，它可以很好的处理这类问题。</p>
<h4 id="2-解析body片段"><a href="#2-解析body片段" class="headerlink" title="2.解析body片段"></a>2.解析body片段</h4><p>假如我们现在有一个HTML片断 (比如. 一个 div 包含一对 p 标签; 一个不完整的HTML文档) 想对它进行解析。这个HTML片断可以是用户提交的一条评论或在一个CMS页面中编辑body部分。我们可以使用使用<a href="https://jsoup.org/apidocs/org/jsoup/Jsoup.html#parseBodyFragment(java.lang.String" target="_blank" rel="external">Jsoup.parseBodyFragment(String html)</a> 方法。<br>示例如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;div&gt;&lt;p align=\"center\"&gt;&lt;img alt=\"\" width=\"660\" height=\"852\" src=\"/erp/UserFiles/Image/51.jpg\" /&gt;这是P元素的内容&lt;/p&gt;"</span>;</div><div class="line">Document document = Jsoup.parseBodyFragment(html);</div></pre></td></tr></table></figure></p>
<p>看到这里可能会有疑问，这个和上面的html片段是一样的嘛。没错是一样的，parseBodyFragment 方法创建一个空壳的文档，并插入解析过的HTML到body元素中。假如使用正常的 Jsoup.parse(String html) 方法，通常也可以得到相同的结果，但是明确将用户输入作为 body片段处理，以确保用户所提供的任何糟糕的HTML都将被解析成body元素。</p>
<p><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Document.html#body(" target="_blank" rel="external">Document.body()</a> 方法能够取得文档body元素的所有子元素，与doc.getElementsByTag(“body”)相同。</p>
<h4 id="3-根据一个URL地址加载Document对象"><a href="#3-根据一个URL地址加载Document对象" class="headerlink" title="3.根据一个URL地址加载Document对象"></a>3.根据一个URL地址加载Document对象</h4><p>有时候我们可能希望通过一个url地址，然后提取里面的内容，转换成document对象。我们以前可能是使用http client等模拟一个请求，然后取得返回内容等，使用Jsoup方便简单的解决这个问题。示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Document document = Jsoup.connect(<span class="string">"http://www.baidu.com"</span>).get();</div><div class="line">String title = document.title();</div><div class="line">String text = document.text();</div></pre></td></tr></table></figure>
<p><a href="https://jsoup.org/apidocs/org/jsoup/Jsoup.html#connect(java.lang.String" target="_blank" rel="external">connect(String url)</a> 方法创建一个新的 <a href="https://jsoup.org/apidocs/org/jsoup/Connection.html" target="_blank" rel="external">Connection</a>, 和 <a href="https://jsoup.org/apidocs/org/jsoup/helper/HttpConnection.html#get(" target="_blank" rel="external">get()</a> 取得和解析一个HTML文件。如果从该URL获取HTML时发生错误，便会抛出 IOException，应适当处理。<br>Connection 接口还提供一个方法链来解决特殊请求，具体如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.connect(<span class="string">"http://test.com"</span>).data(<span class="string">"query"</span>, <span class="string">"Java"</span>).userAgent(<span class="string">"Mozilla"</span>).cookie(<span class="string">"auth"</span>, <span class="string">"token"</span>).timeout(<span class="number">3000</span>).post();</div></pre></td></tr></table></figure>
<p>可以向链接地址post参数，设置userAgent，cookie，timeout等，而且这里是采用的链接操作很方便（熟悉jQuery的应该很熟悉这样的链接操作）。</p>
<h4 id="4-根据文件加载document"><a href="#4-根据文件加载document" class="headerlink" title="4.根据文件加载document"></a>4.根据文件加载document</h4><p>有时候我们要处理的html内容，可能是存在硬盘上的某个文件里面，我们需要从中提取或者解析某些内容出来，我们可以通过Jsoup来这样处理。示例代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">File input = <span class="keyword">new</span> File(<span class="string">"d:/input.html"</span>);</div><div class="line">Document doc = Jsoup.parse(input, <span class="string">"UTF-8"</span>, <span class="string">"http://test.com/"</span>);</div></pre></td></tr></table></figure>
<p>看到这里可能有一个疑问，第一个参数是文件，第二是编码，第三个是什么呢?第三个参数是baseUrl，使用他我们可以方便的处理相对路径问题，如果不需要可以不传，这是一个多态方法，在前面的三个部分里面，都可以再加一个这样的baseUrl，后面会详细讲述。</p>
<h3 id="三、-数据抽取"><a href="#三、-数据抽取" class="headerlink" title="三、 数据抽取"></a>三、 数据抽取</h3><h4 id="1-使用Dom方法遍历文档"><a href="#1-使用Dom方法遍历文档" class="headerlink" title="1.使用Dom方法遍历文档"></a>1.使用Dom方法遍历文档</h4><p>通过第二章我们可以获取一个document的对象，我们可以通过这个对象来遍历文档，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.parse(input, <span class="string">"UTF-8"</span>, <span class="string">"http://test.com/"</span>);</div><div class="line">Element content = doc.getElementById(<span class="string">"content"</span>);</div><div class="line">Elements links = content.getElementsByTag(<span class="string">"a"</span>);</div><div class="line"><span class="keyword">for</span>(Element link : links) &#123;</div><div class="line">String linkHref = link.attr(<span class="string">"href"</span>);</div><div class="line">String linkText = link.text();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里我们可以方便的使用Doument对象的方法来获取内容。常用方法如下：</p>
<h5 id="查找元素"><a href="#查找元素" class="headerlink" title="查找元素"></a>查找元素</h5><ul>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementById(java.lang.String" target="_blank" rel="external">getElementById(String id)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByTag(java.lang.String" target="_blank" rel="external">getElementsByTag(String tag)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByClass(java.lang.String" target="_blank" rel="external">getElementsByClass(String className)</a></li>
<li><a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#getElementsByAttribute(java.lang.String" target="_blank" rel="external">getElementsByAttribute(String key)</a>(and related methods)</li>
<li>Element siblings: <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#siblingElements(" target="_blank" rel="external">siblingElements()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#firstElementSibling(" target="_blank" rel="external">firstElementSibling()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#lastElementSibling(" target="_blank" rel="external">lastElementSibling()</a>;<a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#nextElementSibling(" target="_blank" rel="external">nextElementSibling()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#previousElementSibling(" target="_blank" rel="external">previousElementSibling()</a></li>
<li>Graph: <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Node.html#parent(" target="_blank" rel="external">parent()</a>, <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Node.html#children(" target="_blank" rel="external">children()</a>), <a href="https://jsoup.org/apidocs/org/jsoup/nodes/Element.html#child(int" target="_blank" rel="external">child(int index)</a></li>
</ul>
<h5 id="元素数据"><a href="#元素数据" class="headerlink" title="元素数据"></a>元素数据</h5><ul>
<li><a href="https://jsoup.org/apidocs/org/jsoup/select/Elements.html#attr(java.lang.String" target="_blank" rel="external">attr(String key)</a>获取属性<a href="https://jsoup.org/apidocs/org/jsoup/select/Elements.html#attr(java.lang.String, java.lang.String" target="_blank" rel="external">attr(String key, String value)</a>设置属性</li>
<li>attributes()获取所有属性</li>
<li>id(), className() and classNames()</li>
<li>text()获取文本内容text(String value) 设置文本内容</li>
<li>html()获取元素内HTMLhtml(String value)设置元素内的HTML内容</li>
<li>outerHtml()获取元素外HTML内容</li>
<li>data()获取数据内容（例如：script和style标签)</li>
<li>tag() and tagName()</li>
</ul>
<h5 id="操作HTML和文本"><a href="#操作HTML和文本" class="headerlink" title="操作HTML和文本"></a>操作HTML和文本</h5><ul>
<li>append(String html), prepend(String html)</li>
<li>appendText(String text), prependText(String text)</li>
<li>appendElement(String tagName), prependElement(String tagName)</li>
<li>html(String value)</li>
</ul>
<h4 id="2-使用选择器来查找元素"><a href="#2-使用选择器来查找元素" class="headerlink" title="2.使用选择器来查找元素"></a>2.使用选择器来查找元素</h4><p>使用jQuery时，我们无不为其强大的选择器叹服，jsoup有同样的强大的选择器，可以方便我们的对文档进行处理。示例代码如下：<br>jsoup elements对象支持类似于CSS (或jquery)的选择器语法，来实现非常强大和灵活的查找功能。.<br>这个select 方法在Document, Element,或Elements对象中都可以使用。且是上下文相关的，因此可实现指定元素的过滤，或者链式选择访问。<br>Select方法将返回一个Elements集合，并提供一组方法来抽取和处理结果。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Elements links = doc.select(<span class="string">"a[href]"</span>); <span class="comment">//带有&lt;span style="text-decoration: underline;"&gt;href&lt;/span&gt;属性的a元素</span></div><div class="line">Elements pngs = doc.select(<span class="string">"img[src$=.png]"</span>);</div><div class="line"><span class="comment">//扩展名为.&lt;span style="text-decoration: underline;"&gt;png&lt;/span&gt;的图片</span></div><div class="line">Element masthead = doc.select(<span class="string">"div.masthead"</span>).first();</div><div class="line"><span class="comment">//class等于&lt;span style="text-decoration: underline;"&gt;masthead&lt;/span&gt;的&lt;span style="text-decoration: underline;"&gt;div&lt;/span&gt;标签</span></div><div class="line">Elements resultLinks = doc.select(<span class="string">"h3.r &gt; a"</span>); <span class="comment">//在h3元素之后的a元素</span></div></pre></td></tr></table></figure></p>
<p>jsoup elements对象支持类似于CSS (或jquery)的选择器语法，来实现非常强大和灵活的查找功能。.<br>这个select 方法在Document, Element,或Elements对象中都可以使用。且是上下文相关的，因此可实现指定元素的过滤，或者链式选择访问。<br>Select方法将返回一个Elements集合，并提供一组方法来抽取和处理结果。</p>
<h4 id="3-从元素中抽取属性和文档"><a href="#3-从元素中抽取属性和文档" class="headerlink" title="3.从元素中抽取属性和文档"></a>3.从元素中抽取属性和文档</h4><ul>
<li>使用Jsoup抽取属性，一般方法如下：</li>
<li>要取得一个属性的值，可以使用Node.attr(String key) 方法</li>
<li>对于一个元素中的文本，可以使用Element.text()方法</li>
<li>对于要取得元素或属性中的HTML内容，可以使用Element.html(), 或 Node.outerHtml()方法<br>示例如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">String html = <span class="string">"&lt;p&gt;An &lt;a href='http://example.com/'&gt;&lt;b&gt;example&lt;/b&gt;&lt;/a&gt; link.&lt;/p&gt;"</span>;</div><div class="line">Document doc = Jsoup.parse(html);<span class="comment">//解析HTML字符串返回一个Document实现</span></div><div class="line">Element link = doc.select(<span class="string">"a"</span>).first();<span class="comment">//查找第一个a元素&lt;/pre&gt;</span></div><div class="line">String text = doc.body().text(); <span class="comment">// "An example link"//取得字符串中的文本</span></div><div class="line">String linkHref = link.attr(<span class="string">"href"</span>); <span class="comment">// "http://example.com/"//取得链接地址</span></div><div class="line">String linkText = link.text(); <span class="comment">// "example""//取得链接地址中的文本&lt;/pre&gt;</span></div><div class="line">String linkOuterH = link.outerHtml();</div><div class="line"><span class="comment">// "&lt;a href="http://example.com"&gt;&lt;b&gt;example&lt;/b&gt;&lt;/a&gt;"</span></div><div class="line">String linkInnerH = link.html(); <span class="comment">// "&lt;b&gt;example&lt;/b&gt;"//取得链接内的html内容</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-URL处理"><a href="#4-URL处理" class="headerlink" title="4.URL处理"></a>4.URL处理</h4><p>我们在处理HTML内容时，可能经常会遇到这种问题，需要将html页面里面的链接地址从相对地址转换成绝对地址，jsoup有一个方法用来解决此问题。我们前面对到的baseurl，就是用来解决此问题的。示例代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Document doc = Jsoup.connect(<span class="string">"http://www.baidu.com/"</span>).get();</div><div class="line">Element link = doc.select(<span class="string">"a"</span>).first();</div><div class="line">String relHref = link.attr(<span class="string">"href"</span>); <span class="comment">// == "/"</span></div><div class="line">String absHref = link.attr(<span class="string">"abs:href"</span>);</div><div class="line"><span class="comment">// "http://www.baidu.com/gaoji/preferences.html"</span></div></pre></td></tr></table></figure></p>
<p>在HTML元素中，URLs经常写成相对于文档位置的相对路径： <a href="/download">…</a>. 当你使用 Node.attr(String key) 方法来取得a元素的href属性时，它将直接返回在HTML源码中指定定的值。<br>假如你需要取得一个绝对路径，需要在属性名前加 abs: 前缀。这样就可以返回包含根路径的URL地址attr(“abs:href”)<br>因此，在解析HTML文档时，定义base URI非常重要。如果你不想使用abs: 前缀，还有一个方法能够实现同样的功能 Node.absUrl(String key)。</p>
<h3 id="数据修改"><a href="#数据修改" class="headerlink" title="数据修改"></a>数据修改</h3><h4 id="1-设置属性值"><a href="#1-设置属性值" class="headerlink" title="1.设置属性值"></a>1.设置属性值</h4><p>在处理html时，我们有时候可能需要修改里面的属性值，如图片地址、class名称等各种属性。<br>可以使用属性设置方法 Element.attr(String key, String value), 和 Elements.attr(String key, String value).<br>假如你需要修改一个元素的 class 属性，可以使用 Element.addClass(String className) 和Element.removeClass(String className) 方法。<br>Elements 提供了批量操作元素属性和class的方法，比如：要为div中的每一个a元素都添加一个rel=”nofollow”<br>可以使用如下方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doc.select(<span class="string">"div.comments a"</span>).attr(<span class="string">"rel"</span>, <span class="string">"nofollow"</span>);</div></pre></td></tr></table></figure></p>
<p>这里的jsoup方法同样支持链接操作，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doc.select(<span class="string">"div.masthead"</span>).attr(<span class="string">"title"</span>, <span class="string">"jsoup"</span>).addClass(<span class="string">"round-box"</span>);</div></pre></td></tr></table></figure></p>
<h4 id="2-设置元素的html内容"><a href="#2-设置元素的html内容" class="headerlink" title="2.设置元素的html内容"></a>2.设置元素的html内容</h4><p>我们需要向html里面添加html片段等内容时可以如下操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Element div = doc.select(<span class="string">"div"</span>).first(); <span class="comment">// &lt;div&gt;&lt;/div&gt;</span></div><div class="line">div.html(<span class="string">"&lt;p&gt;lorem ipsum&lt;/p&gt;"</span>); <span class="comment">// &lt;div&gt;&lt;p&gt;lorem ipsum&lt;/p&gt;&lt;/div&gt;</span></div><div class="line">div.prepend(<span class="string">"&lt;p&gt;First&lt;/p&gt;"</span>);<span class="comment">//在div前添加html内容</span></div><div class="line">div.append(<span class="string">"&lt;p&gt;Last&lt;/p&gt;"</span>);<span class="comment">//在div之后添加html内容</span></div><div class="line"><span class="comment">// 添完后的结果: &lt;div&gt;&lt;p&gt;First&lt;/p&gt;&lt;p&gt;lorem ipsum&lt;/p&gt;&lt;p&gt;Last&lt;/p&gt;&lt;/div&gt;</span></div><div class="line">Element span = doc.select(<span class="string">"span"</span>).first(); <span class="comment">// &lt;span&gt;One&lt;/span&gt;</span></div><div class="line">span.wrap(<span class="string">"&lt;li&gt;&lt;a href='http://example.com/'&gt;&lt;/a&gt;&lt;/li&gt;"</span>);</div><div class="line"><span class="comment">//对元素包裹一个外部HTML内容添完后的结果:</span></div><div class="line"><span class="comment">//&lt;li&gt;&lt;a href="http://example.com"&gt;&lt;span&gt;One&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span></div></pre></td></tr></table></figure></p>
<h4 id="3-设置元素的文本内容"><a href="#3-设置元素的文本内容" class="headerlink" title="3.设置元素的文本内容"></a>3.设置元素的文本内容</h4><p>如果我们需要修改元素内的文本内容，可以如下操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Element div = doc.select(<span class="string">"div"</span>).first(); <span class="comment">// &lt;div&gt;&lt;/div&gt;</span></div><div class="line">div.text(<span class="string">"five &gt; four"</span>); <span class="comment">// &lt;div&gt;five &amp;gt; four&lt;/div&gt;</span></div><div class="line">div.prepend(<span class="string">"First "</span>);</div><div class="line">div.append(<span class="string">" Last"</span>);</div><div class="line"><span class="comment">// now: &lt;div&gt;First five &amp;gt; four Last&lt;/div&gt;</span></div></pre></td></tr></table></figure></p>
<h6 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h6><p>文本设置方法与 HTML setter 方法一样：<br>Element.text(String text) 将清除一个元素中的内部HTML内容，然后提供的文本进行代替<br>Element.prepend(String first) 和 Element.append(String last) 将分别在元素的内部html前后添加文本节点。<br>对于传入的文本如果含有像 &lt;, &gt; 等这样的字符，将以文本处理，而非HTML。</p>
<p><strong><em>By Xiaolong：You have a dream,you got to protect it!</em></strong></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JSOUP爬虫/" rel="tag"># JSOUP爬虫</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/03/07/Welcome/" rel="next" title="Welcome To My Personal Blog">
                <i class="fa fa-chevron-left"></i> Welcome To My Personal Blog
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/05/08/Reptile2/" rel="prev" title="java爬虫教程：爬取CSDN博客文章">
                java爬虫教程：爬取CSDN博客文章 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">小龙</p>
              <p class="site-description motion-element" itemprop="description">程序猿</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、Jsoup简介"><span class="nav-number">1.</span> <span class="nav-text">一、Jsoup简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、解析遍历HTML文档"><span class="nav-number">2.</span> <span class="nav-text">二、解析遍历HTML文档</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-解析一个html字符串"><span class="nav-number">2.1.</span> <span class="nav-text">1.解析一个html字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-解析body片段"><span class="nav-number">2.2.</span> <span class="nav-text">2.解析body片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-根据一个URL地址加载Document对象"><span class="nav-number">2.3.</span> <span class="nav-text">3.根据一个URL地址加载Document对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-根据文件加载document"><span class="nav-number">2.4.</span> <span class="nav-text">4.根据文件加载document</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、-数据抽取"><span class="nav-number">3.</span> <span class="nav-text">三、 数据抽取</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-使用Dom方法遍历文档"><span class="nav-number">3.1.</span> <span class="nav-text">1.使用Dom方法遍历文档</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#查找元素"><span class="nav-number">3.1.1.</span> <span class="nav-text">查找元素</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#元素数据"><span class="nav-number">3.1.2.</span> <span class="nav-text">元素数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#操作HTML和文本"><span class="nav-number">3.1.3.</span> <span class="nav-text">操作HTML和文本</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-使用选择器来查找元素"><span class="nav-number">3.2.</span> <span class="nav-text">2.使用选择器来查找元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-从元素中抽取属性和文档"><span class="nav-number">3.3.</span> <span class="nav-text">3.从元素中抽取属性和文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-URL处理"><span class="nav-number">3.4.</span> <span class="nav-text">4.URL处理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据修改"><span class="nav-number">4.</span> <span class="nav-text">数据修改</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-设置属性值"><span class="nav-number">4.1.</span> <span class="nav-text">1.设置属性值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-设置元素的html内容"><span class="nav-number">4.2.</span> <span class="nav-text">2.设置元素的html内容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-设置元素的文本内容"><span class="nav-number">4.3.</span> <span class="nav-text">3.设置元素的文本内容</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#说明"><span class="nav-number">4.3.0.1.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小龙</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
